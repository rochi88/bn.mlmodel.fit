<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>বাংলা ব্লগ পোস্ট ক্লাসিফিকেশন | মেশিন লার্নিং ও বিভিন্ন প্রোগ্রামিং ল্যাঙ্গুয়েজে ইম্প্লিমেন্টেশন</title>
    <meta name="generator" content="VuePress 1.5.0">
    
    <meta name="description" content="বাংলায় মেশিন লার্নিং সহজ শিক্ষা">
    <link rel="preload" href="/assets/css/0.styles.6d501496.css" as="style"><link rel="preload" href="/assets/js/app.ff943db8.js" as="script"><link rel="preload" href="/assets/js/2.838862f8.js" as="script"><link rel="preload" href="/assets/js/6.7767a1f1.js" as="script"><link rel="prefetch" href="/assets/js/10.e846aa23.js"><link rel="prefetch" href="/assets/js/11.354e8e9c.js"><link rel="prefetch" href="/assets/js/12.b68da5e2.js"><link rel="prefetch" href="/assets/js/13.c7c7508c.js"><link rel="prefetch" href="/assets/js/14.8ea08db1.js"><link rel="prefetch" href="/assets/js/15.7869c4dc.js"><link rel="prefetch" href="/assets/js/16.d51ceaba.js"><link rel="prefetch" href="/assets/js/17.d0d64215.js"><link rel="prefetch" href="/assets/js/18.6bfe8fdf.js"><link rel="prefetch" href="/assets/js/19.596ad80b.js"><link rel="prefetch" href="/assets/js/20.10f31d3f.js"><link rel="prefetch" href="/assets/js/21.719359da.js"><link rel="prefetch" href="/assets/js/22.06653c7e.js"><link rel="prefetch" href="/assets/js/23.bd8aff41.js"><link rel="prefetch" href="/assets/js/24.cfdbbb4c.js"><link rel="prefetch" href="/assets/js/25.e3eb0442.js"><link rel="prefetch" href="/assets/js/26.a21980e6.js"><link rel="prefetch" href="/assets/js/27.1f28ca07.js"><link rel="prefetch" href="/assets/js/28.ca9e6b26.js"><link rel="prefetch" href="/assets/js/29.19120067.js"><link rel="prefetch" href="/assets/js/3.c8a6fccb.js"><link rel="prefetch" href="/assets/js/30.324bd9be.js"><link rel="prefetch" href="/assets/js/31.1f6ac9f8.js"><link rel="prefetch" href="/assets/js/32.e099d021.js"><link rel="prefetch" href="/assets/js/33.dd075a30.js"><link rel="prefetch" href="/assets/js/34.b34ad0d4.js"><link rel="prefetch" href="/assets/js/35.28a49c94.js"><link rel="prefetch" href="/assets/js/36.9b79648c.js"><link rel="prefetch" href="/assets/js/37.1494e9da.js"><link rel="prefetch" href="/assets/js/4.8a05083b.js"><link rel="prefetch" href="/assets/js/5.32804bbb.js"><link rel="prefetch" href="/assets/js/7.d628d3b1.js"><link rel="prefetch" href="/assets/js/8.4e7b6dcb.js"><link rel="prefetch" href="/assets/js/9.3404ad1a.js">
    <link rel="stylesheet" href="/assets/css/0.styles.6d501496.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">মেশিন লার্নিং ও বিভিন্ন প্রোগ্রামিং ল্যাঙ্গুয়েজে ইম্প্লিমেন্টেশন</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ভূমিকা</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>মেশিন লার্নিংয়ের জন্য প্রস্তুতি</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>মেশিন লার্নিং টুলবক্স</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>মেশিন লার্নিংয়ে কাজের ধারা</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>লিনিয়ার রিগ্রেশন</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>লজিস্টিক রিগ্রেশন</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>মাল্টিক্লাস ক্লাসিফিকেশন</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>ন্যাচারাল ল্যাঙ্গুয়েজ প্রসেসিং</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/nlp/" aria-current="page" class="sidebar-link">ন্যাচারাল ল্যাঙ্গুয়েজ প্রসেসিং</a></li><li><a href="/nlp/bangla-blog-classification/" aria-current="page" class="active sidebar-link">বাংলা ব্লগ পোস্ট ক্লাসিফিকেশন</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>পরিশিষ্ট</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="বাংলা-ব্লগ-পোস্ট-ক্লাসিফিকেশন"><a href="#বাংলা-ব্লগ-পোস্ট-ক্লাসিফিকেশন" class="header-anchor">#</a> বাংলা ব্লগ পোস্ট ক্লাসিফিকেশন</h1> <p><img src="/assets/img/blog.61c8846a.png" alt="feat-image"></p> <p>সেন্টিমেন্ট অ্যানালাইসিস অনেক গতানুগতিক সমস্যা বিধায় আমি বাংলা ব্লগ পোস্ট ক্লাসিফিকেশন কীভাবে করতে হয় সেটা দেখাব। Natural Language Processing টেকনিক গুলো কীভাবে যেকোন ভাষায় ব্যবহার করা যায় এবং বেসিক NLP টেকনিক আমরা স্ক্র্যাচ থেকে ডেভেলপ করব।</p> <h2 id="ডেটাসেট"><a href="#ডেটাসেট" class="header-anchor">#</a> ডেটাসেট</h2> <p>ডেটাসেট হিসেবে আমি চতুর্মাত্রিক ব্লগের পোস্টগুলো নিব, <a href="https://github.com/manashmndl/ml.manash.me/releases/download/2.0.0/choturmatrik.json" target="_blank" rel="noopener noreferrer">ডাউনলোড করা যাবে এখান থেকে<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>।</p> <h2 id="কী-কী-করতে-যাচ্ছি"><a href="#কী-কী-করতে-যাচ্ছি" class="header-anchor">#</a> কী কী করতে যাচ্ছি</h2> <ul class="contains-task-list"><li class="task-list-item"><p><input checked="checked" disabled="disabled" type="checkbox" class="task-list-item-checkbox"> ডেটা এক্সপ্লোরেশন ও ক্লিনিং</p></li> <li class="task-list-item"><p><input checked="checked" disabled="disabled" type="checkbox" class="task-list-item-checkbox"> Pandas দিয়ে বেসিক ক্লিনিং ও এক্সপ্লোরেশন</p></li> <li class="task-list-item"><p><input checked="checked" disabled="disabled" type="checkbox" class="task-list-item-checkbox"> ফিল্টারিং ও টোকেনাইজেশন</p></li> <li class="task-list-item"><p><input checked="checked" disabled="disabled" type="checkbox" class="task-list-item-checkbox"> ভোকাবুলারি তৈরি করা</p></li> <li class="task-list-item"><p><input checked="checked" disabled="disabled" type="checkbox" class="task-list-item-checkbox"> টেক্সট থেকে ফিচার এক্সট্র্যাকশন</p></li> <li class="task-list-item"><p><input checked="checked" disabled="disabled" type="checkbox" class="task-list-item-checkbox"> ব্যাগ অফ ওয়ার্ডস (BoW)</p></li> <li class="task-list-item"><p><input disabled="disabled" type="checkbox" class="task-list-item-checkbox"> টার্ম ফ্রিকোয়েন্সি ইনভার্স ডকুমেন্ট ফ্রিকোয়েন্সি (TF-IDF)</p></li> <li class="task-list-item"><p><input checked="checked" disabled="disabled" type="checkbox" class="task-list-item-checkbox"> বেসিক সফটম্যাক্স ক্লাসিফায়ার দিয়ে ক্লাসিফিকেশন</p></li> <li class="task-list-item"><p><input disabled="disabled" type="checkbox" class="task-list-item-checkbox"> Word Vectors</p></li> <li class="task-list-item"><p><input disabled="disabled" type="checkbox" class="task-list-item-checkbox"> ওয়ার্ড কো অকারেন্স ম্যাট্রিক্সের উপর সিঙ্গুলার ভ্যালু ডিকোম্পোজিশন (SVD) অ্যাপ্লাই করে ফিচার এক্স্ট্র্যাকশন</p></li> <li class="task-list-item"><p><input disabled="disabled" type="checkbox" class="task-list-item-checkbox"> কন্টিনিউয়াস ব্যাগ অফ ওয়ার্ডস (CBOW) ব্যবহার করে টেন্সরফ্ল‌োতে ওয়ার্ড ভেক্টর তৈরি করা</p></li> <li class="task-list-item"><p><input disabled="disabled" type="checkbox" class="task-list-item-checkbox"> ওয়ার্ড ভেক্টর তৈরি করে ডিপ নিউরাল নেটওয়ার্ক দিয়ে ক্লাসিফিকেশন</p></li> <li class="task-list-item"><p><input disabled="disabled" type="checkbox" class="task-list-item-checkbox"> RNN দিয়ে ক্লাসিফিকেশন</p></li></ul> <h2 id="ডেটা-এক্সপ্লোরেশন"><a href="#ডেটা-এক্সপ্লোরেশন" class="header-anchor">#</a> ডেটা এক্সপ্লোরেশন</h2> <p>পানডাস দিয়ে প্রথমে JSON ফাইলটা রিড করব, তারপর ফাঁকা স্ট্রিং কোন কোন সারিতে আছে সেটা বের করতে হবে।</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_json<span class="token punctuation">(</span><span class="token string">'./choturmatrik.json'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span> df<span class="token punctuation">.</span>content<span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span><span class="token builtin">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>আউটপুট:</p> <div class="language- extra-class"><pre class="language-text"><code>      content        tags
10204               কবিতা
12720               কবিতা
12887               কবিতা
13687               কবিতা
15602          আবোল তাবোল
</code></pre></div><p>এখন যদি এটাকে ফিল্টার আউট করতে চাই তাহলে শুধু <code>!=0</code> বসিয়ে দিলেই হবে।</p> <div class="language-python extra-class"><pre class="language-python"><code>df <span class="token operator">=</span> df<span class="token punctuation">[</span>df<span class="token punctuation">.</span>content<span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span><span class="token builtin">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span> <span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>আউটপুট:</p> <div class="language- extra-class"><pre class="language-text"><code>                                                 content        tags
1      অফিসে তেমন ব্যস্ততা নেই, \nকেমন একটা নিঃসঙ্গ ভ...       কবিতা
10     আমাদের ফেসবুক ঠিকানা: \nগ্রুপ: Facebook.com/gr...  আবোল তাবোল
10000  ঝিরিঝিরি বৃষ্টির অধরে \nপয়ারের চুম্বন পাখা মেল...       কবিতা
10008  কেন পান্থ এ চঞ্চলতা! \nআজি শ্রাবণঘনগহন মোহে \n...       কবিতা
10011  মন ভাল নেই মনের ভেতর \nমন খারাপের গন্ধ, \nক্লা...       কবিতা
</code></pre></div><h3 id="ক্লাস-বা-লেবেল-কয়টি-আছে-বের-করা"><a href="#ক্লাস-বা-লেবেল-কয়টি-আছে-বের-করা" class="header-anchor">#</a> ক্লাস বা লেবেল কয়টি আছে বের করা</h3> <p>ক্লাসের সেট করলেই বের হয়ে যাবে ইউনিক কী কী ক্লাস আছে</p> <div class="language-python extra-class"><pre class="language-python"><code>labels <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">set</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>tags<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>labels<span class="token punctuation">)</span>
</code></pre></div><p>আউটপুট:</p> <div class="language- extra-class"><pre class="language-text"><code>['কিছু একটা লিখতে ইচ্ছে হচ্ছে', 'সমসাময়িক', 'কবিতা', 'আবোল তাবোল', 'গল্প']
</code></pre></div><h4 id="ক্লাসের-নিউমেরিক-রিপ্রেজেন্টেশন"><a href="#ক্লাসের-নিউমেরিক-রিপ্রেজেন্টেশন" class="header-anchor">#</a> ক্লাসের নিউমেরিক রিপ্রেজেন্টেশন</h4> <div class="language-python extra-class"><pre class="language-python"><code>index2label <span class="token operator">=</span> <span class="token punctuation">{</span> i<span class="token punctuation">:</span> labels<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>labels<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
label2index <span class="token operator">=</span> <span class="token punctuation">{</span> labels<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token punctuation">:</span> i <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>labels<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
</code></pre></div><h4 id="ক্লাস-বেজ-স্যাম্পল-ডিস্ট্রিবিউশন"><a href="#ক্লাস-বেজ-স্যাম্পল-ডিস্ট্রিবিউশন" class="header-anchor">#</a> ক্লাস বেজ স্যাম্পল ডিস্ট্রিবিউশন</h4> <p>এবার দেখা যাক কোন ক্লাসে কতটি স্যাম্পল আছে,</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">for</span> label <span class="token keyword">in</span> labels<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span> <span class="token string">&quot;{:20} --- {} samples&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span> label<span class="token punctuation">,</span> df<span class="token punctuation">[</span> df<span class="token punctuation">.</span>tags <span class="token operator">==</span> label <span class="token punctuation">]</span><span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>  <span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="ক্লাসের-নিউমেরিক-ইনডেক্স-দিয়ে-ক্লাস-লেবেল-রিপ্লেস-করা"><a href="#ক্লাসের-নিউমেরিক-ইনডেক্স-দিয়ে-ক্লাস-লেবেল-রিপ্লেস-করা" class="header-anchor">#</a> ক্লাসের নিউমেরিক ইনডেক্স দিয়ে ক্লাস লেবেল রিপ্লেস করা</h4> <div class="language-python extra-class"><pre class="language-python"><code>df<span class="token punctuation">.</span>tags <span class="token operator">=</span> df<span class="token punctuation">.</span>tags<span class="token punctuation">.</span>replace<span class="token punctuation">(</span>label2index<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>আউটপুট:</p> <div class="language- extra-class"><pre class="language-text"><code>content  tags
1      অফিসে তেমন ব্যস্ততা নেই, \nকেমন একটা নিঃসঙ্গ ভ...     2
10     আমাদের ফেসবুক ঠিকানা: \nগ্রুপ: Facebook.com/gr...     3
10000  ঝিরিঝিরি বৃষ্টির অধরে \nপয়ারের চুম্বন পাখা মেল...     2
10008  কেন পান্থ এ চঞ্চলতা! \nআজি শ্রাবণঘনগহন মোহে \n...     2
10011  মন ভাল নেই মনের ভেতর \nমন খারাপের গন্ধ, \nক্লা...     2
</code></pre></div><p>বেসিক কাজ শেষ। এবার ডেটাসেট ক্লিন করার পালা।</p> <h2 id="ডেটাসেট-ক্লিনিং"><a href="#ডেটাসেট-ক্লিনিং" class="header-anchor">#</a> ডেটাসেট ক্লিনিং</h2> <p>প্রথম ১০০ ব্লগ পোস্ট প্রিন্ট করে দেখা যাক।</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> pprint <span class="token keyword">import</span> pprint
<span class="token keyword">for</span> content <span class="token keyword">in</span> df<span class="token punctuation">.</span>content<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
    pprint<span class="token punctuation">(</span>content<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;----&quot;</span><span class="token punctuation">)</span>
</code></pre></div><p>আউটপুট:</p> <div class="language- extra-class"><pre class="language-text"><code>('অফিসে তেমন ব্যস্ততা নেই, \n'
 'কেমন একটা নিঃসঙ্গ ভাব \n'
 'মনটাকে পেতে আজকে আমার \n'
 'দিয়েছে বদলে আগের স্বভাব। \n'
 'ফেলে আসা দিন গুলো ভাবাচ্ছে, \n'
 'স্মৃতিরা আমাকে অতিষ্ঠ করে \n'
 'হয়তো বা কোন প্রতিশোধ নিতে- \n'
 'চাচ্ছে, ওরাও জুলম করছে। \n'
 'হয়ত ঘোরের মধ্যে পড়ে গেছি, \n'
 'একজন তুমি বা কাল্পনিক - \n'
 'প্রেমীকাকে খুব বিনয় করছি, \n'
 'বলছি, আমায় তুমিও বোঝ না? \n'
 .....
</code></pre></div><p>সঙ্গতকারণেই সব কয়টা প্রিন্ট করা সম্ভব হচ্ছে না। প্রতিটা ব্লগ পোস্টে কি কি শব্দ আছে সেগুলো ইনডেক্সিং করতে হবে সবার আগে, আর সেটা করার জন্য প্রথমে আমাদের যতিচিহ্ন বাদ দিতে হবে।</p> <h3 id="পাঙ্কচুয়েশন-ও-স্টপওয়ার্ড-রিমুভ-করা-এবং-টোকেনাইজেশন"><a href="#পাঙ্কচুয়েশন-ও-স্টপওয়ার্ড-রিমুভ-করা-এবং-টোকেনাইজেশন" class="header-anchor">#</a> পাঙ্কচুয়েশন ও স্টপওয়ার্ড রিমুভ করা এবং টোকেনাইজেশন</h3> <p>অপ্রয়োজনীয় শব্দও বাদ দেয়া যেতে পারে, যেটাকে বলে Stopword। বাংলায় যেহেতু স্টপওয়ার্ড কালেকশন খুব কম তাই আমরা ছোট ওই কালেকশন ব্যবহার করেই ডেটাসেট ক্লিন করার চেষ্টা করব। স্টপওয়ার্ডের উদাহরণ হল, &quot;আপনার, আমি, আমার, তুমি, পারেন, পর্যন্ত....&quot; ইত্যাদি।</p> <p>স্টপওয়ার্ড রিমুভ করলে আপাতদৃষ্টিতে একটা টেক্সট এর অর্থের তেমন পরিবর্তন হয় না, আর এই শব্দগুলি বেশি থাকে, তাই আমাদের মেশিন লার্নিং মডেল যাতে অপ্রয়োজনীয় শব্দের উপস্থিতিতে বায়াজড না হয়ে যায় তাই আমরা এই শব্দগুলি রিমুভ করে থাকি। পাঙ্কচুয়েশনের পাশাপাশি আমাদের বিভিন্ন ধরণের ক্যারেক্টার যেমন <code>\n, \t</code> ইত্যাদি সবকিছু রিমুভ করতে হবে। স্টপওয়ার্ড লিস্ট হিসেবে আমি <a href="https://raw.githubusercontent.com/explosion/spaCy/master/spacy/lang/bn/stop_words.py" target="_blank" rel="noopener noreferrer">এটা<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> ব্যবহার করব।</p> <p>কাজগুলো করার সময় আমি একটা সেন্টেন্স নিয়ে কাজ করব, তারপর সেটাকে একটা ফাংশনের মধ্যে র‍্যাপ করে দেব।</p> <h4 id="পাঙ্কচুয়েশন-রিমুভাল"><a href="#পাঙ্কচুয়েশন-রিমুভাল" class="header-anchor">#</a> পাঙ্কচুয়েশন রিমুভাল</h4> <p>পাঙ্কচুয়েশন রিমুভ করার জন্য পাইথনের বিল্টইন <code>str.maketrans</code> এর সাহায্যে খুব ফাস্ট যেসব ক্যারেক্টার আমাদের দরকার নাই ওগুলিকে ‍স্পেস দ্বারা রিপ্লেস করে দেব।</p> <p>ডেটাসেট থেকে একটা স্যাম্পল নিয়ে দেখা যাক।</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># Taking the first sample</span>
sample <span class="token operator">=</span> df<span class="token punctuation">.</span>content<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>sample<span class="token punctuation">)</span>
</code></pre></div><p>আউটপুট:</p> <div class="language- extra-class"><pre class="language-text"><code>অফিসে তেমন ব্যস্ততা নেই,
কেমন একটা নিঃসঙ্গ ভাব
মনটাকে পেতে আজকে আমার
দিয়েছে বদলে আগের স্বভাব।
ফেলে আসা দিন গুলো ভাবাচ্ছে,
স্মৃতিরা আমাকে অতিষ্ঠ করে
হয়তো বা কোন প্রতিশোধ নিতে-...
</code></pre></div><p>এবার আমরা চেষ্টা করব স্যাম্পল থেকে অবাঞ্ছিত ক্যারেক্টার গুলো দূর করতে।</p> <div class="language-python extra-class"><pre class="language-python"><code>filters <span class="token operator">=</span> <span class="token triple-quoted-string string">&quot;&quot;&quot;
!&quot;#$%&amp;()*+,-./:;&lt;=&gt;?@[\\]^_`{|}~\t\n?,।!‍.0123456789০১২৩৪৫৬৭৮৯
&quot;&quot;&quot;</span>
translate_dict <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token string">' '</span><span class="token punctuation">)</span> <span class="token keyword">for</span> c <span class="token keyword">in</span> filters<span class="token punctuation">)</span>
translate_map <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">.</span>maketrans<span class="token punctuation">(</span>translate_dict<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>sample<span class="token punctuation">.</span>translate<span class="token punctuation">(</span>translate_map<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>আউটপুট:</p> <div class="language- extra-class"><pre class="language-text"><code>অফিসে তেমন ব্যস্ততা নেই   কেমন একটা নিঃসঙ্গ ভাব  মনটাকে পেতে আজকে আমার  দিয়েছে বদলে আগের স্বভাব   ফেলে আসা দিন গুলো ভাবাচ্ছে   স্মৃতিরা আমাকে অতিষ্ঠ করে  হয়তো বা কোন প্রতিশোধ নিতে   চাচ্ছে  ওরাও জুলম করছে   হয়ত ঘোরের মধ্যে পড়ে গেছি   একজন তুমি বা কাল্পনিক    প্রেমীকাকে খুব বিনয় করছি   বলছি  আমায় তুমিও বোঝ না   কেন কাছে আসো না ভালবাস না   তাহলে তো আর কিছুই হবে না   আমার কখনো    বিয়েই হবে না  সুখ মিলবে না    হা হা হা  দারুণ মজার তাই না   এমন মজার সময় কাটছে  তবুও আমার ভাল লাগছে না   নিজেকে বন্দী বন্দী লাগছে  সবকিছু যেন অচেনা অজানা   চেনা জানা সুখ গুলো নেই আর   কোথায় যে সব গিয়েছে হারিয়ে  কেউ তার খোঁজ হয়ত জানে না  ঠিকানা কোথায় বলতে পারে না   যৌবনে একাকী থাকা কষ্টের   একারণেই কি কাজে গতি আসে   সবাই চেষ্টা করে তারাতারি  সঙ্গিনী আর সফলতা পেতে   আমার কি তবে প্রয়োজন সেই    সফলতা আর সেই সঙ্গিনী   হয়তো বা তাই   একারণেই তো বন্য হয়ে যাই   আমার বন্যতা হরেক রকম  কান্না হাসির   পড়ার লেখার   বলার   চলার  দেবার নেবার  ঘুমের  জাগার ইত্যাদি ইত্যাদি   এর সবি আমি প্রকাশ করেছি  এর সবি হল আপন স্বভাব
</code></pre></div><p>এখন যদি আমি একে স্পেস ডেলিমিটার দিয়ে স্প্লিট করি তাহলে আর্টিকেলের সবকয়টি শব্দের কালেকশন পেয়ে যাব।</p> <div class="language-python extra-class"><pre class="language-python"><code>words <span class="token operator">=</span> sample<span class="token punctuation">.</span>translate<span class="token punctuation">(</span>translate_map<span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>words<span class="token punctuation">)</span>
</code></pre></div><p>আউটপুট:</p> <div class="language- extra-class"><pre class="language-text"><code>['অফিসে', 'তেমন', 'ব্যস্ততা', 'নেই', 'কেমন', 'একটা', 'নিঃসঙ্গ', 'ভাব', 'মনটাকে', 'পেতে', 'আজকে', 'আমার', 'দিয়েছে', 'বদলে', 'আগের', 'স্বভাব', 'ফেলে', 'আসা', 'দিন', 'গুলো', 'ভাবাচ্ছে', 'স্মৃতিরা', 'আমাকে', 'অতিষ্ঠ', 'করে', 'হয়তো', 'বা', 'কোন', 'প্রতিশোধ', 'নিতে', 'চাচ্ছে', 'ওরাও', 'জুলম', 'করছে', 'হয়ত', 'ঘোরের', 'মধ্যে', 'পড়ে', 'গেছি', 'একজন', 'তুমি', 'বা', 'কাল্পনিক', 'প্রেমীকাকে', 'খুব', 'বিনয়', 'করছি', 'বলছি', 'আমায়', 'তুমিও', 'বোঝ', 'না', 'কেন', 'কাছে', 'আসো', 'না', 'ভালবাস', 'না', 'তাহলে', 'তো', 'আর', 'কিছুই', 'হবে', 'না', 'আমার', 'কখনো', 'বিয়েই', 'হবে', 'না', 'সুখ', 'মিলবে', 'না', 'হা', 'হা', 'হা', 'দারুণ', 'মজার', 'তাই', 'না', 'এমন', 'মজার', 'সময়', 'কাটছে', 'তবুও', 'আমার', 'ভাল', 'লাগছে', 'না', 'নিজেকে', 'বন্দী', 'বন্দী', 'লাগছে', 'সবকিছু', 'যেন', 'অচেনা', 'অজানা', 'চেনা', 'জানা', 'সুখ', 'গুলো', 'নেই', 'আর', 'কোথায়', 'যে', 'সব', 'গিয়েছে', 'হারিয়ে', 'কেউ', 'তার', 'খোঁজ', 'হয়ত', 'জানে', 'না', 'ঠিকানা', 'কোথায়', 'বলতে', 'পারে', 'না', 'যৌবনে', 'একাকী', 'থাকা', 'কষ্টের', 'একারণেই', 'কি', 'কাজে', 'গতি', 'আসে', 'সবাই', 'চেষ্টা', 'করে', 'তারাতারি', 'সঙ্গিনী', 'আর', 'সফলতা', 'পেতে', 'আমার', 'কি', 'তবে', 'প্রয়োজন', 'সেই', 'সফলতা', 'আর', 'সেই', 'সঙ্গিনী', 'হয়তো', 'বা', 'তাই', 'একারণেই', 'তো', 'বন্য', 'হয়ে', 'যাই', 'আমার', 'বন্যতা', 'হরেক', 'রকম', 'কান্না', 'হাসির', 'পড়ার', 'লেখার', 'বলার', 'চলার', 'দেবার', 'নেবার', 'ঘুমের', 'জাগার', 'ইত্যাদি', 'ইত্যাদি', 'এর', 'সবি', 'আমি', 'প্রকাশ', 'করেছি', 'এর', 'সবি', 'হল', 'আপন', 'স্বভাব']
</code></pre></div><p>সুতরাং আমরা একটা ফাংশন লিখতে পারি!।</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">sentence_to_wordlist</span><span class="token punctuation">(</span>sentence<span class="token punctuation">,</span> filters<span class="token operator">=</span><span class="token string">&quot;!\&quot;#$%&amp;()*+,-./:;&lt;=&gt;?@[\\]^_`{|}~\t\n?,।!‍.0123456789০১২৩৪৫৬৭৮৯&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># for english</span>
    sentence <span class="token operator">=</span> sentence<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span>
    translate_dict <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token string">' '</span><span class="token punctuation">)</span> <span class="token keyword">for</span> c <span class="token keyword">in</span> filters<span class="token punctuation">)</span>
    translate_map <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">.</span>maketrans<span class="token punctuation">(</span>translate_dict<span class="token punctuation">)</span>
    <span class="token keyword">return</span> sentence<span class="token punctuation">.</span>translate<span class="token punctuation">(</span>translate_map<span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>sentence_to_wordlist<span class="token punctuation">(</span>df<span class="token punctuation">.</span>content<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>আউটপুট:</p> <div class="language- extra-class"><pre class="language-text"><code>['ঝিরিঝিরি',
 'বৃষ্টির',
 'অধরে',
 'পয়ারের',
 'চুম্বন',
 'পাখা',
 'মেলেছে...
</code></pre></div><p>এবার স্টপওয়ার্ড রিমুভ করতে হবে, তাহলে শুধু চেক করতে হবে যে কোন একটি শব্দ স্টপওয়ার্ড লিস্টে আছে কিনা, যদি থাকে তাহলে ওইটা রিটার্ন করবে না, যদি না থাকে তাহলে শব্দটি স্টপওয়ার্ড না এবং মূল ওয়ার্ডলিস্টে স্থান পাবে।</p> <p>এটা করার জন্য আমাদের পূর্বের ফাংশনে <code>filter</code> ফাংশনটি কল করে একটি Lambda ফাংশন পাস করব।</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x <span class="token keyword">not</span> <span class="token keyword">in</span> STOP_WORDS<span class="token punctuation">,</span> wordlist<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>সুতরাং পরিবর্তিত ফাংশন,</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">sentence_to_wordlist</span><span class="token punctuation">(</span>sentence<span class="token punctuation">,</span> filters<span class="token operator">=</span><span class="token string">&quot;!\&quot;#$%&amp;()*+,-./:;&lt;=&gt;?@[\\]^_`{|}~\t\n?,।!‍.'0123456789০১২৩৪৫৬৭৮৯‘\u200c–“”…‘&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    translate_dict <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token string">' '</span><span class="token punctuation">)</span> <span class="token keyword">for</span> c <span class="token keyword">in</span> filters<span class="token punctuation">)</span>
    translate_map <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">.</span>maketrans<span class="token punctuation">(</span>translate_dict<span class="token punctuation">)</span>
    wordlist <span class="token operator">=</span> sentence<span class="token punctuation">.</span>translate<span class="token punctuation">(</span>translate_map<span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x <span class="token keyword">not</span> <span class="token keyword">in</span> STOP_WORDS<span class="token punctuation">,</span> wordlist<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>তাহলে এই ফাংশনটি প্রথমে স্টপওয়ার্ড রিমুভ করে, তারপর টোকেনাইজ করে এবং সবশেষে স্টপওয়ার্ড রিমুভ করে।</p> <h4 id="ডকুমেন্ট"><a href="#ডকুমেন্ট" class="header-anchor">#</a> ডকুমেন্ট</h4> <p>একেকটা ডকুমেন্ট বলতে আমরা কোন কন্টেন্টের ওয়ার্ডলিস্টকে বুঝাব। যেমন,</p> <div class="language- extra-class"><pre class="language-text"><code>['অফিসে', 'তেমন', 'ব্যস্ততা', 'নেই', 'কেমন', 'একটা', 'নিঃসঙ্গ', 'ভাব', 'মনটাকে', 'পেতে', 'আজকে', 'আমার', 'দিয়েছে', 'বদলে', 'আগের', 'স্বভাব', ..... ]
</code></pre></div><p>এটা একটা ডকুমেন্ট। এইভাবে ডকুমেন্টের বড় লিস্ট হল কালেকশন অফ ডকুমেন্টস।</p> <h2 id="ভোকাবুলারি-তৈরি-করা"><a href="#ভোকাবুলারি-তৈরি-করা" class="header-anchor">#</a> ভোকাবুলারি তৈরি করা</h2> <p>আমাদের কাজের বিবেচনায় ভোকাবুলারি হল এমন একটি কন্টেইনার যেখানে প্রতিটা ওয়ার্ডের জন্য একটি ইনডেক্স অ্যাসাইন করা থাকবে, দিনশেষে আমরা ইন্টিজার নিয়েই কাজ করব, সেখানে ওয়ার্ড বলতে কিছু থাকবে না। লেবেল ইনডেক্সিংয়ের মত করেই ওয়ার্ড ইনডেক্স করব। ভোকাবুলারি মানেই সেখানে শুধু ইউনিক ওয়ার্ড পাওয়া যাবে।</p> <p>একটা ক্লাস লিখব, যাতে সেখানে প্রয়োজনীয় ফাংশন থাকে, যেমন BoW, TF-IDF তৈরি করার মত ইউটিলস।</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">Vocabulary</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> documents<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>token2id <span class="token operator">=</span> defaultdict<span class="token punctuation">(</span><span class="token keyword">lambda</span> <span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>id2token <span class="token operator">=</span> defaultdict<span class="token punctuation">(</span><span class="token keyword">lambda</span> <span class="token punctuation">:</span> <span class="token string">' '</span><span class="token punctuation">)</span>
        <span class="token comment"># token count in a document</span>
        self<span class="token punctuation">.</span>dfs <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
        self<span class="token punctuation">.</span>token_collection <span class="token operator">=</span> <span class="token builtin">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>token_counter <span class="token operator">=</span> Counter<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>documents <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

        <span class="token keyword">if</span> documents <span class="token operator">!=</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>update_documents<span class="token punctuation">(</span>documents<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">update_token_dictionary</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> remove_previous<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

        <span class="token keyword">if</span> remove_previous<span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>token2id <span class="token operator">=</span> defaultdict<span class="token punctuation">(</span><span class="token keyword">lambda</span> <span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>id2token <span class="token operator">=</span> defaultdict<span class="token punctuation">(</span><span class="token keyword">lambda</span> <span class="token punctuation">:</span> <span class="token string">' '</span><span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>token2id<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">' '</span> <span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>id2token<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token number">0</span> <span class="token punctuation">:</span> <span class="token string">' '</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>id2token<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">{</span> idx<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">:</span> word <span class="token keyword">for</span> idx<span class="token punctuation">,</span> word <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>token_collection<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>token2id<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">{</span> word<span class="token punctuation">:</span> idx<span class="token operator">+</span><span class="token number">1</span> <span class="token keyword">for</span> idx<span class="token punctuation">,</span> word <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>token_collection<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>



    <span class="token keyword">def</span> <span class="token function">update_documents</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> documents<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># Extending the documents</span>
        self<span class="token punctuation">.</span>documents<span class="token punctuation">.</span>extend<span class="token punctuation">(</span>documents<span class="token punctuation">)</span>

        <span class="token keyword">for</span> idx<span class="token punctuation">,</span> document <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>documents<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">for</span> word <span class="token keyword">in</span> document<span class="token punctuation">:</span>
                self<span class="token punctuation">.</span>token_counter<span class="token punctuation">[</span>word<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span>
                self<span class="token punctuation">.</span>token_collection<span class="token punctuation">.</span>add<span class="token punctuation">(</span>word<span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>update_token_dictionary<span class="token punctuation">(</span><span class="token punctuation">)</span>



    <span class="token comment"># add_documents removes the previous ones</span>
    <span class="token keyword">def</span> <span class="token function">add_documents</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> documents<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>documents <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        self<span class="token punctuation">.</span>token_counter <span class="token operator">=</span> Counter<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>token2id <span class="token operator">=</span> defaultdict<span class="token punctuation">(</span><span class="token keyword">lambda</span> <span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>id2token <span class="token operator">=</span> defaultdict<span class="token punctuation">(</span><span class="token keyword">lambda</span> <span class="token punctuation">:</span> <span class="token string">' '</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>update_documents<span class="token punctuation">(</span>documents<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">__len__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">assert</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>id2token<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>token2id<span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>id2token<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">get_token_count</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> token<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> token <span class="token keyword">not</span> <span class="token keyword">in</span> self<span class="token punctuation">.</span>token2id<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string">&quot;Token doesn't exist&quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>token_counter<span class="token punctuation">[</span>token<span class="token punctuation">]</span>


    <span class="token keyword">def</span> <span class="token function">reduce_vocabulary_by_frequency</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> threshold<span class="token punctuation">)</span><span class="token punctuation">:</span>
        token_collection <span class="token operator">=</span> <span class="token punctuation">[</span> tok <span class="token keyword">for</span> tok <span class="token keyword">in</span> self<span class="token punctuation">.</span>token_counter <span class="token keyword">if</span> self<span class="token punctuation">.</span>token_counter<span class="token punctuation">[</span>tok<span class="token punctuation">]</span> <span class="token operator">&gt;</span> threshold <span class="token punctuation">]</span>
        self<span class="token punctuation">.</span>token_collection <span class="token operator">=</span> <span class="token builtin">set</span><span class="token punctuation">(</span>token_collection<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>update_token_dictionary<span class="token punctuation">(</span>remove_previous<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">__getitem__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> key <span class="token operator">&gt;=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>id2token<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">raise</span> KeyError<span class="token punctuation">(</span><span class="token string">&quot;Key can't be equal or greater than total token count&quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>id2token<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
</code></pre></div><p>এই ক্লাসে বেশ কিছু ফাংশন লিখে ফেললাম, প্রতিটা ফাংশনের কাজ একে একে ব্যাখ্যা করা হবে।</p> <h4 id="add-documents"><a href="#add-documents" class="header-anchor">#</a> <code>add_documents</code></h4> <p>এই ফাংশনে ডকুমেন্ট পাস করলে আগের ডকুমেন্টের ডেটা (যদি অ্যাড করা থাকে) সব মুছে যাবে ও টোকেন কালেকশন, তাদের আইডি নতুনভাবে তৈরি হবে। এই ফাংশনের কাজ হল প্রতিটা টোকেন ভোকাবুলারিতে অ্যাড করা ও ওই টোকেনটি সর্বমোট কতবার দেখা গেছে তার কাউন্ট <code>token_counter</code> এ স্টোর করা।</p> <h4 id="update-documents"><a href="#update-documents" class="header-anchor">#</a> <code>update_documents</code></h4> <p>যদি আমাদের একবার ডকুমেন্ট অ্যাড করার পরে আবারও ডকুমেন্ট অ্যাড করার দরকার হয় তাহলে এই ফাংশনটা কল করলে আগের ডকুমেন্টের সাথে নতুন ডকুমেন্ট অ্যাড হবে, মানে যদি নতুন ডকুমেন্টে নতুন শব্দ থাকে সেটাও ভোকাবুলারিতে অ্যাড হয়ে যাবে ও ইনডেক্সিংও আপডেটেড হবে।</p> <h4 id="reduce-vocabulary-by-frequency"><a href="#reduce-vocabulary-by-frequency" class="header-anchor">#</a> <code>reduce_vocabulary_by_frequency</code></h4> <p>অনেক সময় দেখা যায় অপ্রয়োজনীয় ওয়ার্ড অনেকবার ডকুমেন্টের কালেকশনে থাকতে পারে। Bag of Words মডেলটা অনেক Sparse হওয়ার কারণে এইসব অপ্রয়োজনীয় ওয়ার্ডের কারণে ফিচার ভেক্টর সাইজ অনেক বড় হতে পারে। এইকারণে প্রয়োজনমাফিক ভোকাবুলারি সাইজ কমানোর জন্য এই ফাংশনটা কাজে আসবে।</p> <h3 id="bag-of-words-model"><a href="#bag-of-words-model" class="header-anchor">#</a> Bag of Words Model</h3> <p>তৈরিকৃত Vocabulary ক্লাসের সাহায্যে ব্যাগ অফ ওয়ার্ডস মডেল তৈরি করব।</p> <div class="language-python extra-class"><pre class="language-python"><code>docs <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token string">'আমি'</span><span class="token punctuation">,</span> <span class="token string">'NLP'</span><span class="token punctuation">,</span> <span class="token string">'পছন্দ'</span><span class="token punctuation">,</span> <span class="token string">'করি'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">'NLP'</span><span class="token punctuation">,</span> <span class="token string">'মানে'</span><span class="token punctuation">,</span> <span class="token string">'Neuro'</span><span class="token punctuation">,</span> <span class="token string">'Linguistic'</span><span class="token punctuation">,</span> <span class="token string">'Programming'</span><span class="token punctuation">,</span> <span class="token string">'না'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">'NLP'</span><span class="token punctuation">,</span> <span class="token string">'ও'</span><span class="token punctuation">,</span> <span class="token string">'Deep'</span><span class="token punctuation">,</span> <span class="token string">'Learning'</span><span class="token punctuation">,</span> <span class="token string">'এক'</span><span class="token punctuation">,</span> <span class="token string">'জিনিস'</span><span class="token punctuation">,</span> <span class="token string">'না'</span><span class="token punctuation">]</span>
<span class="token punctuation">]</span>

v <span class="token operator">=</span> Vocabulary<span class="token punctuation">(</span><span class="token punctuation">)</span>
v<span class="token punctuation">.</span>add_documents<span class="token punctuation">(</span>docs<span class="token punctuation">)</span>

unique_tokens <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>token_collection<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>unique_tokens<span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>unique_tokens<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>আউটপুট:</p> <div class="language- extra-class"><pre class="language-text"><code>['Deep', 'ও', 'Learning', 'করি', 'পছন্দ', 'Linguistic', 'Programming', 'না', 'জিনিস', 'মানে', 'আমি', 'এক', 'Neuro', 'NLP'] 14
</code></pre></div><p>আমাদের ব্যাগ অফ ওয়ার্ডস মডেলের ভেক্টর সাইজ হবে ১৪। প্রতিটা ডকুমেন্টের জন্য এটা ফিক্সড। কোন ডকুমেন্টে এই শব্দগুলার মধ্যে কোনটা কতবার আছে সেই কাউন্টটাই হবে ব্যাগ অফ ওয়ার্ডস রিপ্রেজেন্টেশন। যদি টোকেন কোন ডকুমেন্টে না থাকে তাহলে সেখানে 0 বসিয়ে দিলেই হবে।</p> <h5 id="docs-0-এর-bow-রিপ্রেজেন্টেশন"><a href="#docs-0-এর-bow-রিপ্রেজেন্টেশন" class="header-anchor">#</a> <code>docs[0]</code> এর BoW রিপ্রেজেন্টেশন</h5> <p>প্রথম ডকুমেন্টটি হল, <code>['আমি', 'NLP', 'পছন্দ', 'করি']</code>। এখানে, যেসব শব্দগুলো অনুপস্থিত সেগুলো হচ্ছে,</p> <div class="language- extra-class"><pre class="language-text"><code>{'Deep',
 'Learning',
 'Linguistic',
 'Neuro',
 'Programming',
 'এক',
 'ও',
 'জিনিস',
 'না',
 'মানে'}
</code></pre></div><p>তাহলে, আমরা যদি আমাদের টোকেন ইনডেক্সিং দেখি,</p> <div class="language-python extra-class"><pre class="language-python"><code>pprint<span class="token punctuation">(</span>v<span class="token punctuation">.</span>token2id<span class="token punctuation">)</span>
</code></pre></div><p>আউটপুট:</p> <div class="language- extra-class"><pre class="language-text"><code>defaultdict(&lt;function Vocabulary.add_documents.&lt;locals&gt;.&lt;lambda&gt; at 0x7f765c203f28&gt;,
            {' ': 0,
             'Deep': 1,
             'Learning': 3,
             'Linguistic': 6,
             'NLP': 14,
             'Neuro': 13,
             'Programming': 7,
             'আমি': 11,
             'এক': 12,
             'ও': 2,
             'করি': 4,
             'জিনিস': 9,
             'না': 8,
             'পছন্দ': 5,
             'মানে': 10})
</code></pre></div><p>সুতরাং প্রথম ডকুমেন্টের BoW রিপ্রেজেন্টেশন,</p> <div class="language- extra-class"><pre class="language-text"><code>[0., 0., 0., 0., 1., 1., 0., 0., 0., 0., 0., 1., 0., 0., 1.]
</code></pre></div><p>কারণ, শুরুর ইনডেক্সটা ডিফল্ট 0 হবে, এটা করার কারণ কোন একটি অপরিচিত ওয়ার্ড দিয়ে যদি আমরা রিপ্রেজেন্ট করি যেটা ভোকাবুলারিতে নেই তখন আমরা আগে 0 বসাব সেসব ওয়ার্ডের জন্য। তাই আমি <code>defaultdict</code> তৈরি করেছি। এটার সুবিধা হল, এই ডিকশনারিতে যদি কোন <code>key</code> না পাওয়া যায় তাহলে সে একটা ডিফল্ট ভ্যালু রিটার্ন করে। আর এখানে ডিফল্ট ভ্যালু হল 0।</p> <p><code>1</code> ইনডেক্সে <code>Deep</code> ওয়ার্ড আছে কিন্তু প্রথম ডকুমেন্টে <code>Deep</code> ওয়ার্ড নাই তাই তার কাউন্ট শূন্য। এভাবে বাকি ওয়ার্ডগুলো তাদের ইন্ডেক্সের জায়গায় আমরা কাউন্ট বসিয়ে দিচ্ছি।</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

<span class="token comment"># 1 for space</span>
bow <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>docs<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>unique_tokens<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> i<span class="token punctuation">,</span> doc <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>docs<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> tok <span class="token keyword">in</span> doc<span class="token punctuation">:</span>
        bow<span class="token punctuation">[</span>i<span class="token punctuation">,</span> v<span class="token punctuation">.</span>token2id<span class="token punctuation">[</span>tok<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>bow<span class="token punctuation">)</span>
</code></pre></div><p>আউটপুট:</p> <div class="language- extra-class"><pre class="language-text"><code>array([[0., 0., 0., 0., 1., 1., 0., 0., 0., 0., 0., 1., 0., 0., 1.],
       [0., 0., 0., 0., 0., 0., 1., 1., 1., 0., 1., 0., 0., 1., 1.],
       [0., 1., 1., 1., 0., 0., 0., 0., 1., 1., 0., 0., 1., 0., 1.]])
</code></pre></div><p>এবার এই কাজটা আমরা <code>Vocabulary</code> ক্লাসের ফাংশন হিসেবে অ্যাড করব।</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">Vocabulary</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;
    .......
    &quot;&quot;&quot;</span>

    <span class="token keyword">def</span> <span class="token function">bow_from_saved_documents</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        bow_matrix <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>documents<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>token_collection<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

        <span class="token keyword">for</span> i<span class="token punctuation">,</span> doc <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>documents<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">for</span> tok <span class="token keyword">in</span> doc<span class="token punctuation">:</span>
                bow_matrix<span class="token punctuation">[</span>i<span class="token punctuation">,</span> self<span class="token punctuation">.</span>token2id<span class="token punctuation">[</span>tok<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span>

        <span class="token keyword">return</span> bow_matrix
</code></pre></div><p>এবার,</p> <div class="language-python extra-class"><pre class="language-python"><code>v <span class="token operator">=</span> Vocabulary<span class="token punctuation">(</span><span class="token punctuation">)</span>
v<span class="token punctuation">.</span>add_documents<span class="token punctuation">(</span>docs<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>bow_from_saved_documents<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>array([[0., 0., 0., 1., 1., 0., 0., 0., 0., 0., 1., 0., 0., 1.],
       [0., 0., 0., 0., 0., 1., 1., 1., 0., 1., 0., 0., 1., 1.],
       [1., 1., 1., 0., 0., 0., 0., 1., 1., 0., 0., 1., 0., 1.]])
</code></pre></div><p>এবার আরেকটি ফাংশন লিখতে হবে যেটা ইন্সট্যান্টলি একটা ডকুমেন্টের BoW রিপ্রেজেন্টেশন রিটার্ন করে।</p> <p>নতুন যে রিপ্রেজেন্টেশন আসবে সেটাকে অবশ্যই পূর্বের ডকুমেন্টের উপর ফিট করা ভোকাবুলারি থেকেই আসতে হবে। যদি নতুন ডকুমেন্টে অপরিচিত শব্দ থাকে ওইটা আমরা ডিসকার্ড করব।</p> <div class="language-python extra-class"><pre class="language-python"><code>bow_sample <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>token_collection<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
new_doc <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'NLP'</span><span class="token punctuation">,</span> <span class="token string">'কঠিন'</span><span class="token punctuation">,</span> <span class="token string">'নাকি'</span><span class="token punctuation">,</span> <span class="token string">'সহজ'</span><span class="token punctuation">]</span>

<span class="token keyword">for</span> tok <span class="token keyword">in</span> new_doc<span class="token punctuation">:</span>
    bow_sample<span class="token punctuation">[</span>v<span class="token punctuation">.</span>token2id<span class="token punctuation">[</span>tok<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>bow_sample<span class="token punctuation">)</span>
</code></pre></div><p>আউটপুট:</p> <div class="language- extra-class"><pre class="language-text"><code>array([3., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1.])
</code></pre></div><p>ভোকাবুলারিতে <code>'কঠিন', 'নাকি', 'সহজ'</code> এই তিনটা শব্দ অনুপস্থিত, তাই এগুলো অ্যারে এর প্রথমে এসে অ্যাড হয়েছে। অ্যারে সাইজ এখন 17, তাই ফিক্সড সাইজ বজায় রাখার জন্য প্রথম ইনডেক্স বাদ দিলেই হবে।</p> <div class="language-python extra-class"><pre class="language-python"><code>bow_sample <span class="token operator">=</span> bow_sample<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
</code></pre></div><p>তাহলে আরেকটা ফাংশন লিখি যেটা দিয়ে এই কাজটা করা যাবে।</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">Vocabulary</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;
    .....
    &quot;&quot;&quot;</span>
    <span class="token keyword">def</span> <span class="token function">doc2bow</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> doc<span class="token punctuation">)</span><span class="token punctuation">:</span>
        bow <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>token_collection<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> tok <span class="token keyword">in</span> doc<span class="token punctuation">:</span>
            bow<span class="token punctuation">[</span>v<span class="token punctuation">.</span>token2id<span class="token punctuation">[</span>tok<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span>
        <span class="token keyword">return</span> bow<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
</code></pre></div><div class="language-python extra-class"><pre class="language-python"><code>v <span class="token operator">=</span> Vocabulary<span class="token punctuation">(</span><span class="token punctuation">)</span>
v<span class="token punctuation">.</span>add_documents<span class="token punctuation">(</span>docs<span class="token punctuation">)</span>
new_doc <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'NLP'</span><span class="token punctuation">,</span> <span class="token string">'কঠিন'</span><span class="token punctuation">,</span> <span class="token string">'নাকি'</span><span class="token punctuation">,</span> <span class="token string">'সহজ'</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>doc2bow<span class="token punctuation">(</span>new_doc<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1.])
</code></pre></div><h2 id="scikit-learn-দিয়ে-লিনিয়ার-সফটম্যাক্স-মডেল-তৈরি-ও-ভ্যালিডেশন"><a href="#scikit-learn-দিয়ে-লিনিয়ার-সফটম্যাক্স-মডেল-তৈরি-ও-ভ্যালিডেশন" class="header-anchor">#</a> scikit-learn দিয়ে লিনিয়ার সফটম্যাক্স মডেল তৈরি ও ভ্যালিডেশন</h2> <p>প্রয়োজনীয় ইম্পোর্ট ও ব্যাগ অফ ওয়ার্ডস রিপ্রেজেন্টেশন</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>linear_model <span class="token keyword">import</span> LogisticRegression
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> accuracy_score
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>utils <span class="token keyword">import</span> shuffle

<span class="token comment"># discard tokens below this frequency threshold</span>
FREQ_THRESHOLD <span class="token operator">=</span> <span class="token number">50</span>
<span class="token comment"># train test data</span>
v <span class="token operator">=</span> Vocabulary<span class="token punctuation">(</span><span class="token punctuation">)</span>
v<span class="token punctuation">.</span>add_documents<span class="token punctuation">(</span>documents<span class="token punctuation">)</span>
v<span class="token punctuation">.</span>reduce_vocabulary_by_frequency<span class="token punctuation">(</span>FREQ_THRESHOLD<span class="token punctuation">)</span>
train_x <span class="token operator">=</span> v<span class="token punctuation">.</span>bow_from_saved_documents<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><div class="language-python extra-class"><pre class="language-python"><code>train_y <span class="token operator">=</span> np<span class="token punctuation">.</span>asarray<span class="token punctuation">(</span>df<span class="token punctuation">.</span>tags<span class="token punctuation">)</span>
<span class="token comment"># shuffling</span>
train_x<span class="token punctuation">,</span> train_y <span class="token operator">=</span> shuffle<span class="token punctuation">(</span>train_x<span class="token punctuation">,</span> train_y<span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span>

<span class="token comment"># train test split</span>
X_train<span class="token punctuation">,</span> X_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>train_x<span class="token punctuation">,</span> train_y<span class="token punctuation">,</span> test_size<span class="token operator">=</span><span class="token number">0.33</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span>

<span class="token comment"># Model creation and fitting</span>
lr <span class="token operator">=</span> LogisticRegression<span class="token punctuation">(</span>C<span class="token operator">=</span><span class="token number">1e5</span><span class="token punctuation">)</span>
lr<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>
</code></pre></div><p>এবার টেস্ট ডেটার উপর প্রেডিক্ট করে অ্যাকুরেসি মাপব।</p> <div class="language-python extra-class"><pre class="language-python"><code>y_pred <span class="token operator">=</span> lr<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>accuracy_score<span class="token punctuation">(</span>y_true<span class="token operator">=</span>y_test<span class="token punctuation">,</span> y_pred<span class="token operator">=</span>y_pred<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>আউটপুট:</p> <div class="language- extra-class"><pre class="language-text"><code>0.7657445556209534
</code></pre></div><p>একদম খারাপ না, তাই না?</p> <p>এবার এই মডেল দিয়ে যদি নতুন কোন পোস্ট ক্লাসিফাই করতে হয় তাহলে?</p> <h2 id="ট্রেইন্ড-মডেল-থেকে-প্রেডিকশন"><a href="#ট্রেইন্ড-মডেল-থেকে-প্রেডিকশন" class="header-anchor">#</a> ট্রেইন্ড মডেল থেকে প্রেডিকশন</h2> <div class="language-python extra-class"><pre class="language-python"><code>test_string <span class="token operator">=</span> <span class="token triple-quoted-string string">&quot;&quot;&quot;
  গগনে গরজে মেঘ, ঘন বরষা।

     কূলে একা বসে আছি, নাহি ভরসা।
  &quot;&quot;&quot;</span>

doc <span class="token operator">=</span> sentence_to_wordlist<span class="token punctuation">(</span>test_string<span class="token punctuation">)</span>
bow_of_doc <span class="token operator">=</span> v<span class="token punctuation">.</span>doc2bow<span class="token punctuation">(</span>doc<span class="token punctuation">)</span>
output <span class="token operator">=</span> lr<span class="token punctuation">.</span>predict<span class="token punctuation">(</span><span class="token punctuation">[</span>bow_of_doc<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>index2label<span class="token punctuation">[</span>output<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><p>আউটপুট:</p> <div class="language- extra-class"><pre class="language-text"><code>কবিতা
</code></pre></div><hr> <p>ব্যাগ অফ ওয়ার্ডস খুবই সাধারণ টেক্সট ভেক্টরাইজেশন প্রসেস। এরপরে আরও অ্যাডভান্সড টেকনিক দেখানো হবে যেখানে টেক্সটের সিকোয়েন্সকেও আমরা বিবেচনা করে আরও অ্যাকুরেট মডেল তৈরি করতে পারব।</p> <p>জুপিটার নোটবুক পাওয়া যাবে <a href="https://github.com/manashmndl/ml.manash.me/blob/master/nlp/BlogPostClassification.ipynb" target="_blank" rel="noopener noreferrer">এখানে<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>।</p> <!----></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">6/11/2020, 6:39:56 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/nlp/" class="prev router-link-active">
        ন্যাচারাল ল্যাঙ্গুয়েজ প্রসেসিং
      </a></span> <span class="next"><a href="/appendix/">
        পরিশিষ্ট
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><div></div><span></span><!----><div class="reading-progress top" data-v-21b39eda><div class="progress" data-v-21b39eda></div></div></div></div>
    <script src="/assets/js/app.ff943db8.js" defer></script><script src="/assets/js/2.838862f8.js" defer></script><script src="/assets/js/6.7767a1f1.js" defer></script>
  </body>
</html>
