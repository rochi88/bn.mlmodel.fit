<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ডেটা প্রস্তুত করা (ডেটা প্রিপ্রসেসিং) - ২ | মেশিন লার্নিং ও বিভিন্ন প্রোগ্রামিং ল্যাঙ্গুয়েজে ইম্প্লিমেন্টেশন</title>
    <meta name="generator" content="VuePress 1.5.0">
    
    <meta name="description" content="বাংলায় মেশিন লার্নিং সহজ শিক্ষা">
    <link rel="preload" href="/assets/css/0.styles.6d501496.css" as="style"><link rel="preload" href="/assets/js/app.ff943db8.js" as="script"><link rel="preload" href="/assets/js/2.838862f8.js" as="script"><link rel="preload" href="/assets/js/31.1f6ac9f8.js" as="script"><link rel="prefetch" href="/assets/js/10.e846aa23.js"><link rel="prefetch" href="/assets/js/11.354e8e9c.js"><link rel="prefetch" href="/assets/js/12.b68da5e2.js"><link rel="prefetch" href="/assets/js/13.c7c7508c.js"><link rel="prefetch" href="/assets/js/14.8ea08db1.js"><link rel="prefetch" href="/assets/js/15.7869c4dc.js"><link rel="prefetch" href="/assets/js/16.d51ceaba.js"><link rel="prefetch" href="/assets/js/17.d0d64215.js"><link rel="prefetch" href="/assets/js/18.6bfe8fdf.js"><link rel="prefetch" href="/assets/js/19.596ad80b.js"><link rel="prefetch" href="/assets/js/20.10f31d3f.js"><link rel="prefetch" href="/assets/js/21.719359da.js"><link rel="prefetch" href="/assets/js/22.06653c7e.js"><link rel="prefetch" href="/assets/js/23.bd8aff41.js"><link rel="prefetch" href="/assets/js/24.cfdbbb4c.js"><link rel="prefetch" href="/assets/js/25.e3eb0442.js"><link rel="prefetch" href="/assets/js/26.a21980e6.js"><link rel="prefetch" href="/assets/js/27.1f28ca07.js"><link rel="prefetch" href="/assets/js/28.ca9e6b26.js"><link rel="prefetch" href="/assets/js/29.19120067.js"><link rel="prefetch" href="/assets/js/3.c8a6fccb.js"><link rel="prefetch" href="/assets/js/30.324bd9be.js"><link rel="prefetch" href="/assets/js/32.e099d021.js"><link rel="prefetch" href="/assets/js/33.dd075a30.js"><link rel="prefetch" href="/assets/js/34.b34ad0d4.js"><link rel="prefetch" href="/assets/js/35.28a49c94.js"><link rel="prefetch" href="/assets/js/36.9b79648c.js"><link rel="prefetch" href="/assets/js/37.1494e9da.js"><link rel="prefetch" href="/assets/js/4.8a05083b.js"><link rel="prefetch" href="/assets/js/5.32804bbb.js"><link rel="prefetch" href="/assets/js/6.7767a1f1.js"><link rel="prefetch" href="/assets/js/7.d628d3b1.js"><link rel="prefetch" href="/assets/js/8.4e7b6dcb.js"><link rel="prefetch" href="/assets/js/9.3404ad1a.js">
    <link rel="stylesheet" href="/assets/css/0.styles.6d501496.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">মেশিন লার্নিং ও বিভিন্ন প্রোগ্রামিং ল্যাঙ্গুয়েজে ইম্প্লিমেন্টেশন</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ভূমিকা</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>মেশিন লার্নিংয়ের জন্য প্রস্তুতি</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>মেশিন লার্নিং টুলবক্স</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>মেশিন লার্নিংয়ে কাজের ধারা</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/workflow/" aria-current="page" class="sidebar-link">মেশিন লার্নিংয়ে কাজের ধারা</a></li><li><a href="/workflow/howto-ask-question/" class="sidebar-link">সঠিক প্রশ্ন করবেন কীভাবে?</a></li><li><a href="/workflow/data-processing/" class="sidebar-link">ডেটা প্রস্তুত করা (ডেটা কালেকশন ও প্রিপ্রসেসিং) - ১</a></li><li><a href="/workflow/data-preprocessing-last/" aria-current="page" class="active sidebar-link">ডেটা প্রস্তুত করা (ডেটা প্রিপ্রসেসিং) - ২</a></li><li><a href="/workflow/algorithm-selection/" class="sidebar-link">অ্যালগরিদম সিলেকশন</a></li><li><a href="/workflow/model-training/" class="sidebar-link">মডেল ট্রেইনিং</a></li><li><a href="/workflow/performance-testing/" class="sidebar-link">মডেল পারফর্মেন্স বা অ্যাকুরেসি টেস্টিং - পর্ব ১</a></li><li><a href="/workflow/performance-testing-last/" class="sidebar-link">মডেল পারফর্মেন্স - দ্বিতীয় এবং শেষ পর্ব</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>লিনিয়ার রিগ্রেশন</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>লজিস্টিক রিগ্রেশন</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>মাল্টিক্লাস ক্লাসিফিকেশন</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ন্যাচারাল ল্যাঙ্গুয়েজ প্রসেসিং</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>পরিশিষ্ট</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="ডেটা-প্রস্তুত-করা-ডেটা-প্রিপ্রসেসিং-২"><a href="#ডেটা-প্রস্তুত-করা-ডেটা-প্রিপ্রসেসিং-২" class="header-anchor">#</a> ডেটা প্রস্তুত করা (ডেটা প্রিপ্রসেসিং) - ২</h1> <h2 id="ডেটাফ্রেম-পরিবর্তন-করা"><a href="#ডেটাফ্রেম-পরিবর্তন-করা" class="header-anchor">#</a> ডেটাফ্রেম পরিবর্তন করা</h2> <p>প্রায় সময়ই ডেটাসেটে ডেটা মিসিং থাকতে পারে। আমাদের সেই মিসিং ডেটাও হ্যান্ডেল করতে হবে। হ্যাঁ, হয়ত আমরা হারানো ডেটা পাব না, তবে প্রয়োজনীয় ব্যবস্থা না নিলে প্রোগ্রাম ক্র্যাশ করতে পারে।</p> <h2 id="কোন-কোন-column-বাদ-দিতে-হবে"><a href="#কোন-কোন-column-বাদ-দিতে-হবে" class="header-anchor">#</a> কোন কোন Column বাদ দিতে হবে?</h2> <ul><li>যেগুলো ব্যবহার করা হবে না</li> <li>কলাম আছে কিন্তু ডেটা নাই</li> <li>একই কলাম যদি একাধিকবার থাকে, তাহলে একটা রেখে বাকিগুল‌ো মুছে দিতে হবে
<ul><li>অনেক সময় নাম দেখে মনে হতে পারে দুইটা আলাদা কলাম কিন্তু আসলে জিনিসটা একই। উদাহরণ হিসেবে বলা যায়, একটা কলামে লেখা আছে <code>Length (meter)</code> এবং আরেকটি কলামে লেখা আছে <code>Size (centimeter)</code>, হঠাৎ দেখলে মনে হবে দুইটা জিনিস আলাদা কারণ লেবেল হচ্ছে <code>Size</code> ও <code>Length</code>। কিন্তু ভাল করে লক্ষ করে দেখা গেল, <code>Length</code> এর প্রত্যেকটা ডেটাকে <code>100</code> দিয়ে গুণ করে আমরা <code>Size</code> এর ডেটাগুলি পেয়ে যাচ্ছি। হাতে ক্যালকুলেশন করে একই ধরণের ডেটা বের করা সম্ভব হয় না এবং হলেও এটা কোন এফিশিয়েন্ট পদ্ধতি না। এই অতিরিক্ত কলামগুলো আসলে ডেটাসেট এ নয়েজ জেনারেট করে। আমরা স্ট্যাটিস্টিক্যাল অ্যানালাইসিস (এখানে <code>Correlation</code>) এর মাধ্যমে একই রকম কলামগুলি আলাদা করব।</li></ul></li></ul> <h2 id="correlated-column-কী"><a href="#correlated-column-কী" class="header-anchor">#</a> Correlated Column কী?</h2> <ul><li>একই তথ্য যদি একটু ভিন্ন ফরম্যাটে থাকে, উপরের উদাহরণে <code>Length</code> এবং <code>Size</code> আসলে একই জিনিস, শুধু <code>Unit</code> আলাদা। তারমানে এরা Correlated Column।</li> <li>অল্প ইনফরমেশন অ্যাড করে বা করেই না।</li> <li>লার্নিং অ্যালগরিদমকে কনফিউজ করে।</li></ul> <blockquote><h5 id="লিনিয়ার-রিগ্রেশন-নিয়ে-অল্প-কিছু-কথা"><a href="#লিনিয়ার-রিগ্রেশন-নিয়ে-অল্প-কিছু-কথা" class="header-anchor">#</a> <em>লিনিয়ার রিগ্রেশন নিয়ে অল্প কিছু কথা</em></h5> <p>পরবর্তী উদাহরণ বুঝতে গেলে আমাদের লিনিয়ার রিগ্রেশন এর কিছু বেসিক লাগবে।</p></blockquote> <blockquote><p>নিচের <strong>কাল্পনিক</strong> ডেটাসেট এর কথা চিন্তা করা যাক,</p></blockquote> <table><thead><tr><th>House Size (sq ft)</th> <th>Price (Tk in lac)</th></tr></thead> <tbody><tr><td>1</td> <td>5</td></tr> <tr><td>2</td> <td>10</td></tr> <tr><td>3</td> <td>15</td></tr> <tr><td>4</td> <td>20</td></tr></tbody></table> <h3 id="গ্রাফ"><a href="#গ্রাফ" class="header-anchor">#</a> গ্রাফ</h3> <p><img src="https://i.imgur.com/66kJVv1.png" alt="graph"></p> <p>আপনাকে যদি বলা হয়, <code>5 sq ft</code> বাড়ির দাম কত হবে? আপনি নির্দ্বিধায় বলে দিতে পারবেন, উত্তর হবে <code>25 lac</code>।</p> <p>কীভাবে বললেন?</p> <p>খুব সহজ, প্রতি ‍<code>1 sq ft</code> বৃদ্ধির জন্য দাম বাড়ছে <code>5 lac</code> করে।</p> <p>আমরা যদি একটা ম্যাথেমেটিক্যাল মডেল দাঁড়া করাতে চাই, সেটা হবে অনেকটা এরকম।</p> <section><div><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>r</mi><mi>i</mi><mi>c</mi><mi>e</mi><mo>=</mo><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo stretchy="false">(</mo><mi>s</mi><mi>q</mi><mi>f</mi><mi>t</mi><mo stretchy="false">)</mo><mo>×</mo><mn>5</mn><mo stretchy="false">(</mo><mi>t</mi><mi>k</mi><mi>i</mi><mi>n</mi><mi>l</mi><mi>a</mi><mi>c</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">price = size (sqft) \times 5 (tk in lac)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">i</span><span class="mord mathdefault">c</span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="mord mathdefault">e</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">5</span><span class="mopen">(</span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">a</span><span class="mord mathdefault">c</span><span class="mclose">)</span></span></span></span></span></div></section><p><strong>বা</strong>,</p> <section><div><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>α</mi><mo>×</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">y = f(x) = \alpha \times x</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span></span></div></section><p>যেখানে, <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span></span></span> হচ্ছে প্রাইস, <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span></span> হচ্ছে সাইজ
<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.0037em;">α</span></span></span></span></span> হচ্ছে 5
এবং <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(x)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span></span></span></span></span> ফাংশনটি বলে দিচ্ছে <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span></span> এর মানের জন্য প্রাইস কত হবে</p> <p>বাস্তবে মডেল এতটা সহজ হয় না, অনেক প্যাঁচ থাকে, এখন আমি একটা <code>alpha</code> গুণ দিয়েই মান পেয়ে যাচ্ছি তখন <code>beta, gamma, theta</code> হাবিজাবি যা আছে তা দিয়ে গুণ দিলেও হয়ত কাছাকাছি মান পাবেন না।</p> <p>নিচের ডেটাসেট দেখা যাক,</p> <table><thead><tr><th>House Size (sq ft)</th> <th>No of rooms</th> <th>Price (tk in lac)</th></tr></thead> <tbody><tr><td>1</td> <td>3</td> <td>10</td></tr> <tr><td>2</td> <td>3</td> <td>12</td></tr> <tr><td>3</td> <td>4</td> <td>14</td></tr> <tr><td>4</td> <td>4</td> <td>17</td></tr> <tr><td>5</td> <td>5</td> <td>22</td></tr></tbody></table> <h3 id="গ্রাফ-2"><a href="#গ্রাফ-2" class="header-anchor">#</a> গ্রাফ</h3> <p><img src="https://i.imgur.com/L1NxBES.png" alt="graph2"></p> <p>এবার আপনাকে যদি বলি, বাড়ির আকার যদি <code>6 sq ft</code> হয় তাহলে প্রাইস কত হবে? এবার আপনি বেশ ঝামেলায় পড়ে যাবেন, কারণ প্রতি স্কয়ার ফিট আকার বৃদ্ধির সাথে বর্ধিত দাম সুষম নয়। আগেরটা বিয়োগ দিয়ে পার্থক্য বের করে সেটার সাথে পার্থক্য যোগ করে পরের প্রাইস পেয়ে যাবেন, সমস্যাটা এত সহজ নয়। কারণ সাথে আবার যুক্ত হয়েছে <code>No of rooms</code>।</p> <p>এখন যদি আমাকে বলা হয়, এটার একটা ম্যাথেমেটিক্যাল মডেল দাঁড়া করাতে তাহলে আমিও বেশ ঝামেলায় পড়ে যাব। এমন কোন সেই লিনিয়ার ইক্যুয়েশন, যেটাতে 1, 2, ... 5 ইনপুট দিলে যথাক্রমে 10, 12 ... 22 পাওয়া যায়?</p> <p>এক্স্যাক্ট কোন মডেল বিল্ড না করতে পারলেও হয়ত কাছাকাছি কোন মডেল তৈরি করতে পারব যার ইক্যুয়েশন অনেকটা এরকম হতে পারে,</p> <section><div><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>r</mi><mi>i</mi><mi>c</mi><mi>e</mi><mo>=</mo><mi>α</mi><mo>×</mo><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo>+</mo><mi>β</mi><mo>×</mo><mi>r</mi><mi>o</mi><mi>o</mi><mi>m</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">price = \alpha \times size + \beta \times rooms</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">i</span><span class="mord mathdefault">c</span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.74285em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05278em;">β</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">o</span><span class="mord mathdefault">o</span><span class="mord mathdefault">m</span><span class="mord mathdefault">s</span></span></span></span></span></div></section><h3 id="correlated-column-এর-উদাহরণ"><a href="#correlated-column-এর-উদাহরণ" class="header-anchor">#</a> Correlated Column এর উদাহরণ</h3> <p>ধরা যাক, আমরা আবারও সেই বিখ্যাত সমস্যা <code>House Price Prediction</code> টা আলোচনায় আনি।</p> <table><thead><tr><th>House Area (Acre)</th> <th>Size (kilo sq meter) (approx.)</th> <th>No of rooms</th> <th>Price (tk in lac)</th></tr></thead> <tbody><tr><td>1</td> <td>4</td> <td>3</td> <td>10</td></tr> <tr><td>2</td> <td>8</td> <td>4</td> <td>12</td></tr> <tr><td>3</td> <td>12</td> <td>4</td> <td>16</td></tr></tbody></table> <p>ডেটাসেট এর কলাম ভালভাবে পরীক্ষা না করেই প্রেডিক্ট করতে বসে গেলাম নিচের ফরমুলা (Linear Regression ফরমুলা) দিয়ে,</p> <section><div><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>r</mi><mi>i</mi><mi>c</mi><mi>e</mi><mo>=</mo><mi>α</mi><mo>∗</mo><mi>A</mi><mi>r</mi><mi>e</mi><mi>a</mi><mtext></mtext><mo stretchy="false">(</mo><mi>A</mi><mi>c</mi><mi>r</mi><mi>e</mi><mo stretchy="false">)</mo><mo>+</mo><mi>β</mi><mo>×</mo><mi>S</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo stretchy="false">(</mo><mi>k</mi><mi>i</mi><mi>l</mi><mi>o</mi><mtext></mtext><mi>s</mi><mi>q</mi><mtext></mtext><mi>m</mi><mi>e</mi><mi>t</mi><mi>e</mi><mi>r</mi><mo stretchy="false">)</mo><mo>+</mo><mi>γ</mi><mo>×</mo><mi>n</mi><mi>o</mi><mi>O</mi><mi>f</mi><mi>R</mi><mi>o</mi><mi>o</mi><mi>m</mi><mi>s</mi></mrow><annotation encoding="application/x-tex"> Price = \alpha * Area \, (Acre) + \beta \times Size(kilo \, sq \, meter) + \gamma \times noOfRooms </annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">i</span><span class="mord mathdefault">c</span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">A</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">e</span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mopen">(</span><span class="mord mathdefault">A</span><span class="mord mathdefault">c</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">e</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05278em;">β</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="mord mathdefault">e</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">e</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05556em;">γ</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">n</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault">o</span><span class="mord mathdefault">o</span><span class="mord mathdefault">m</span><span class="mord mathdefault">s</span></span></span></span></span></div></section><p>আমরা লিনিয়ার রিগ্রেশনের ক্ষেত্রে দেখেছিলাম প্রত্যেকটা ফিচার (ইনপুট ভ্যারিয়েবল) কে একটা Co-efficient দিয়ে গুণ করি তারপর সেগুলোকে যোগ করে আউটপুট প্রেডিক্ট করি। একই রকম কলাম <code>Area &amp; Size</code> দুইবার রাখার কারণে আউটপুট <code>Price</code> কখনোই ঠিকঠাক আসবে না।</p> <p>এখানে কলাম দুইটা একই রকম সেটা সহজে বোঝা যাচ্ছে কারণ উদাহরণটা আমার তৈরি করা 😛 । জোক্স অ্যাপার্ট, যদি অনেকগুলো কলাম হয়, আর সবগুলার নাম আলাদা হয় আর ডেটাও আলাদা হয় কিন্তু আসলে একটা আরেকটার ইউনিট বেজড সিনোনিম হয় সেগুলো বের করা অনেক জটিল ব্যবহার। তাই আমরা এখানে পরিসংখ্যানের একটি গুরুত্বপূর্ণ টপিক (Correlation) এর সাহায্য নেব।</p> <hr> <p><a name="pearson"></a></p> <h2 id="pearson-s-correlation-co-efficient-বা-pearson-s-r"><a href="#pearson-s-correlation-co-efficient-বা-pearson-s-r" class="header-anchor">#</a> Pearson's Correlation Co-efficient বা Pearson's r</h2> <p>Pandas লাইব্রেরিতে কো-রিলেশন ফাংশন কল করলে সেটা নিচের সূত্রানুযায়ী কো-রিলেশন ক্যালকুলেট করে। কো-রিলেশন নিয়ে বিস্তারিত আলোচনা আরও করা হবে, আপাতত এই ফরমুলা নিয়ে খুশি থাকুন।</p> <section><div><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>=</mo><mfrac><mrow><mo>∑</mo><mi>x</mi><mi>y</mi></mrow><msqrt><mrow><mo>∑</mo><msup><mi>x</mi><mn>2</mn></msup><mo>∑</mo><msup><mi>y</mi><mn>2</mn></msup></mrow></msqrt></mfrac></mrow><annotation encoding="application/x-tex">r = \frac{\sum xy}{ \sqrt{ \sum x^{2} \sum y^{2} }}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.557em;vertical-align:-1.13em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.175005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.934995em;"><span class="svg-align" style="top:-3.2em;"><span class="pstrut" style="height:3.2em;"></span><span class="mord" style="padding-left:1em;"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span style="top:-2.894995em;"><span class="pstrut" style="height:3.2em;"></span><span class="hide-tail" style="min-width:1.02em;height:1.28em;"><svg width="400em" height="1.28em" viewBox="0 0 400000 1296" preserveAspectRatio="xMinYMin slice"><path d="M263,681c0.7,0,18,39.7,52,119
c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120
c340,-704.7,510.7,-1060.3,512,-1067
l0 -0
c4.7,-7.3,11,-11,19,-11
H40000v40H1012.3
s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232
c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1
s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26
c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z
M1001 80h400000v40h-400000z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.30500499999999997em;"><span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">x</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.13em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></div></section><p>এই ফরমুলায়, x হচ্ছে একটা ভ্যারিয়েবল আর y হচ্ছে আরেকটা ভ্যারিয়েবল (Isn't it too obvious?)।</p> <p>আমাদের বের করতে হবে <code>r</code> এর মান কত। r এর মান দিয়ে আমরা বুঝতে পারি যে দুইটা ভ্যারিয়েবলের সামঞ্জস্যতা কতখানি। যদি <code>r = 1</code> হয় তারমানে দুইটা ভ্যারিয়েবলের মধ্যে কোন পার্থক্য নাই, তাই <strong>যেকোন ভ্যারিয়েবলের নিজের সাথে কো-রিলেশন ক্যালকুলেট করলে r এর মান হয় 1</strong></p> <p>আরও ব্যাখ্যা যদি চান, উপরের উদাহরণের <code>Acre</code> এবং <code>Sq meter</code> এর মধ্যকার Correlation Co-efficient ক্যালকুলের করলে <code>r</code> এর মান 1 পাবেন।</p> <p><strong>প্রমাণ:</strong> <img src="https://i.imgur.com/LF7h9hO.gif" alt="corr"></p> <p>এবার দেখা যাক ডেটাসেটের কোন কলামে কোন ডেটা মিসিং আছে কিনা সেটা কীভাবে বের করা যায়।</p> <h2 id="null-বা-ডেটাসেট-এর-ফাঁকা-অংশ-বের-করা"><a href="#null-বা-ডেটাসেট-এর-ফাঁকা-অংশ-বের-করা" class="header-anchor">#</a> Null বা ডেটাসেট এর ফাঁকা অংশ বের করা</h2> <p>আগের তৈরি করা নোটবুক ওপেন করুন আর নিচের কোডটি লিখুন,</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">print</span> data_frame<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>values<span class="token punctuation">.</span><span class="token builtin">any</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="isnull-values-any"><a href="#isnull-values-any" class="header-anchor">#</a> <code>isnull().values.any()</code></h4> <h5 id="isnull"><a href="#isnull" class="header-anchor">#</a> <code>isnull()</code></h5> <p>এটা আবার সেই ডেটাফ্রেমকেই রিটার্ন করে কিন্তু পার্থক্য হল সেখানে আর ভ্যালু থাকে না, Empty Cell রিপ্লেস হয় <code>True</code> দিয়ে আর Non-Empty Cell রিপ্লেস হয় <code>False</code> দিয়ে।</p> <p><img src="https://i.imgur.com/obHUHL6.gif" alt="checkdata1"></p> <h5 id="values-any"><a href="#values-any" class="header-anchor">#</a> <code>values.any()</code></h5> <p><img src="https://i.imgur.com/PslceFv.gif" alt="checkdata2"></p> <p><code>isnull()</code> রিটার্ন করে ডেটাফ্রেম, কিন্তু <code>.values</code> দিলে সেটা <code>True/False</code> এর একটা অ্যারে তে পরিণত হয়।</p> <p>‍<code>.any()</code> ফাংশন চেক করে অ্যারেতে থাকা কোন ভ্যালু ফাঁকা বা Empty কিনা।</p> <p><code>pima-data.csv</code> ফাইলে কোন ফাঁকা ডেটা নাই। তাই এই প্রোগ্রাম স্টেটমেন্টটি কল করলে <code>False</code> দেখায়।</p> <h4 id="ইচ্ছাকৃত-একটা-cell-ডিলেট-করে-আবার-data-frame-isnull-values-any-স্টেটমেন্ট-রান-করা"><a href="#ইচ্ছাকৃত-একটা-cell-ডিলেট-করে-আবার-data-frame-isnull-values-any-স্টেটমেন্ট-রান-করা" class="header-anchor">#</a> ইচ্ছাকৃত একটা Cell ডিলেট করে আবার <code>data_frame.isnull().values.any()</code> স্টেটমেন্ট রান করা</h4> <p>এখানে আমি <code>pima-data.csv</code> ফাইলের একটা সেল ইচ্ছে করে ডিলেট করে আবার Pandas দিয়ে লোড করে কোডটা চালিয়ে দেখলাম।</p> <p>দেখা যাচ্ছে এখন আউটপুট আসছে <code>True</code>। তারমানে কোন না কোন একটা সেল খালি আছে।</p> <p><img src="https://i.imgur.com/17S9kjr.gif" alt="checkdata3"></p> <hr> <h2 id="correlation-matrix-heatmap-তৈরি-করা"><a href="#correlation-matrix-heatmap-তৈরি-করা" class="header-anchor">#</a> Correlation Matrix Heatmap তৈরি করা</h2> <p>আমরা এতক্ষণে Correlation সম্পর্কে কিছুটা জানলাম আর দেখলাম ডেটাসেট এ কোন Null ভ্যালু লুকিয়ে থাকলে সেটাকে কীভাবে বের করা যায়। এখন দেখব, কীভাবে Correlation Matrix Heatmap জেনারেট করতে হয়। তার আগে একটু বলা যাক, Heatmap টা কী জিনিস।</p> <h3 id="heatmap"><a href="#heatmap" class="header-anchor">#</a> Heatmap</h3> <p>উইকিপিডিয়া অনুসারে,</p> <blockquote><p>A heat map (or heatmap) is a graphical representation of data where the individual values contained in a matrix are represented as colors.</p></blockquote> <p>অর্থাৎ, নিউমেরিক্যাল ভ্যালু আমরা রং দিয়ে রিপ্লেস করে একটা প্লট জেনারেট করি। সেটাই হবে Heatmap।</p> <p>তারমানে, Correlation Heatmap হচ্ছে Correlation ভ্যালুগুলোকে রং দিয়ে রিপ্লেস করে গ্রাফে প্লট করা।</p> <h3 id="correlation-heatmap"><a href="#correlation-heatmap" class="header-anchor">#</a> Correlation Heatmap</h3> <p>আমরা দেখেছি, দুইটা ভ্যারিয়েবলের মধ্যে <a href="#pearson">কো-রিলেশন ক্যালকুলেট করে কীভাবে</a></p> <p>আপনি নিজেই নিজেকে প্রশ্ন করে দেখুন, কতগুলা ভ্যালু (ফ্লোটিং পয়েন্ট) কে তুলনা করা সহজ নাকি রং তুলনা করা সহজ? অবশ্যই রং তুলনা করা সহজ,</p> <p>আমাদের যে কাজটা করতে হবে সেটা হল একটা ভ্যারিয়েবল বাছাই করে প্রত্যেকটা ভ্যারিয়েবলের সাথে কো রিলেশন বের করতে হবে (এমনকি তার নিজের সাথেও)। এটা করার জন্য আমরা ভ্যারিয়েবল গুলো Row এবং Column wise সাজাব,</p> <table><thead><tr><th>----</th> <th><strong>num_preg</strong></th> <th><strong>glucose_conc</strong></th> <th>diastolic_bp</th> <th>thickness</th> <th>insulin</th> <th>bmi</th> <th>age</th></tr></thead> <tbody><tr><td><strong>num_preg</strong></td> <td><strong>1</strong></td> <td>corr_value</td> <td>corr_value</td> <td>corr_value</td> <td>corr_value</td> <td>corr_value</td> <td>corr_value</td></tr> <tr><td><strong>glucose_conc</strong></td> <td>corr_value</td> <td><strong>1</strong></td> <td>corr_value</td> <td>corr_value</td> <td>corr_value</td> <td>corr_value</td> <td>corr_value</td></tr> <tr><td><strong>diastolic_bp</strong></td> <td>corr_value</td> <td>corr_value</td> <td><strong>1</strong></td> <td>corr_value</td> <td>corr_value</td> <td>corr_value</td> <td>corr_value</td></tr> <tr><td><strong>thickness</strong></td> <td>corr_value</td> <td>corr_value</td> <td>corr_value</td> <td><strong>1</strong></td> <td>corr_value</td> <td>corr_value</td> <td>corr_value</td></tr> <tr><td><strong>insulin</strong></td> <td>corr_value</td> <td>corr_value</td> <td>corr_value</td> <td>corr_value</td> <td><strong>1</strong></td> <td>corr_value</td> <td>corr_value</td></tr> <tr><td><strong>bmi</strong></td> <td>corr_value</td> <td>corr_value</td> <td>corr_value</td> <td>corr_value</td> <td>corr_value</td> <td><strong>1</strong></td> <td>corr_value</td></tr> <tr><td><strong>age</strong></td> <td>corr_value</td> <td>corr_value</td> <td>corr_value</td> <td>corr_value</td> <td>corr_value</td> <td>corr_value</td> <td><strong>1</strong></td></tr></tbody></table> <p>আগেই বলা হয়েছিল, কোন ভ্যারিয়েবলের নিজের সাথে কো রিলেশন সবসময় <strong>1</strong> হবে। টেবিলের ডায়াগনাল বরাবর যত মান আছে সব অবশ্যই <strong>1</strong> হবে কারণ তাদের নিজেদের মধ্যে কো-রিলেশন বের করা হয়েছে। আর corr_value দ্বারা বুঝানো হয়েছে একটা ভ্যারিয়েবল ও আরেকটা ভ্যারিয়েবলের কো-রিলেশন কোন একটা ভ্যালু হতে পারে, যেহেতু আমরা লাইব্রেরি ব্যবহার করে এই ভ্যালুগুল‌ো নির্ধারণ করব তাই আমাদের নিজেদের হাতে ক্যালকুলেট করার প্রয়োজন দেখছি না।</p> <p>এবার যেটা গুরুত্বপূর্ণ কাজ সেটা হল হিটম্যাপের রং বাছাই করা। চিন্তা করার কিছু নাই, Matplotlib লাইব্রেরির বিল্ট ইন কালার ম্যাপ দেখেই আমরা আপাতত কাজ করতে পারব। আপনি চাইলে ডকুমেন্টেশন ঘেঁটে নিজের পছন্দমত রং দিতে পারেন। আপাতত আমরা ডিফল্টটাই ব্যবহার করব।</p> <hr> <h5 id="matplotlib-heat-map-color-guide"><a href="#matplotlib-heat-map-color-guide" class="header-anchor">#</a> Matplotlib Heat Map Color Guide</h5> <p>Matplotlib হিটম্যাপ জেনারেট করার সময় নিচের সিকোয়েন্স অনুযায়ী রং সেট করবে।</p> <div class="language- extra-class"><pre class="language-text"><code>Less Correlated to More Correlated
Blue -&gt; Cyan -&gt; Yellow -&gt; Red -&gt; Dark Red (Correlation 1)
</code></pre></div><h3 id="heatmap-জেনারেট-করার-ফাংশন"><a href="#heatmap-জেনারেট-করার-ফাংশন" class="header-anchor">#</a> Heatmap জেনারেট করার ফাংশন</h3> <p>চলুন, চটপট হিটম্যাপ জেনারেট করার ফাংশন লিখে ফেলি, ফাংশনটা হবে এরকম</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># Here size means plot-size</span>
<span class="token keyword">def</span> <span class="token function">corr_heatmap</span><span class="token punctuation">(</span>data_frame<span class="token punctuation">,</span> size<span class="token operator">=</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token comment"># Getting correlation using Pandas</span>
  correlation <span class="token operator">=</span> data_frame<span class="token punctuation">.</span>corr<span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token comment"># Dividing the plot into subplots for increasing size of plots</span>
  fig<span class="token punctuation">,</span> heatmap <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span>size<span class="token punctuation">,</span> size<span class="token punctuation">)</span><span class="token punctuation">)</span>

  <span class="token comment"># Plotting the correlation heatmap</span>
  heatmap<span class="token punctuation">.</span>matshow<span class="token punctuation">(</span>correlation<span class="token punctuation">)</span>

  <span class="token comment"># Adding xticks and yticks</span>
  plt<span class="token punctuation">.</span>xticks<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>correlation<span class="token punctuation">.</span>columns<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> correlation<span class="token punctuation">.</span>columns<span class="token punctuation">)</span>
  plt<span class="token punctuation">.</span>yticks<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>correlation<span class="token punctuation">.</span>columns<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> correlation<span class="token punctuation">.</span>columns<span class="token punctuation">)</span>

  <span class="token comment"># Displaying the graph</span>
  plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="কেন-সাবপ্লট-ব্যবহার-করলাম"><a href="#কেন-সাবপ্লট-ব্যবহার-করলাম" class="header-anchor">#</a> কেন সাবপ্লট ব্যবহার করলাম?</h4> <p>ইচ্ছা করলে এখানে <code>plt.matshow(correlation)</code> ব্যবহার করেও হিটম্যাপ জেনারেট করা যেত, কিন্তু তাতে আমি ইচ্ছামত আকারের গ্রাফ জেনারেট করতে পারতাম না, তাই প্লটকে সাবপ্লটে নিয়ে সাইজ অ্যাসাইন করে ইচ্ছামত আকারের সুবিধাজনক প্লট জেনারেট করা যাচ্ছে।</p> <h4 id="xticks-ও-yticks-কী"><a href="#xticks-ও-yticks-কী" class="header-anchor">#</a> <code>xticks</code> ও <code>yticks</code> কী?</h4> <p><code>plt.xticks(range(len(correlation.columns)), correlation.columns)</code> এই কোড দিয়ে বুঝানো হয়েছে, প্রতি ব্লকের দৈর্ঘ্য হবে 1 একক করে এবং দাগগুলো হবে 0, 1, 2 ... len(correlation.columns) পর্যন্ত। আর পরবর্তী আর্গুমেন্ট <code>(correlation.columns)</code> দিয়ে প্রতিটা ব্লকের লেবেল দেওয়া হয়েছে।</p> <p><code>plt.yticks..</code> এর জন্য একই কথা প্রযোজ্য।</p> <h4 id="plt-show-দিয়ে-কী-করা-হয়েছে"><a href="#plt-show-দিয়ে-কী-করা-হয়েছে" class="header-anchor">#</a> <code>plt.show()</code> দিয়ে কী করা হয়েছে?</h4> <p>U kiddin' bro?</p> <hr> <h3 id="corr-heatmap-data-frame-size-ফাংশনের-মাধ্যমে-হিটম্যাপ-প্লটিং"><a href="#corr-heatmap-data-frame-size-ফাংশনের-মাধ্যমে-হিটম্যাপ-প্লটিং" class="header-anchor">#</a> <code>corr_heatmap(data_frame, size)</code> ফাংশনের মাধ্যমে হিটম্যাপ প্লটিং</h3> <p>কষ্ট করে ফাংশন লিখলাম আর না ব্যবহার করলে চলে? নিচের কোড স্নিপেট দিয়ে সহজেই হিটম্যাপ প্লট করতে পারি,</p> <div class="language-python extra-class"><pre class="language-python"><code>corr_heatmap<span class="token punctuation">(</span>data_frame<span class="token punctuation">)</span>
</code></pre></div><p><img src="https://i.imgur.com/hLZ1Jvt.gif" alt="heatmap"></p> <h5 id="জেনারেটেড-হিটম্যাপ-ক্লোজভিউ"><a href="#জেনারেটেড-হিটম্যাপ-ক্লোজভিউ" class="header-anchor">#</a> জেনারেটেড হিটম্যাপ ক্লোজভিউ</h5> <p><img src="https://i.imgur.com/jr68EBl.png" alt="heatmapcloser"></p> <h3 id="লক্ষণীয়"><a href="#লক্ষণীয়" class="header-anchor">#</a> লক্ষণীয়</h3> <p>আমরা আগেই দেখেছিলাম দুইটা ভ্যারিয়েবল যদি একই রকম হয় তাহলে তাদের Correlation 1 হবে। ডায়াগনালে প্রতিটা ভ্যারিয়েবলে তার নিজের সাথে কো-রিলেশন বের করা হয়েছে তাই ডায়াগনালের ব্লকগুলোর রং গাঢ় লাল।</p> <p>কিন্তু ভাল করে লক্ষ করে দেখবেন, <code>skin</code> এবং <code>thickness</code> এই দুইটার কো-রিলেশন কিন্তু 1 (গাঢ় লাল রং)।</p> <p>তারমানে, <code>skin</code> আর <code>thickness</code> আসলে একই জিনিস, একক এর হেরফের হয়েছে শুধু। বিশ্বাস হচ্ছে না?</p> <p>এক কাজ করুন তাহলে, <code>thickness</code> এর প্রতিটা ভ্যালু কে <code>0.0393701</code> দিয়ে গুণ দিন তাহলে দেখবেন আপনি <code>skin</code> এর ভ্যালু পেয়ে যাচ্ছেন। <code>1 millimeter = 0.0373701 inch</code> এবার আপনিই বলতে পারবেন কোনটার একক আসলে কী?</p> <h3 id="কালপ্রিট-পেলাম-এবার-ডেটাসেট-ক্লিনিং"><a href="#কালপ্রিট-পেলাম-এবার-ডেটাসেট-ক্লিনিং" class="header-anchor">#</a> কালপ্রিট পেলাম, এবার ডেটাসেট ক্লিনিং</h3> <p>উপরের কাজ থেকে এটা বুঝলাম আমরা যে একই টাইপের কলাম কোনগুলা। Tidy Data এর বৈশিষ্ট ছিল প্রতিটা কলাম কে অবশ্যই Unique হতে হবে। ডুপ্লিকেটগুলো থেকে একটা রেখে বাকিটা ডেটাসেট থেকে উধাও করতে হবে।</p> <p>আমি এখানে <code>skin</code> ভ্যারিয়েবল উধাও করব, আপনি চাইলে একে <strong>অথবা</strong> <code>thickness</code> কে উধাও করতে পারেন, সম্পূর্ণ আপনার ইচ্ছা।</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># Deleting 'skin' column completely</span>
<span class="token keyword">del</span> data_frame<span class="token punctuation">[</span><span class="token string">'skin'</span><span class="token punctuation">]</span>
<span class="token comment"># Checking if the action was successful or not</span>
df<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="https://i.imgur.com/4StJ8jF.gif" alt="vanish"></p> <hr> <p>আমরা একটা ডুপ্লিকেট কলাম কে ফেলে দিতে পারলাম। এখনো কাজ শেষ হয় নাই, ডেটা মোল্ড করতে হবে। চিন্তার কিছু নাই, ডেটা প্রিপারেশনের এটাই শেষ ধাপ। So cheers!</p> <h2 id="ডেটা-মোল্ডিং-data-molding"><a href="#ডেটা-মোল্ডিং-data-molding" class="header-anchor">#</a> ডেটা মোল্ডিং (Data Molding)</h2> <h3 id="ডেটা-টাইপ-অ্যাডজাস্টমেন্ট"><a href="#ডেটা-টাইপ-অ্যাডজাস্টমেন্ট" class="header-anchor">#</a> ডেটা টাইপ অ্যাডজাস্টমেন্ট</h3> <p>আমাদের ডেটাসেট এমন হতে হবে তা যেন সবরকম অ্যালগরিদমে কাজ করার উপযোগী হয়। না হলে প্রতিটা অ্যালগরিদমের জন্য আমাদের ডেটা টুইকিং করতে হবে যেটা বেশ ঝামেলার কাজ। তাই আমরা ঝামেলার কাজটা বার বার না করে একবারই করব যাতে আর সেটা মাথাব্যাথার কারণ না হয়ে দাঁড়ায়।</p> <h4 id="ডেটা-টাইপ-চেকিং"><a href="#ডেটা-টাইপ-চেকিং" class="header-anchor">#</a> ডেটা টাইপ চেকিং</h4> <p>ডেটা মোল্ডিংয়ের আগে একবার ডেটাটাইপ গুলো চেক করে নেওয়া যাক।</p> <p><code>data_frame.head()</code></p> <p>এটা দিলেই আবারও ডেটাফ্রেমের কিছু স্যাম্পল দেখতে পাবেন এবং ভাল করে লক্ষ করে দেখবেন এখানে সবগুলো ভ্যালুই ফ্লোট বা ইন্টিজার টাইপ কিন্তু একটা রয়ে গেছে <code>Boolean</code> টাইপ।</p> <p><img src="https://i.imgur.com/6HL0KYf.png" alt="type"></p> <h4 id="ডেটা-টাইপ-চেঞ্জিং"><a href="#ডেটা-টাইপ-চেঞ্জিং" class="header-anchor">#</a> ডেটা টাইপ চেঞ্জিং</h4> <p>True কে আমরা 1 বানাবো এবং False কে বানাব 0। নিচের কোড স্নিপেট টি দিয়েই কাজটা করা যাবে,</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># Mapping the values</span>
map_diabetes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token boolean">True</span> <span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token boolean">False</span> <span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">}</span>

<span class="token comment"># Setting the map to the data_frame</span>
data_frame<span class="token punctuation">[</span><span class="token string">'diabetes'</span><span class="token punctuation">]</span> <span class="token operator">=</span> data_frame<span class="token punctuation">[</span><span class="token string">'diabetes'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span>map_diabetes<span class="token punctuation">)</span>

<span class="token comment"># Let's see what we have done</span>
data_frame<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="https://i.imgur.com/cOLRh2E.gif" alt="typechange"></p> <h3 id="অভিনন্দন"><a href="#অভিনন্দন" class="header-anchor">#</a> অভিনন্দন!</h3> <p>এই মোল্ডেড ও ক্লিনড ডেটাসেট আমরা আমাদের ইচ্ছানুযায়ী অ্যালগরিদমে বসিয়ে কাজ করতে পারবো।</p> <h4 id="কিন্তু"><a href="#কিন্তু" class="header-anchor">#</a> কিন্তু?</h4> <h4 id="data-rule-3"><a href="#data-rule-3" class="header-anchor">#</a> Data Rule #3</h4> <blockquote><p>Rare ইভেন্ট হাই অ্যাকুরেসির সাথে প্রেডিক্ট করার সম্ভাবনা কম</p></blockquote> <p>স্বাভাবিক, কারণ Rare ইভেন্ট মানে আপনার ডেটাসেট এ এইরকম ইভেন্ট কম থাকবে। আর এইরকম ইভেন্টের ডেটাসেট যত কম থাকবে প্রেডিকশন ও ততটাই খারাপ আসবে। তবে এটা নিয়ে চিন্তা না করাই ভাল। আগে গতানুগতিক প্রেডিকশন ঠিক করেন, পরে না হয় রেয়ার ইভেন্ট ঠিক করলেন।</p> <hr> <p>আরও কিছু অ্যানালাইসিস।</p> <h3 id="true-false-ratio-চেক-করা"><a href="#true-false-ratio-চেক-করা" class="header-anchor">#</a> True / False Ratio চেক করা</h3> <p>আমরা চাইলে দেখতে পারি, এই ডেটাসেট এ শতকরা কতজন ডায়বেটিসে আক্রান্ত আর কতজন নয়, নোটবুক বের করে ঝটপট কোড লিখে ফেলেন।</p> <div class="language-python extra-class"><pre class="language-python"><code>num_true <span class="token operator">=</span> <span class="token number">0.0</span>
num_false <span class="token operator">=</span> <span class="token number">0.0</span>
<span class="token keyword">for</span> item <span class="token keyword">in</span> data_frame<span class="token punctuation">[</span><span class="token string">'diabetes'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> item <span class="token operator">==</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        num_true <span class="token operator">+=</span> <span class="token number">1</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        num_false <span class="token operator">+=</span> <span class="token number">1</span>

percent_true <span class="token operator">=</span> <span class="token punctuation">(</span>num_true <span class="token operator">/</span> <span class="token punctuation">(</span>num_true <span class="token operator">+</span> num_false<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span>
percent_false <span class="token operator">=</span> <span class="token punctuation">(</span>num_false <span class="token operator">/</span> <span class="token punctuation">(</span>num_true <span class="token operator">+</span> num_false<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span>

<span class="token keyword">print</span> <span class="token string">&quot;Number of True Cases: {0} ({1:2.2f}%)&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>num_true<span class="token punctuation">,</span> percent_true<span class="token punctuation">)</span>
<span class="token keyword">print</span> <span class="token string">&quot;Number of False Cases: {0} ({1:2.2f}%)&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>num_false<span class="token punctuation">,</span> percent_false<span class="token punctuation">)</span>
</code></pre></div><p><strong>আউটপুট:</strong></p> <div class="language- extra-class"><pre class="language-text"><code>Number of True Cases: 268.0 (34.90%)
Number of False Cases: 500.0 (65.10%)
</code></pre></div><p>আমরা Pythonic Way তে কোডটা আসলে চার লাইনে লিখতে পারি।</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># Pythonic Way</span>
num_true <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>data_frame<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>data_frame<span class="token punctuation">[</span><span class="token string">'diabetes'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token boolean">True</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
num_false <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>data_frame<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>data_frame<span class="token punctuation">[</span><span class="token string">'diabetes'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token boolean">False</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span> <span class="token string">&quot;Number of True Cases: {0} ({1:2.2f}%)&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>num_true<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">)</span>num_true <span class="token operator">/</span> <span class="token punctuation">(</span>num_true <span class="token operator">+</span> num_false<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span>
<span class="token keyword">print</span> <span class="token string">&quot;Number of False Cases: {0} ({1:2.2f}%)&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>num_false<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">)</span>num_true <span class="token operator">/</span> <span class="token punctuation">(</span>num_true <span class="token operator">+</span> num_false<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="data-rule-4"><a href="#data-rule-4" class="header-anchor">#</a> Data Rule #4</h3> <blockquote><p>ডেটা ম্যানিপুলেশন হিস্ট্রি রাখবেন ও চেক করবেন নিয়মিত</p></blockquote> <ul><li>এটা করার জন্য একটা ব্যবস্থা আছেই (Jupyter Notebook ব্যবহার করে)</li> <li>ভার্সন কন্ট্রোল সিস্টেম ব্যবহার করে, যেমন : Git, SVN, BitBucket, GitHub, GitLab ইত্যাদি</li></ul> <h2 id="সামারি"><a href="#সামারি" class="header-anchor">#</a> সামারি</h2> <p>কী কী করলাম এই দুই পর্বে?</p> <ul><li>Pandas দিয়ে ডেটা রিড করলাম</li> <li>কো-রিলেশন সম্পর্কে ধারণা নিলাম</li> <li>ডুপ্লিকেট কলাম উচ্ছেদ করলাম</li> <li>ডেটা মোল্ড করলাম</li> <li>True/False রেশিও চেক করলাম</li></ul> <p>So far so good, পরবর্তী পর্বে আশা করি আমরা অ্যালগরিদম অ্যাপ্লাই করে প্রেডিক্ট করা শুরু করে দিব।</p> <!----></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">6/11/2020, 6:39:56 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/workflow/data-processing/" class="prev">
        ডেটা প্রস্তুত করা (ডেটা কালেকশন ও প্রিপ্রসেসিং) - ১
      </a></span> <span class="next"><a href="/workflow/algorithm-selection/">
        অ্যালগরিদম সিলেকশন
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><div></div><span></span><!----><div class="reading-progress top" data-v-21b39eda><div class="progress" data-v-21b39eda></div></div></div></div>
    <script src="/assets/js/app.ff943db8.js" defer></script><script src="/assets/js/2.838862f8.js" defer></script><script src="/assets/js/31.1f6ac9f8.js" defer></script>
  </body>
</html>
