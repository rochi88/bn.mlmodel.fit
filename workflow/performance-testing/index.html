<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>মডেল পারফর্মেন্স বা অ্যাকুরেসি টেস্টিং - পর্ব ১ | মেশিন লার্নিং ও বিভিন্ন প্রোগ্রামিং ল্যাঙ্গুয়েজে ইম্প্লিমেন্টেশন</title>
    <meta name="generator" content="VuePress 1.5.0">
    
    <meta name="description" content="বাংলায় মেশিন লার্নিং সহজ শিক্ষা">
    <link rel="preload" href="/assets/css/0.styles.6d501496.css" as="style"><link rel="preload" href="/assets/js/app.ff943db8.js" as="script"><link rel="preload" href="/assets/js/2.838862f8.js" as="script"><link rel="preload" href="/assets/js/36.9b79648c.js" as="script"><link rel="prefetch" href="/assets/js/10.e846aa23.js"><link rel="prefetch" href="/assets/js/11.354e8e9c.js"><link rel="prefetch" href="/assets/js/12.b68da5e2.js"><link rel="prefetch" href="/assets/js/13.c7c7508c.js"><link rel="prefetch" href="/assets/js/14.8ea08db1.js"><link rel="prefetch" href="/assets/js/15.7869c4dc.js"><link rel="prefetch" href="/assets/js/16.d51ceaba.js"><link rel="prefetch" href="/assets/js/17.d0d64215.js"><link rel="prefetch" href="/assets/js/18.6bfe8fdf.js"><link rel="prefetch" href="/assets/js/19.596ad80b.js"><link rel="prefetch" href="/assets/js/20.10f31d3f.js"><link rel="prefetch" href="/assets/js/21.719359da.js"><link rel="prefetch" href="/assets/js/22.06653c7e.js"><link rel="prefetch" href="/assets/js/23.bd8aff41.js"><link rel="prefetch" href="/assets/js/24.cfdbbb4c.js"><link rel="prefetch" href="/assets/js/25.e3eb0442.js"><link rel="prefetch" href="/assets/js/26.a21980e6.js"><link rel="prefetch" href="/assets/js/27.1f28ca07.js"><link rel="prefetch" href="/assets/js/28.ca9e6b26.js"><link rel="prefetch" href="/assets/js/29.19120067.js"><link rel="prefetch" href="/assets/js/3.c8a6fccb.js"><link rel="prefetch" href="/assets/js/30.324bd9be.js"><link rel="prefetch" href="/assets/js/31.1f6ac9f8.js"><link rel="prefetch" href="/assets/js/32.e099d021.js"><link rel="prefetch" href="/assets/js/33.dd075a30.js"><link rel="prefetch" href="/assets/js/34.b34ad0d4.js"><link rel="prefetch" href="/assets/js/35.28a49c94.js"><link rel="prefetch" href="/assets/js/37.1494e9da.js"><link rel="prefetch" href="/assets/js/4.8a05083b.js"><link rel="prefetch" href="/assets/js/5.32804bbb.js"><link rel="prefetch" href="/assets/js/6.7767a1f1.js"><link rel="prefetch" href="/assets/js/7.d628d3b1.js"><link rel="prefetch" href="/assets/js/8.4e7b6dcb.js"><link rel="prefetch" href="/assets/js/9.3404ad1a.js">
    <link rel="stylesheet" href="/assets/css/0.styles.6d501496.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">মেশিন লার্নিং ও বিভিন্ন প্রোগ্রামিং ল্যাঙ্গুয়েজে ইম্প্লিমেন্টেশন</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ভূমিকা</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>মেশিন লার্নিংয়ের জন্য প্রস্তুতি</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>মেশিন লার্নিং টুলবক্স</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>মেশিন লার্নিংয়ে কাজের ধারা</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/workflow/" aria-current="page" class="sidebar-link">মেশিন লার্নিংয়ে কাজের ধারা</a></li><li><a href="/workflow/howto-ask-question/" class="sidebar-link">সঠিক প্রশ্ন করবেন কীভাবে?</a></li><li><a href="/workflow/data-processing/" class="sidebar-link">ডেটা প্রস্তুত করা (ডেটা কালেকশন ও প্রিপ্রসেসিং) - ১</a></li><li><a href="/workflow/data-preprocessing-last/" class="sidebar-link">ডেটা প্রস্তুত করা (ডেটা প্রিপ্রসেসিং) - ২</a></li><li><a href="/workflow/algorithm-selection/" class="sidebar-link">অ্যালগরিদম সিলেকশন</a></li><li><a href="/workflow/model-training/" class="sidebar-link">মডেল ট্রেইনিং</a></li><li><a href="/workflow/performance-testing/" aria-current="page" class="active sidebar-link">মডেল পারফর্মেন্স বা অ্যাকুরেসি টেস্টিং - পর্ব ১</a></li><li><a href="/workflow/performance-testing-last/" class="sidebar-link">মডেল পারফর্মেন্স - দ্বিতীয় এবং শেষ পর্ব</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>লিনিয়ার রিগ্রেশন</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>লজিস্টিক রিগ্রেশন</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>মাল্টিক্লাস ক্লাসিফিকেশন</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ন্যাচারাল ল্যাঙ্গুয়েজ প্রসেসিং</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>পরিশিষ্ট</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="মডেল-পারফর্মেন্স-বা-অ্যাকুরেসি-টেস্টিং-পর্ব-১"><a href="#মডেল-পারফর্মেন্স-বা-অ্যাকুরেসি-টেস্টিং-পর্ব-১" class="header-anchor">#</a> মডেল পারফর্মেন্স বা অ্যাকুরেসি টেস্টিং - পর্ব ১</h1> <p>আমরা ডেটা সংগ্রহ থেকে মডেল ট্রেইনিং পর্যন্ত কাজ শেষ। এখন শুধু বাকি রইল মডেল কিরকম পার্ফর্মেন্স শো করছে। মডেল পারফর্মেন্স চ্যাপ্টারটা একটু বড় হবে তাই আমি একে দুইভাগে ভাগ করলাম।</p> <h2 id="দুই-পর্বের-মডেল-পারফর্মেন্স-টেস্টিং-চ্যাপ্টারের-ওভারভিউ"><a href="#দুই-পর্বের-মডেল-পারফর্মেন্স-টেস্টিং-চ্যাপ্টারের-ওভারভিউ" class="header-anchor">#</a> দুই পর্বের মডেল পারফর্মেন্স টেস্টিং চ্যাপ্টারের ওভারভিউ</h2> <h3 id="মূল-আলোচ্য-বিষয়"><a href="#মূল-আলোচ্য-বিষয়" class="header-anchor">#</a> মূল আলোচ্য বিষয়</h3> <ul><li>টেস্ট ডেটার মধ্যমে মডেল এভালুয়েশন</li> <li>রেজাল্ট ইন্টারপ্রিটেশন</li> <li>রেজাল্ট ইম্প্রুভমেন্ট / মডেল ইম্প্রুভমেন্ট / অ্যাকুরেসি ইম্প্রুভমেন্ট</li></ul> <h3 id="এছাড়াও"><a href="#এছাড়াও" class="header-anchor">#</a> এছাড়াও</h3> <ul><li>কনফিউশন ম্যাট্রিক্স
_ Recall
_ Precision
_ AUC
_ ROC</li> <li>ওভারফিটিং</li> <li>মডেল হাইপারপ্যারামিটার</li> <li>ওভারফিটিং কমানো
_ K-Fold Cross Validation বা N-Fold Cross Validation
_ Bias-Variance Trade off * ভাল পারফর্মেন্সের জন্য কিছুটা পারফেকশন ছাড় দেওয়া</li></ul> <p>হাটি হাটি পা পা করতে করতে অবশেষে আমরা চলে এলাম শেষের ধাপে,</p> <p><img src="https://i.imgur.com/YglPD3U.png" alt="modeltest"></p> <p>তাহলে শুরু করা যাক।</p> <p>মনে রাখতে হবে,</p> <blockquote><p>স্ট্যাটিস্টিক্স শুধু ডেটা নিয়ে কাজ করে, আমরা ডিফাইন করি কোনটা খারাপ আর কোনটা ভাল। এবং এই ভাল-খারাপ সম্পূর্ণ নির্ভর করে আমরা মডেল কীভাবে ব্যবহার করব।</p></blockquote> <p>অনেক থিওরি হল, এবার একটু ইম্প্লিমেন্টেশন দেখি।</p> <hr> <h3 id="যে-ডেটায়-ট্রেইন্ড-হয়েছে-সেটাতে-কেমন-পারফর্ম-করছে"><a href="#যে-ডেটায়-ট্রেইন্ড-হয়েছে-সেটাতে-কেমন-পারফর্ম-করছে" class="header-anchor">#</a> যে ডেটায় ট্রেইন্ড হয়েছে সেটাতে কেমন পারফর্ম করছে</h3> <p>আমরা কাজ শুরুর আগে ডেটাকে দুইভাগে ভাগ করেছিলাম, একটা ট্রেইনিং আরেকটা টেস্টিং। এতবার এই কথা দেখতে দেখতে মুখস্ত হয়ে যাওয়ার কথা। যাই হোক, আমরা এখন দেখব, যে ডেটায় ট্রেইন্ড হয়েছে, তাকে যদি সেই ডেটাই ফিড করানো হয়, তাহলে কিরকম প্রেডিক্ট করছে।</p> <p>ব্যাপারটা অনেকটা সেই নামতার উদাহরণের মত,</p> <p><strong>এটা যদি ট্রেইনিং ডেটা হয়:</strong></p> <div class="language- extra-class"><pre class="language-text"><code>3 x 1 = 3
3 x 2 = 6
...
3 x 10 = 30
</code></pre></div><p><strong>তাহলে ট্রেইন্ড ডেটায় কীরকম ট্রেইন্ড হয়েছে সেটা জানার জন্য জিজ্ঞাসা করব,</strong></p> <div class="language- extra-class"><pre class="language-text"><code>3 x 1 = ?
</code></pre></div><p>আপনার মডেলের উপর ট্রাই মারতে নিচের কোডটি রান করুন, (আগে বলা হয় নি যদিও, এই পর্যন্ত Jupyter Notebook এ যত কাজ করেছেন সেখান থেকে কন্টিনিউ করুন)</p> <div class="language-python extra-class"><pre class="language-python"><code>
<span class="token comment"># This returns array of predicted results</span>
prediction_from_trained_data <span class="token operator">=</span> nb_model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_train<span class="token punctuation">)</span>
</code></pre></div><p>এখন <code>prediction_from_trained_data</code> ভ্যারিয়েবলে প্রেডিক্ট করা অ্যারেটা অ্যাসাইন হল। আমরা চাইলে এখন খাতা কলম নিয়ে বসে দেখতে পারি, ডেটাসেট এ প্রতি Observation এ রেজাল্ট কী এবং ডেটাসেট এ প্রতি Observation এ আমাদের তৈরি করা মডেলের প্রেডিক্টেড রেজাল্ট কী।</p> <p>অথবা আরেকটা কাজ করা যায়, সাইকিট-লার্ন লাইব্রেরির বিল্ট ইন মডিউল দিয়ে চেক করতে পারি আমাদের মডেল কয়টা সঠিক ডায়বেটিস ধরতে পারল আর কয়টা পারল না।</p> <p>খাতা কলমের বদলে জুপিটার নোটবুক ওপেন করা থাকলে সেখানে লেখা শুরু করুন,</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># performance metrics library</span>
<span class="token keyword">from</span> sklearn <span class="token keyword">import</span> metrics

<span class="token comment"># get current accuracy of the model</span>

accuracy <span class="token operator">=</span> metrics<span class="token punctuation">.</span>accuracy_score<span class="token punctuation">(</span>y_train<span class="token punctuation">,</span> prediction_from_trained_data<span class="token punctuation">)</span>

<span class="token keyword">print</span> <span class="token string">&quot;Accuracy of our naive bayes model is : {0:.4f}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>accuracy<span class="token punctuation">)</span>

</code></pre></div><h4 id="যদি-ভুলে-গিয়ে-থাকেন"><a href="#যদি-ভুলে-গিয়ে-থাকেন" class="header-anchor">#</a> যদি ভুলে গিয়ে থাকেন</h4> <p>আমরা ডেটাসেট স্প্লিট করে <strong>চারটি</strong> ভ্যারিয়েবলে রেখেছিলাম, <code>X_train, y_train, X_test, y_test</code></p> <p>যেখানে,</p> <div class="language- extra-class"><pre class="language-text"><code>X_train = ট্রেইন করার ইনপুট ভ্যালুগুলো [no_of_preg, insulin, glucose ... etc] (পুরো ডেটাসেট এর ৭০%)
y_train = X_train এর করেসপন্ডিং আউটপুট [diabetes -&gt; yes/no] (যেহেতু y_train এর করেসপন্ডিং ভ্যালু, বোঝাই যাচ্ছে এটাও ৭০%)

X_test = টেস্ট করার ইনপুট ভ্যালুগুলো [পুরো ডেটাসেট এর ৩০% ছিল এবং এই ৩০% ট্রেইনিং ডেটার অস্তিত্ব নাই]
y_test = টেস্ট করার ইনপুটের করেসপন্ডিং আউটপুট
</code></pre></div><p>আমরা যেহেতু দেখছি ** ট্রেইন্ড ডেটায় অ্যাকুরেসি কীরকম**, তাই এটা হওয়াই স্বাভাবিক না যে <code>metrics.accuracy_score</code> ফাংশনে আমরা <code>X_train</code> এ মডেলের আউটপুট <code>(prediction_from_trained_data)</code> এবং <code>X_train</code> এর আসল আউটপুট <code>(y_train)</code>।</p> <h3 id="আগের-কোড-স্নিপেটের-আউটপুট"><a href="#আগের-কোড-স্নিপেটের-আউটপুট" class="header-anchor">#</a> আগের কোড স্নিপেটের আউটপুট</h3> <p>আগের কোড স্নিপেটের আউটপুট হল এটা,</p> <div class="language- extra-class"><pre class="language-text"><code>Accuracy of our naive bayes model is : 0.7542
</code></pre></div><p>আমাদের সল্যুশন স্টেটমেন্টে টার্গেট ছিল ৭০ বা তার বেশি অ্যাকুরেসি তে প্রেডিক্ট করা। কিন্তু এখানে আমরা দেখতে পাচ্ছি অ্যাকুরেসি প্রায় <code>75%</code>।</p> <p>থামেন, আগেই সেলিব্রেট করার মত কিছু হয় নাই। এই অ্যাকুরেসি স্কোর কিন্তু ট্রেইন্ড ডেটার উপর, মানে এই ডেটা দিয়েই তাকে ট্রেইন্ড করে আবার সেই ডেটায় প্রেডিকশন টেস্ট করছি। অর্থাৎ সিলেবাসের জিনিসপত্রই জিজ্ঞেস করা হল।</p> <h2 id="টেস্টিং-ডেটায়-পার্ফর্মেন্স"><a href="#টেস্টিং-ডেটায়-পার্ফর্মেন্স" class="header-anchor">#</a> টেস্টিং ডেটায় পার্ফর্মেন্স</h2> <p>এবার আপনাকে যদি বলি টেস্টিং ডেটায় পারফর্মেন্স কী হবে সেটার কোড লেখেন, তাহলে আপনি যা করতেন তার সাথে নিচের কোডের মিল আছে কিনা লক্ষ করুন,</p> <div class="language-python extra-class"><pre class="language-python"><code>
<span class="token comment"># this returns array of predicted results from test_data</span>
prediction_from_test_data <span class="token operator">=</span> nb_model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span>

accuracy <span class="token operator">=</span> metrics<span class="token punctuation">.</span>accuracy_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> prediction_from_test_data<span class="token punctuation">)</span>

<span class="token keyword">print</span> <span class="token string">&quot;Accuracy of our naive bayes model is: {0:0.4f}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>accuracy<span class="token punctuation">)</span>

</code></pre></div><h3 id="আউটপুট"><a href="#আউটপুট" class="header-anchor">#</a> আউটপুট</h3> <div class="language- extra-class"><pre class="language-text"><code>Accuracy of our naive bayes model is: 0.7359
</code></pre></div><p><img src="https://i.imgur.com/7hPm7Cz.gif" alt="p_t"></p> <p>তার মানে হল সিলেবাসের বাইরে থেকে প্রশ্ন জিজ্ঞাসা করলেও সে ৭০% অ্যাকুরেসির সাথে উত্তর দিতে পারছে, তারমানে তার দেওয়া উত্তরের ৭৩% সঠিক এবং বাকিটা ভুল।</p> <p>আমরা এটাই চেয়েছিলাম, অর্থাৎ আমরা যদি এই ট্রেইন্ড মডেলে এবার নতুন পরীক্ষিত কোন ব্যক্তির ডেটা ইনপুট দেই তাহলে তার উত্তর সঠিক হওয়ার সম্ভাবনা ৭৩%। যদি মডেল বলে নতুন ব্যক্তির ডায়বেটিস হতে পারে, তার likelihood হল ৭০%।</p> <h2 id="কিন্তু"><a href="#কিন্তু" class="header-anchor">#</a> কিন্তু</h2> <p>হ্যাঁ ঠিক ধরেছেন, এখনো সেলিব্রেশনের সময় আসে নি। ডেটা কালেকশনের পরবর্তী পেইনফুল কাজ হল পারফর্মেন্স টেস্টিং এবং প্রয়োজনীয় পরিবর্তন করা।</p> <hr> <h2 id="ক্লাসিফিকেশন-টাইপ-প্রবলেমের-পারফর্মেন্স-টেস্টিং-কনফিউশন-ম্যাট্রিক্স"><a href="#ক্লাসিফিকেশন-টাইপ-প্রবলেমের-পারফর্মেন্স-টেস্টিং-কনফিউশন-ম্যাট্রিক্স" class="header-anchor">#</a> ক্লাসিফিকেশন টাইপ প্রবলেমের পারফর্মেন্স টেস্টিং : কনফিউশন ম্যাট্রিক্স</h2> <p>আমাদের সমস্যাটি ক্লাসিফিকেশন টাইপের আর এর জন্য আলাদা কিছু <code>measurement</code> আছে পারফর্মেন্স টেস্ট করার জন্য। যেটার কথা না বললেই নয় সেটা হল <code>Confusion Matrix</code>। নাম শুনে কনফিউজ হওয়ার কিছু নেই। কোড লেখার পাশাপাশি আমরা এ বিষয়ে বিস্তারিত জেনে নেব।</p> <p>আপাতত জেনে রাখুন কনফিউশন ম্যাট্রিক্স দিয়ে আমরা জানতে পারব আমাদের মডেলের পার্ফর্মেন্স কীরকম। তাহলে নিচের কোডটি লিখুন,</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">print</span> <span class="token string">&quot;Confusion Matrix&quot;</span>

<span class="token comment"># labels for set 1=True to upper left and 0 = False to lower right</span>
<span class="token keyword">print</span> <span class="token string">&quot;{0}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>metrics<span class="token punctuation">.</span>confusion_matrix<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> prediction_from_test_data<span class="token punctuation">,</span> labels<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="https://i.imgur.com/z609uE0.gif" alt="performance2"></p> <h3 id="কনফিউশন-ম্যাট্রিক্স"><a href="#কনফিউশন-ম্যাট্রিক্স" class="header-anchor">#</a> কনফিউশন ম্যাট্রিক্স</h3> <table><thead><tr><th></th> <th>Predicted True (col 0)</th> <th>Predicted False (col 1)</th></tr></thead> <tbody><tr><td>**Actual True ** row -&gt; 0</td> <td>52 (TP)</td> <td>28 (FP)</td></tr> <tr><td><strong>Actual False</strong> row -&gt; 1</td> <td>33 (FN)</td> <td>118 (TN)</td></tr></tbody></table> <p>আমরা টেবিলের নাম্বারগুলোকে TP, FP, FN ও TN দ্বারা প্রকাশ করতে পারি। যেখানে,</p> <div class="language- extra-class"><pre class="language-text"><code>TP = আসল আউটপুট হল ১ বা ডায়বেটিস হওয়ার সম্ভাবনা আছে **এবং** আমাদের তৈরি করা মডেলও প্রেডিক্ট করেছে ১
FP = আসল আউটপুট হল ০ বা ডায়বেটিস হওয়ার সম্ভাবনা নাই **কিন্তু** আমাদের তৈরি করা মডেল প্রেডিক্ট করছে ১
FN = আসল আউটপুট হল ১ বা ডায়বেটিস হওয়ার সম্ভাবনা আছে **কিন্তু** আমাদের তৈরি করা মডেল প্রেডিক্ট করছে ০
TN = আসল আউটপুট হল ০ এবং আমাদের মডেলও প্রেডিক্ট করছে ০
</code></pre></div><p>কনফিউশন ম্যাট্রিক্স একটু কনফিউজিং মনে হলে, ভালভাবে আরেকবার চিন্তা করুন এবং আপনার চিন্তার সাথে সাথে টেবিলটি বুঝতে চেষ্টা করুন।</p> <p><strong>শর্টকাটে,</strong></p> <ul><li>TP = কতগুলা ঘটনা ঘটেছে এবং ঘটেছে হিসেবে ডিটেক্ট করেছে</li> <li>FP = কতগুলা ঘটনা ঘটে নাই কিন্তু ঘটেছে হিসেবে ডিটেক্ট করেছে</li> <li>FN = কতগুলা ঘটনা ঘটেছে কিন্তু ঘটে নাই হিসেবে ডিটেক্ট করেছে</li> <li>TN = কতগুলা ঘটনা ঘটে নাই এবং ডিটেক্ট ও করে নাই</li></ul> <p><strong>আরেকবার দেখা যাক, তাহলে উপরের স্ট্যাটিস্টিক্স অনুযায়ী,</strong></p> <ul><li>52 টা ঘটনা ডায়বেটিস হিসেবে ডিটেক্ট করেছে এবং 52 জন আসলেই ডায়বেটিসে আক্রান্ত &lt;- TP</li> <li>28 টা ঘটনা ডায়বেটিস হিসেবে ডিটেক্ট করেছে কিন্তু ওই 28 জন আসলে ডায়বেটিসে আক্রান্ত নয় &lt;- FP</li> <li>33 টা ঘটনা ডায়বেটিস হিসেবে ডিটেক্ট করে নাই কিন্তু ওই 33 জন আসলে ডায়বেটিসে আক্রান্ত &lt;- FN</li> <li>118 টা ঘটনা ডায়বেটিস হিসেবে ডিটেক্ট করে নাই এবং ওই 118 জন ডায়বেটিসে আক্রান্ত নয় &lt;- TN</li></ul> <h2 id="যদি-আমাদের-মডেল-১০০-অ্যাকুরেট-হত-তাহলে-কীরকম-হত-তার-কনফিউশন-ম্যাট্রিক্স"><a href="#যদি-আমাদের-মডেল-১০০-অ্যাকুরেট-হত-তাহলে-কীরকম-হত-তার-কনফিউশন-ম্যাট্রিক্স" class="header-anchor">#</a> যদি আমাদের মডেল ১০০% অ্যাকুরেট হত তাহলে কীরকম হত তার কনফিউশন ম্যাট্রিক্স?</h2> <p>সহজেই বোঝা যাচ্ছে, 100% Accurate Model এর ক্ষেত্রে FP = 0 এবং FN = 0 হবে। তাহলে কনফিউশন ম্যাট্রিক্স হবে এইরকম,</p> <table><thead><tr><th></th> <th>Predicted True</th> <th>Predicted False</th></tr></thead> <tbody><tr><td>**Actual True **</td> <td>80 (TP)</td> <td>0 (FP)</td></tr> <tr><td><strong>Actual False</strong></td> <td>0 (FN)</td> <td>151 (TN)</td></tr></tbody></table> <hr> <h2 id="কনফিউশন-ম্যাট্রিক্স-পর্যালোচনা-ক্লাসিফিকেশন-রিপোর্ট"><a href="#কনফিউশন-ম্যাট্রিক্স-পর্যালোচনা-ক্লাসিফিকেশন-রিপোর্ট" class="header-anchor">#</a> কনফিউশন ম্যাট্রিক্স পর্যালোচনা : ক্লাসিফিকেশন রিপোর্ট</h2> <p>কনফিউশন ম্যাট্রিক্স এর মাধ্যমে মডেল অ্যাকুরেসি বের করার জন্য আমরা আরও কিছু স্ট্যাটিস্টিক্স রিপোর্ট দেখতে পারি। সূত্র দেখার পাশাপাশি সাইকিট এর বিল্ট ইন ফাংশন দিয়ে কীভাবে বের করা যায় আমরা সেটাও দেখব।</p> <p>ক্লাসিফিকেশন রিপোর্ট জেনারেট হয় আসলে কনফিউশন ম্যাট্রিক্সের ডেটার উপরে। ক্লাসিফিকেশন রিপোর্ট দেখার জন্য নিচের স্টেটমেন্ট রান করুন,</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">print</span> <span class="token string">&quot;Classification Report&quot;</span>

<span class="token comment"># labels for set 1=True to upper left and 0 = False to lower right</span>
<span class="token keyword">print</span> <span class="token string">&quot;{0}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>metrics<span class="token punctuation">.</span>classification_report<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> prediction_from_test_data<span class="token punctuation">,</span> labels<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="রিপোর্ট-আউটপুট"><a href="#রিপোর্ট-আউটপুট" class="header-anchor">#</a> রিপোর্ট আউটপুট</h3> <div class="language- extra-class"><pre class="language-text"><code>Classification Report
             precision    recall  f1-score   support

          1       0.61      0.65      0.63        80
          0       0.81      0.78      0.79       151

avg / total       0.74      0.74      0.74       231
</code></pre></div><p><img src="https://i.imgur.com/sdNGDe6.gif" alt="classification_report"></p> <p>এখানে দুইটা টপিক নিয়ে আমরা একটু আলোচনা করব, একটি হল <code>Precision</code> এবং আরেকটি হল <code>Recall</code>।</p> <h3 id="precision-বের-করার-সূত্র"><a href="#precision-বের-করার-সূত্র" class="header-anchor">#</a> <code>Precision</code> বের করার সূত্র</h3> <section><div><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Precision</mtext><mo>=</mo><mfrac><mrow><mi>T</mi><mi>P</mi></mrow><mrow><mi>T</mi><mi>P</mi><mo>+</mo><mi>F</mi><mi>P</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\text{Precision} = \frac{TP}{TP + FP}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord text"><span class="mord">Precision</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.1296600000000003em;vertical-align:-0.7693300000000001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693300000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></div></section><p>অর্থাৎ, পার্ফেক্ট প্রিসিশনের জন্য আমরা জানি, FP = 0, সুতরাং 100% Accurate Model এর
<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Precision</mtext><mo>=</mo><mfrac><mrow><mi>T</mi><mi>P</mi></mrow><mrow><mi>T</mi><mi>P</mi><mo>+</mo><mn>0</mn></mrow></mfrac><mo>=</mo><mfrac><mrow><mi>T</mi><mi>P</mi></mrow><mrow><mi>T</mi><mi>P</mi></mrow></mfrac><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\text{Precision} = \frac{TP}{TP + 0} = \frac{TP}{TP} = 1</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord text"><span class="mord">Precision</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.275662em;vertical-align:-0.403331em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.872331em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span><span class="mord mathdefault mtight" style="margin-right:0.13889em;">P</span><span class="mbin mtight">+</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span><span class="mord mathdefault mtight" style="margin-right:0.13889em;">P</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.403331em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.217331em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.872331em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span><span class="mord mathdefault mtight" style="margin-right:0.13889em;">P</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span><span class="mord mathdefault mtight" style="margin-right:0.13889em;">P</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></span>
এর অর্থ হচ্ছে Precision এর মান যত বড় ততই ভাল। আমাদের টার্গেট থাকবে Precision এর মান যতটা বড় করা যায়।</p> <h3 id="recall-বের-করার-সূত্র"><a href="#recall-বের-করার-সূত্র" class="header-anchor">#</a> <code>Recall</code> বের করার সূত্র</h3> <section><div><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Recall</mtext><mo>=</mo><mfrac><mrow><mi>T</mi><mi>P</mi></mrow><mrow><mi>T</mi><mi>P</mi><mo>+</mo><mi>F</mi><mi>N</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\text{Recall} = \frac{TP}{TP + FN}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord text"><span class="mord">Recall</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.1296600000000003em;vertical-align:-0.7693300000000001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693300000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></div></section><p>একই ভাবে, 100% Accurate Model এর ক্ষেত্রে <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Recall</mtext><mo>=</mo><mfrac><mrow><mi>T</mi><mi>P</mi></mrow><mrow><mi>T</mi><mi>P</mi><mo>+</mo><mn>0</mn></mrow></mfrac><mo>=</mo><mfrac><mrow><mi>T</mi><mi>P</mi></mrow><mrow><mi>T</mi><mi>P</mi></mrow></mfrac><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\text{Recall} = \frac{TP}{TP + 0} = \frac{TP}{TP} = 1</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord text"><span class="mord">Recall</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.275662em;vertical-align:-0.403331em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.872331em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span><span class="mord mathdefault mtight" style="margin-right:0.13889em;">P</span><span class="mbin mtight">+</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span><span class="mord mathdefault mtight" style="margin-right:0.13889em;">P</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.403331em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.217331em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.872331em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span><span class="mord mathdefault mtight" style="margin-right:0.13889em;">P</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span><span class="mord mathdefault mtight" style="margin-right:0.13889em;">P</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></span>।</p> <p>আবারও, আমাদের লক্ষ থাকবে Recall এর মান যতটা বাড়ানো যায়।</p> <p><code>Precision - 0.61 &amp; Recall - 0.65</code> খারাপ না, কিন্তু এর মান আরও বাড়ানো যেতে পারে। সেই চেষ্টাই আমরা করে যাব।</p> <hr> <h2 id="পারফর্মেন্স-ইম্প্রুভ-করার-উপায়-কী-কী"><a href="#পারফর্মেন্স-ইম্প্রুভ-করার-উপায়-কী-কী" class="header-anchor">#</a> পারফর্মেন্স ইম্প্রুভ করার উপায় কী কী?</h2> <p>আমরা নিচের পদ্ধতিগুলোর মাধ্যমে মডেলের পার্ফর্মেন্স বের বাড়াতে পারি</p> <ul><li>যে অ্যালগরিদমে আছি সেটা অ্যাডজাস্ট বা মডিফাই করা</li> <li>আরও ডেটা জোগাড় করা বা ডেটাফ্রেমের ইম্প্রুভ করা</li> <li>ট্রেইনিং ইম্প্রুভ করার চেষ্টা করা</li> <li>অ্যালগরিদম চেঞ্জ করা</li></ul> <h2 id="চলুন-আমরা-বরং-অ্যালগরিদম-চেঞ্জ-করে-দেখি-random-forest"><a href="#চলুন-আমরা-বরং-অ্যালগরিদম-চেঞ্জ-করে-দেখি-random-forest" class="header-anchor">#</a> চলুন আমরা বরং অ্যালগরিদম চেঞ্জ করে দেখি : Random Forest</h2> <p>Random Forest দিয়ে কেন দেখব? কারণ,</p> <ul><li>এটা Ensemble Algorithm (সহজ কথায় Advanced এবং Complex)</li> <li>ডেটার সাবসেটে অনেকগুলো ট্রি থাকতে পারে</li> <li>ট্রি এর রেজাল্ট এভারেজ করে যাতে ওভারফিটিং কন্ট্রোলে থাকে এবং পার্ফর্মেন্স ভাল হয়</li></ul> <p>আমাদের ডেটা নিয়ে কিছুই করা লাগবে না, যেহেতু আমরা প্রিপ্রসেসিংয়ের কাজ আগেই করে রেখেছি। শুধু নতুন মডেল তৈরি করে ডেটা দিয়ে ট্রেইন করব এবং টেস্ট ডেটা দিয়ে পার্ফর্মেন্স টেস্ট করব।</p> <p>নিচের কোডটি লিখে ফেলুন,</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>ensemble <span class="token keyword">import</span> RandomForestClassifier

<span class="token comment"># Create a RandomForestClassifier object</span>
rf_model <span class="token operator">=</span> RandomForestClassifier<span class="token punctuation">(</span>random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span>

rf_model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">.</span>ravel<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>এটা লিখে এন্টার মারলে নিচের মত কোন আউটপুট আসলে বুঝবেন ট্রেইনিং খতম, এবার পার্ফর্মেন্স টেস্ট করার পালা</p> <h3 id="আউটপুট-2"><a href="#আউটপুট-2" class="header-anchor">#</a> আউটপুট:</h3> <div class="language- extra-class"><pre class="language-text"><code>RandomForestClassifier(bootstrap=True, class_weight=None, criterion='gini',
            max_depth=None, max_features='auto', max_leaf_nodes=None,
            min_samples_leaf=1, min_samples_split=2,
            min_weight_fraction_leaf=0.0, n_estimators=10, n_jobs=1,
            oob_score=False, random_state=42, verbose=0, warm_start=False)
</code></pre></div><h2 id="random-forest-performance-testing-predict-training-data"><a href="#random-forest-performance-testing-predict-training-data" class="header-anchor">#</a> Random Forest Performance Testing : Predict Training Data</h2> <p>আগের মতই কোড,</p> <div class="language-python extra-class"><pre class="language-python"><code>rf_predict_train <span class="token operator">=</span> rf_model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_train<span class="token punctuation">)</span>

<span class="token comment">#get accuracy</span>
rf_accuracy <span class="token operator">=</span> metrics<span class="token punctuation">.</span>accuracy_score<span class="token punctuation">(</span>y_train<span class="token punctuation">,</span> rf_predict_train<span class="token punctuation">)</span>

<span class="token comment">#print accuracy</span>
<span class="token keyword">print</span> <span class="token string">&quot;Accuracy: {0:.4f}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>rf_accuracy<span class="token punctuation">)</span>
</code></pre></div><h4 id="আউটপুট-3"><a href="#আউটপুট-3" class="header-anchor">#</a> আউটপুট:</h4> <div class="language- extra-class"><pre class="language-text"><code>Accuracy: 0.9870
</code></pre></div><p>অস্থির! তাই না? ডেটাসেট সে ভালই মুখস্ত করেছে। এবার দেখা যাক টেস্টিং ডেটায় পার্ফর্মেন্স কেমন!</p> <h2 id="random-forest-performance-testing-predict-testing-data"><a href="#random-forest-performance-testing-predict-testing-data" class="header-anchor">#</a> Random Forest Performance Testing : Predict Testing Data</h2> <div class="language-python extra-class"><pre class="language-python"><code>rf_predict_test <span class="token operator">=</span> rf_model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span>

<span class="token comment">#get accuracy</span>
rf_accuracy_testdata <span class="token operator">=</span> metrics<span class="token punctuation">.</span>accuracy_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> rf_predict_test<span class="token punctuation">)</span>

<span class="token comment">#print accuracy</span>
<span class="token keyword">print</span> <span class="token string">&quot;Accuracy: {0:.4f}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>rf_accuracy_testdata<span class="token punctuation">)</span>
</code></pre></div><h4 id="আউটপুট-4"><a href="#আউটপুট-4" class="header-anchor">#</a> আউটপুট:</h4> <div class="language- extra-class"><pre class="language-text"><code>Accuracy: 0.7100

</code></pre></div><p>টেস্টিং ডেটার ক্ষেত্রে অ্যাকুরেসি ৭১% আর ট্রেইনিং ডেটায় ৯৮%। অর্থাৎ সিলেবাসের প্রশ্নে উত্তর ভালই দিতে পারছে কিন্তু এর বাইরে থেকে প্রশ্ন করলে উত্তর বেশ খারাপই আসছে। এর মানে সে রিয়েল ওয়ার্ল্ড ডেটায় ভাল প্রেডিক্ট করতে পারছে না, কিন্তু যে ডেটাসেট এর মাধ্যমে যেটা শিখেছে, সেখান থেকে ভাল প্রেডিক্ট করতে পারছে।</p> <p>এর চেয়ে তো আমাদের Naive Bayes মডেল ভাল কাজ করছিল! আমাদের টেস্টিং ডেটায় ভাল অ্যাকুরেসি দরকার।</p> <p>এবার দেখা যাক Random Forest মডেলের ক্লাসিফিকেশন রিপোর্ট কেমন! আমরা উপর থেকে ধার করা কোড কিছুটা পরিবর্তন করেই বসিয়ে দিতে পারি!</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">print</span> <span class="token string">&quot;Confusion Matrix for Random Forest&quot;</span>

<span class="token comment"># labels for set 1=True to upper left and 0 = False to lower right</span>
<span class="token keyword">print</span> <span class="token string">&quot;{0}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>metrics<span class="token punctuation">.</span>confusion_matrix<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> rf_predict_test<span class="token punctuation">,</span> labels<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">print</span> <span class="token string">&quot;&quot;</span>

<span class="token keyword">print</span> <span class="token string">&quot;Classification Report\n&quot;</span>

<span class="token comment"># labels for set 1=True to upper left and 0 = False to lower right</span>
<span class="token keyword">print</span> <span class="token string">&quot;{0}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>metrics<span class="token punctuation">.</span>classification_report<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> rf_predict_test<span class="token punctuation">,</span> labels<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

</code></pre></div><h4 id="আউটপুট-5"><a href="#আউটপুট-5" class="header-anchor">#</a> আউটপুট:</h4> <div class="language- extra-class"><pre class="language-text"><code>Confusion Matrix for Random Forest
[[ 43  37]
 [ 30 121]]

Classification Report

             precision    recall  f1-score   support

          1       0.59      0.54      0.56        80
          0       0.77      0.80      0.78       151

avg / total       0.70      0.71      0.71       231
</code></pre></div><p>এখানে দেখুন, precision ও recall এর মানও আমাদের আগের Naive Bayes এর চেয়ে খারাপ।</p> <h2 id="গুরুত্বপূর্ণ-overfitting"><a href="#গুরুত্বপূর্ণ-overfitting" class="header-anchor">#</a> গুরুত্বপূর্ণ : Overfitting</h2> <p>যখন দেখবেন Training Data ও Testing Data এর Accuracy Score এ মোটামুটি ভালই তফাৎ, তখনই বুঝবেন আপনার মডেলটি মেশিন লার্নিংয়ের সবচেয়ে ক্লাসিক সমস্যার কবলে পড়েছে। সেটা হল Overfitting, আমাদের Random Forest মডেলটি Overfitting এর ভুক্তভোগী। আমরা পরবর্তী পর্বে Overfitting নামক <strong>লার্নিংয়ের দুষ্টচক্র</strong> থেকে বের হওয়ার বেশ কিছু পদ্ধতি দেখব।</p> <h2 id="আপডেটেড-নোটবুক-ডাউনলোড-করুন"><a href="#আপডেটেড-নোটবুক-ডাউনলোড-করুন" class="header-anchor">#</a> আপডেটেড নোটবুক ডাউনলোড করুন</h2> <p>এই পর্যন্ত যত কাজ করা হয়েছে আপনি নিজে না করে থাকলেও আমার করা নোটবুকটি ডাউনলোড করে রান করে দেখতে পারেন। <a href="https://github.com/howtocode-com-bd/ml.howtocode.com.bd/blob/master/model_performance/performance.ipynb" target="_blank" rel="noopener noreferrer">ডাউনলোড করুন এখান থেকে।<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <!----></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">6/11/2020, 6:39:56 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/workflow/model-training/" class="prev">
        মডেল ট্রেইনিং
      </a></span> <span class="next"><a href="/workflow/performance-testing-last/">
        মডেল পারফর্মেন্স - দ্বিতীয় এবং শেষ পর্ব
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><div></div><span></span><!----><div class="reading-progress top" data-v-21b39eda><div class="progress" data-v-21b39eda></div></div></div></div>
    <script src="/assets/js/app.ff943db8.js" defer></script><script src="/assets/js/2.838862f8.js" defer></script><script src="/assets/js/36.9b79648c.js" defer></script>
  </body>
</html>
