<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>মডেল পারফর্মেন্স - দ্বিতীয় এবং শেষ পর্ব | মেশিন লার্নিং ও বিভিন্ন প্রোগ্রামিং ল্যাঙ্গুয়েজে ইম্প্লিমেন্টেশন</title>
    <meta name="generator" content="VuePress 1.5.0">
    
    <meta name="description" content="বাংলায় মেশিন লার্নিং সহজ শিক্ষা">
    <link rel="preload" href="/assets/css/0.styles.6d501496.css" as="style"><link rel="preload" href="/assets/js/app.ff943db8.js" as="script"><link rel="preload" href="/assets/js/2.838862f8.js" as="script"><link rel="preload" href="/assets/js/35.28a49c94.js" as="script"><link rel="prefetch" href="/assets/js/10.e846aa23.js"><link rel="prefetch" href="/assets/js/11.354e8e9c.js"><link rel="prefetch" href="/assets/js/12.b68da5e2.js"><link rel="prefetch" href="/assets/js/13.c7c7508c.js"><link rel="prefetch" href="/assets/js/14.8ea08db1.js"><link rel="prefetch" href="/assets/js/15.7869c4dc.js"><link rel="prefetch" href="/assets/js/16.d51ceaba.js"><link rel="prefetch" href="/assets/js/17.d0d64215.js"><link rel="prefetch" href="/assets/js/18.6bfe8fdf.js"><link rel="prefetch" href="/assets/js/19.596ad80b.js"><link rel="prefetch" href="/assets/js/20.10f31d3f.js"><link rel="prefetch" href="/assets/js/21.719359da.js"><link rel="prefetch" href="/assets/js/22.06653c7e.js"><link rel="prefetch" href="/assets/js/23.bd8aff41.js"><link rel="prefetch" href="/assets/js/24.cfdbbb4c.js"><link rel="prefetch" href="/assets/js/25.e3eb0442.js"><link rel="prefetch" href="/assets/js/26.a21980e6.js"><link rel="prefetch" href="/assets/js/27.1f28ca07.js"><link rel="prefetch" href="/assets/js/28.ca9e6b26.js"><link rel="prefetch" href="/assets/js/29.19120067.js"><link rel="prefetch" href="/assets/js/3.c8a6fccb.js"><link rel="prefetch" href="/assets/js/30.324bd9be.js"><link rel="prefetch" href="/assets/js/31.1f6ac9f8.js"><link rel="prefetch" href="/assets/js/32.e099d021.js"><link rel="prefetch" href="/assets/js/33.dd075a30.js"><link rel="prefetch" href="/assets/js/34.b34ad0d4.js"><link rel="prefetch" href="/assets/js/36.9b79648c.js"><link rel="prefetch" href="/assets/js/37.1494e9da.js"><link rel="prefetch" href="/assets/js/4.8a05083b.js"><link rel="prefetch" href="/assets/js/5.32804bbb.js"><link rel="prefetch" href="/assets/js/6.7767a1f1.js"><link rel="prefetch" href="/assets/js/7.d628d3b1.js"><link rel="prefetch" href="/assets/js/8.4e7b6dcb.js"><link rel="prefetch" href="/assets/js/9.3404ad1a.js">
    <link rel="stylesheet" href="/assets/css/0.styles.6d501496.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">মেশিন লার্নিং ও বিভিন্ন প্রোগ্রামিং ল্যাঙ্গুয়েজে ইম্প্লিমেন্টেশন</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ভূমিকা</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>মেশিন লার্নিংয়ের জন্য প্রস্তুতি</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>মেশিন লার্নিং টুলবক্স</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>মেশিন লার্নিংয়ে কাজের ধারা</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/workflow/" aria-current="page" class="sidebar-link">মেশিন লার্নিংয়ে কাজের ধারা</a></li><li><a href="/workflow/howto-ask-question/" class="sidebar-link">সঠিক প্রশ্ন করবেন কীভাবে?</a></li><li><a href="/workflow/data-processing/" class="sidebar-link">ডেটা প্রস্তুত করা (ডেটা কালেকশন ও প্রিপ্রসেসিং) - ১</a></li><li><a href="/workflow/data-preprocessing-last/" class="sidebar-link">ডেটা প্রস্তুত করা (ডেটা প্রিপ্রসেসিং) - ২</a></li><li><a href="/workflow/algorithm-selection/" class="sidebar-link">অ্যালগরিদম সিলেকশন</a></li><li><a href="/workflow/model-training/" class="sidebar-link">মডেল ট্রেইনিং</a></li><li><a href="/workflow/performance-testing/" class="sidebar-link">মডেল পারফর্মেন্স বা অ্যাকুরেসি টেস্টিং - পর্ব ১</a></li><li><a href="/workflow/performance-testing-last/" aria-current="page" class="active sidebar-link">মডেল পারফর্মেন্স - দ্বিতীয় এবং শেষ পর্ব</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>লিনিয়ার রিগ্রেশন</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>লজিস্টিক রিগ্রেশন</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>মাল্টিক্লাস ক্লাসিফিকেশন</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ন্যাচারাল ল্যাঙ্গুয়েজ প্রসেসিং</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>পরিশিষ্ট</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="মডেল-পারফর্মেন্স-দ্বিতীয়-এবং-শেষ-পর্ব"><a href="#মডেল-পারফর্মেন্স-দ্বিতীয়-এবং-শেষ-পর্ব" class="header-anchor">#</a> মডেল পারফর্মেন্স - দ্বিতীয় এবং শেষ পর্ব</h1> <p>আমরা মেশিন লার্নিংয়ের একদম শেষ পর্বে চলে এলাম। আগের পর্বেই মোটামুটি দেখেছিলাম মডেল ভাল পারফর্ম না করলে অথবা অন্য মডেল আদৌ ভাল পারফর্ম করছে কিনা সেটা জানার জন্য কীভাবে কাজ আগাতে হয়।</p> <h2 id="যেসব-টপিক-আলোচনা-করা-হয়েছে-টিক-দেওয়া-এবং-যেসব-টপিক-নিয়ে-আলোচনা-করা-হয়-নাই-টিক-ছাড়া"><a href="#যেসব-টপিক-আলোচনা-করা-হয়েছে-টিক-দেওয়া-এবং-যেসব-টপিক-নিয়ে-আলোচনা-করা-হয়-নাই-টিক-ছাড়া" class="header-anchor">#</a> যেসব টপিক আলোচনা করা হয়েছে (টিক দেওয়া) এবং যেসব টপিক নিয়ে আলোচনা করা হয় নাই (টিক ছাড়া)</h2> <ul class="contains-task-list"><li class="task-list-item"><input checked="checked" disabled="disabled" type="checkbox" class="task-list-item-checkbox"> টেস্ট ডেটার মাধ্যমে মডেল এভালুয়েশন</li> <li class="task-list-item"><input checked="checked" disabled="disabled" type="checkbox" class="task-list-item-checkbox"> রেজাল্ট ইন্টারপ্রিটেশন</li> <li class="task-list-item"><input disabled="disabled" type="checkbox" class="task-list-item-checkbox"> অ্যাকুরেসি বাড়ানো</li> <li class="task-list-item"><input checked="checked" disabled="disabled" type="checkbox" class="task-list-item-checkbox"> কনফিউশন ম্যাট্রিক্স</li> <li class="task-list-item"><input checked="checked" disabled="disabled" type="checkbox" class="task-list-item-checkbox"> Recall</li> <li class="task-list-item"><input checked="checked" disabled="disabled" type="checkbox" class="task-list-item-checkbox"> Precision</li> <li class="task-list-item"><input disabled="disabled" type="checkbox" class="task-list-item-checkbox"> AUC (Area Under Curve)</li> <li class="task-list-item"><input disabled="disabled" type="checkbox" class="task-list-item-checkbox"> ROC (Receiver Operating Characteristics) - Curve</li> <li class="task-list-item"><input disabled="disabled" type="checkbox" class="task-list-item-checkbox"> ওভারফিটিং</li> <li class="task-list-item"><input disabled="disabled" type="checkbox" class="task-list-item-checkbox"> মডেল হাইপারপ্যারামিটার</li> <li class="task-list-item"><input disabled="disabled" type="checkbox" class="task-list-item-checkbox"> ওভারফিটিং মিনিমাইজেশন</li> <li class="task-list-item"><input disabled="disabled" type="checkbox" class="task-list-item-checkbox"> K-Fold / N-Fold Cross-validation</li> <li class="task-list-item"><input disabled="disabled" type="checkbox" class="task-list-item-checkbox"> Bias-Variance Trade Off</li> <li class="task-list-item"><input disabled="disabled" type="checkbox" class="task-list-item-checkbox"> ভাল পারফর্মেন্সের জন্য পার্ফেকশন ছাড় দেওয়া</li></ul> <p>আমরা এখনো এই ধাপে,</p> <p><img src="https://i.imgur.com/YglPD3U.png" alt="performance_step"></p> <h1 id="মডেল-পারফর্মেন্স-রিভিশন-roc"><a href="#মডেল-পারফর্মেন্স-রিভিশন-roc" class="header-anchor">#</a> মডেল পারফর্মেন্স রিভিশন - ROC</h1> <p>ROC বোঝার আগে অবশ্যই <code>Confusion Matrix</code> সম্পর্কে জানতে হবে, না জানলে আগের পর্ব থেকে পড়ে নিন।</p> <p>ROC স্পেসে ROC কার্ভ আঁকার জন্য X-axis এ FPR (False Positive Rate) ও Y-axis এ TPR (True Positive Rate) বসাতে হয়।</p> <p>তারমানে কনফিউশন ম্যাট্রিক্স থেকে প্রাপ্ত TPR ও FPR রেট বসালে আমরা একটা পয়েন্ট পাব, এভাবে একই ডেটাসেটের উপর প্রয়োগকৃত যতগুলা মডেল নিয়ে আমরা কাজ করব সেগুলোর প্রতিটি থেকে একটি করে পয়েন্ট পাব।</p> <p>এই পয়েন্টগুলো যোগ করে দিয়ে গ্রাফ আঁকলেই আপনি পেয়ে যাবেন আপনার আকাঙ্ক্ষিত ROC কার্ভ।</p> <p>একটা পার্ফেক্ট ক্লাসিফায়ারের TPR হয় 1 এবং FPR হয় 0।</p> <p>একটি উদাহরণ দিয়েই ROC বোঝা যায়।</p> <p>একটা সিনারিও দেখা যাক,</p> <blockquote><p>আমি একটা ডায়বেটিস ডেটাসেট নিলাম, ডেটাসেট এ Observation আছে 1000 টা, আমি এটাকে 80%-20% এ ভাগ করলাম। তারমানে 80% ডেটা হল ট্রেইনিং ডেটা, 20% ডেটা হল টেস্টিং ডেটা।</p></blockquote> <blockquote><p>আবার ধরুন, 200 টা টেস্টিং ডেটার মধ্যে 100 টা হল Positive (মানে আউটপুট পজিটিভ আরও সহজভাবে বললে ওই ১০০ টা ডেটার আউটকাম হল ডায়বেটিস হয়েছে)। এবং 100 টা Negative।</p></blockquote> <blockquote><p>আমি চারটা মডেল তৈরি করলাম, এই মডেল চারটা আমি ট্রেইন করব ও তাদের পারফর্মেন্স টেস্ট করব। চারটা মডেল হল,</p></blockquote> <ul><li>Gaussian Naive Bayes Model</li> <li>Logistic Regression Model</li> <li>Random Forest Model</li> <li>Artificial Neural Network Model</li></ul> <p>আমরা এখনো Artificial Neural Network দেখি নাই এবং এটা সম্পর্কে না জানলেও সমস্যা নেই।</p> <p>আমি আগের পর্বের মত করে প্রতিটা মডেলকে ট্রেইন করে তারপর তাদের Confusion Matrix বের করতে পারি, তাই না? ঠিক সেভাবেই আমি 80% ডেটাসেট দিয়ে মডেলগুলোকে শিখিয়ে পড়িয়ে মানুষ করব তারপর তাদের পারফর্মেন্স টেস্ট করার জন্য পড়া ধরব। (কনফিউশন ম্যাট্রিক্স বের করব)।</p> <p>আরও মনে করতে থাকেন, প্রতিটি মডেলের Confusion Matrix ও পাশাপাশি তাদের TPR, FPR বের করলাম।</p> <h3 id="gaussian-naive-bayes-model"><a href="#gaussian-naive-bayes-model" class="header-anchor">#</a> Gaussian Naive Bayes Model</h3> <table><thead><tr><th>TP = 63</th> <th>FP = 28</th></tr></thead> <tbody><tr><td>FN = 37</td> <td>TN = 72</td></tr></tbody></table> <div class="language- extra-class"><pre class="language-text"><code>TPR = 0.63
FPR = 0.28
</code></pre></div><h3 id="logistic-regression-model"><a href="#logistic-regression-model" class="header-anchor">#</a> Logistic Regression Model</h3> <table><thead><tr><th>TP = 77</th> <th>FP = 77</th></tr></thead> <tbody><tr><td>FN = 23</td> <td>TN = 23</td></tr></tbody></table> <div class="language- extra-class"><pre class="language-text"><code>TPR = 0.77
FPR = 0.77
</code></pre></div><h3 id="random-forest-model"><a href="#random-forest-model" class="header-anchor">#</a> Random Forest Model</h3> <table><thead><tr><th>TP = 24</th> <th>FP = 88</th></tr></thead> <tbody><tr><td>FN = 76</td> <td>TN = 12</td></tr></tbody></table> <div class="language- extra-class"><pre class="language-text"><code>TPR = 0.24
FPR = 0.88
</code></pre></div><h3 id="artificial-neural-network-model"><a href="#artificial-neural-network-model" class="header-anchor">#</a> Artificial Neural Network Model</h3> <table><thead><tr><th>TP = 76</th> <th>FP = 12</th></tr></thead> <tbody><tr><td>FN = 24</td> <td>TN = 88</td></tr></tbody></table> <div class="language- extra-class"><pre class="language-text"><code>TPR = 0.76
FPR = 0.12
</code></pre></div><p>আমরা আগেই জেনেছি ROC Curve এর ক্ষেত্রে Y-axis এ থাকে TPR এবং X-axis এ থাকে FPR। তাহলে আমরা এই চারটা Coordinate সহজেই ROC Space এ বসাতে পারি।</p> <h4 id="coordinate-গুলো"><a href="#coordinate-গুলো" class="header-anchor">#</a> Coordinate গুলো</h4> <div class="language- extra-class"><pre class="language-text"><code>Coordinate -&gt; Model (X, Y)
--------------------------------------
G point -&gt; Gaussian Naive (0.28, 0.63)
L point -&gt; Logistic Regression (.77, .77)
R point -&gt; Random Forest (.88, .24)
A point -&gt; Artificial Neural Network (.76, .12)
</code></pre></div><p>এই পয়েন্টগুলো আমরা এখন প্লট করব।</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

<span class="token comment"># fpr, tpr</span>
naive_bayes <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.28</span><span class="token punctuation">,</span> <span class="token number">0.63</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
logistic <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.77</span><span class="token punctuation">,</span> <span class="token number">0.77</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
random_forest <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.88</span><span class="token punctuation">,</span> <span class="token number">0.24</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
ann <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.12</span><span class="token punctuation">,</span> <span class="token number">0.76</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># plotting</span>
plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>naive_bayes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> naive_bayes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> label <span class="token operator">=</span> <span class="token string">'Naive Bayes'</span><span class="token punctuation">,</span> facecolors<span class="token operator">=</span><span class="token string">'black'</span><span class="token punctuation">,</span> edgecolors<span class="token operator">=</span><span class="token string">'orange'</span><span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">300</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>logistic<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> logistic<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> label <span class="token operator">=</span> <span class="token string">'Logistic Regression'</span><span class="token punctuation">,</span> facecolors<span class="token operator">=</span><span class="token string">'orange'</span><span class="token punctuation">,</span> edgecolors<span class="token operator">=</span><span class="token string">'orange'</span><span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">300</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>random_forest<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> random_forest<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> label <span class="token operator">=</span> <span class="token string">'Random Forest'</span><span class="token punctuation">,</span> facecolors<span class="token operator">=</span><span class="token string">'blue'</span><span class="token punctuation">,</span> edgecolors<span class="token operator">=</span><span class="token string">'black'</span><span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">300</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>ann<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ann<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> label <span class="token operator">=</span> <span class="token string">'Artificial Neural Network'</span><span class="token punctuation">,</span> facecolors<span class="token operator">=</span><span class="token string">'red'</span><span class="token punctuation">,</span> edgecolors<span class="token operator">=</span><span class="token string">'black'</span><span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">300</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'k--'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlim<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylim<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'False Positive Rate'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'True Positive Rate'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'Receiver operating characteristic example'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span>loc<span class="token operator">=</span><span class="token string">'lower center'</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="https://i.imgur.com/UhTzNYS.png" alt="roc"></p> <p>উদাহরণটি উইকিপিডিয়া থেকে নেয়া, উইকিপিডিয়ার ROC কার্ভে অতিরিক্ত কিছু জিনিস পয়েন্ট আউট করে দেওয়া আছে,</p> <p><img src="https://upload.wikimedia.org/wikipedia/commons/3/36/ROC_space-2.png" alt="roc_wiki"></p> <p>আমি এখানে প্রতিটি পয়েন্ট বোঝানোর জন্য আলাদা ভাবে স্ক্যাটার প্লট করেছি। আপনার যদি মডেল অনেকগুলো হয় কিংবা, একই মডেলের প্যারামিটার পরিবর্তনভিত্তিক পারফর্মেন্স যদি আপনি প্লট করেন তাহলে আপনার প্লট করা ROC কার্ভ হবে এইরকম।</p> <p><img src="https://upload.wikimedia.org/wikipedia/commons/6/6b/Roccurves.png" alt="orig_roc"></p> <p>আমার এখানে মডেল মাত্র ৪ টা, তাই এখানে লাইন প্লট করলে বোঝা যাবে না তাই, স্ক্যাটার প্লট করা হল।</p> <h3 id="roc-curve-ব্যাখ্যা"><a href="#roc-curve-ব্যাখ্যা" class="header-anchor">#</a> ROC Curve ব্যাখ্যা</h3> <p>100% Accurate Model এর FPR = 0 এবং TPR = 1। এটাকে আইডিয়াল ধরে সহজেই বোঝা যাচ্ছে ANN মডেল হিসেবে সবেচেয়ে ভাল, তারপর Naive Bayes, তারপর Logistic Regression এবং সবার শেষে Random Forest পারফর্ম করেছে।</p> <p>আগেই (এবং আবারো) বলে রাখি, সবসময় ANN &gt; NB &gt; LR &gt; RF এইরকম হবে তা নয়, ডেটাসেট ও প্রবলেমের ধরণ অনুযায়ী এক এক মডেলের পারফর্মেন্স একেক রকম। আমি এখানে পুরো ব্যাপারটা কল্পনা করেছি।</p> <p>মাঝখান দিয়ে যে ড্যাশড লাইন কোণাকুণি বরাবর গিয়েছে তাকে বলে Line of no-discrimination। পয়েন্ট যত এই লাইনের উপরে থাকবে তত ভাল এবং নিচে থাকলে ততটাই খারাপ।</p> <h2 id="auc-বা-area-under-curve"><a href="#auc-বা-area-under-curve" class="header-anchor">#</a> AUC বা Area Under Curve</h2> <p>উপরে একটা ROC Curve দেখছেন নিশ্চয়? সেখানে ROC কার্ভ যতটা Area কভার করে ততটাই ভাল। 100% Accurate Model এর AUC হল TPR * FPR বা পুরো গ্রাফের ক্ষেত্রফল।</p> <p>AUC দিয়ে পারফর্মেন্স পরিমাপ করা নিয়ে অনেক প্রশ্ন উঠেছে বর্তমানে, সবাই কমবেশি ROC প্রেফার করে । তাই AUC নিয়ে কথা বাড়ালাম না।</p> <h2 id="ওভারফিটিং"><a href="#ওভারফিটিং" class="header-anchor">#</a> ওভারফিটিং</h2> <p>আগেও বলা হয়েছিল, কোন কোন সময় মডেলের পারফর্মেন্স এতটাই ভাল হয় যে Training Data এর ক্ষেত্রে Accuracy Rate প্রায় 95-99% হয়। কিন্তু Testing Data তে প্রেডিক্ট করতে দিলে 40% Accuracy Rate ও হয় না।</p> <p>প্রশ্ন হচ্ছে, এটা কেন হয়?</p> <p>আসলে আমরা যে ডেটাসেট দিয়ে ট্রেইন করি, সেখানে আসল ডেটার পাশাপাশি Noise ও থাকে। অর্থাৎ, 100% Pure Dataset আপনি কখনোই পাবেন না।</p> <p>একটা ক্লাসিক এক্সাম্পল হতে পারে, আমি কিছু ডেটাসেট জোগাড় করলাম, কয় ঘণ্টা পড়ি আর কয় ঘণ্টা ঘুমাই তার উপর কত মার্কস পাই। এখন আমি এই ডেটাসেট এর উপরে মডেল ট্রেইন করে প্রেডিক্ট করতে বসে যাই এবং যদি কোনভাবে দেখি, পড়া কমিয়ে ঘুমালে মার্কস বেশি আসছে, এবং সেটার উপর ভিত্তি করে আমি পরবর্তী পরীক্ষার আগে ঘুমায়ে কাটালাম কিন্তু পড়লাম না একটুও (কারণ আমার তৈরি A.I বলেছে ঘুমালে মার্কস বেশি পাওয়া যাবে)। তাতে ফলাফল কী আসবে সেটা বোঝাই যাচ্ছে।</p> <p>তাহলে এই যে ভুলভাল প্রেডিকশন দিচ্ছে, তার কারণ কী? দুইটা কারণ, (১) পর্যাপ্ত পরিমাণ ডেটা নাই, (২) ডেটাসেট এ কলামের সংখ্যা (ভ্যারিয়েবল, এখানে যেমন কয় ঘণ্টা পড়ি আর কয় ঘণ্টা ঘুমাই) কম। মার্কস ভাল আসার অনেক কারণ থাকতে পারে, পরীক্ষা যদি MCQ হয় আর তাতে ঝড়ে বক দিয়ে ভাল পরিমাণ দাগিয়ে ফেললাম, অথবা প্রশ্ন অনেক সহজ হল ইত্যাদি। তাহলে এগুলোতো আমি ইনপুট এ না দিয়েই ট্রেইন করেছি, তাই মডেল স্বভাবতই সেই <code>?</code> কারণ গুলো না জেনেই আমার দেওয়া ডেটাসেট এর সাথে নিজেকে এমন ভাবে খাপ খাওয়াবে তাতে Error সবচেয়ে কম থাকে।</p> <p>মডেল ট্রেইন মানে হচ্ছে Error কমানো, আর Error কমানোর জন্য প্রতিটি মডেলের হাইপারপ্যারামিটার গুলো ম্যাথেমেটিক্যাল অ্যানালাইসিস অনুযায়ী সেট হয়। যে হাইপারপ্যারামিটার ব্যবহার করলে Error সবচেয়ে কম হবে সেটাই মডেল ব্যবহার করবে (এটাই স্বাভাবিক)। কিন্তু Error কম করতে গিয়ে যদি Model, ডেটাসেটের Noise এর সাথে খাপ খাইয়ে নেয় তাহলে যথেষ্ট ঝামেলা হবে।</p> <p>ওভারফিটিং সম্পর্কে পরবর্তীতে আমরা আরও বিস্তারিত দেখব কয়েকটি ধাপে।</p> <h2 id="ওভারফিটিং-কমানো"><a href="#ওভারফিটিং-কমানো" class="header-anchor">#</a> ওভারফিটিং কমানো</h2> <p>ওভারফিটিং কমানোর জন্য যেটা করা যায় সেটা হচ্ছে, ডেটা জোগাড় করা এবং কলামের সংখ্যা বাড়ানো। যতটা পিওর সম্ভব ততটা পিওর ডেটাসেট ও ভাল প্রেডিকশন রেজাল্ট দিতে পারে। এটাতো গেল ডেটাসেট এ কি করবেন। চাইলে অ্যালগরিদম টিউন করেও ভাল রেজাল্ট বের করা সম্ভব। আমরা একটা মেথড দেখব।</p> <h3 id="regularization-regularization-hyperparameter"><a href="#regularization-regularization-hyperparameter" class="header-anchor">#</a> Regularization &amp; Regularization Hyperparameter</h3> <p>একটা অ্যালগরিদম কীভাবে শিখবে সেটা আমরা চাইলে কন্ট্রোল করতে পারি। মেশিন লার্নিং অ্যালগরিদম মানেই তার পিছনে কোন না কোন ম্যাথমেটিক্যাল মডেল কাজ করছে, তাই সেই ম্যাথমেটিক্যাল মডেলের লার্নিং মেকানিজম চাইলে কিছু নির্দিষ্ট প্যারামিটার দিয়ে কন্ট্রোল করা যায়।</p> <p>ধরি কোন একটি মডেল আউটপুট বের করে এই সূত্র দিয়ে,</p> <section><div><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>=</mo><mi>a</mi><msup><mi>x</mi><mn>3</mn></msup><mo>+</mo><mi>b</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">Y = ax^{3} + bx</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.9474379999999999em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">a</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">b</span><span class="mord mathdefault">x</span></span></span></span></span></div></section><p>আমরা এর লার্নিং কন্ট্রোল করার জন্য, (x * lambda) অংশ রেজাল্ট থেকে বিয়োগ দিয়ে <code>Regularized Model</code> তৈরি করতে পারি,</p> <section><div><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>=</mo><mi>a</mi><msup><mi>x</mi><mn>3</mn></msup><mo>+</mo><mi>b</mi><mi>x</mi><mo>−</mo><mi>λ</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">Y = ax^{3} + bx - \lambda x</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.9474379999999999em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">a</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">b</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">λ</span><span class="mord mathdefault">x</span></span></span></span></span></div></section><p>এখানে, <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">λ</span></span></span></span></span> ই হল Regularization Hyperparameter।</p> <p>লক্ষণীয়, <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span></span> এর মান আগের প্রেডিকশনের থেকে কিছুটা কম আসবে, তারমানে আমি এবার Training Dataset এই Accuracy আগের চেয়ে কম পাব। কিন্তু এটা ভাল! কারণ? কারণ হচ্ছে , এবার সে প্রতিটা ডেটাসেট মুখস্ত করছে না, কারণ Regularization Hyperparameter তাকে মুখস্ত করতে দিবে না, <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span></span> এর মান যত বাড়বে, তার প্রেডিক্টেড ভ্যালু ততটাই পেনাল্টি খাবে। একে আমরা তাই Penalized Machine Learning Model বলতে পারি।</p> <p>যখনই মডেলটা এরর কমানোর জন্য ডেটাসেট এর সাথে খাপ খাওয়াতে যাবে, ওমনি lambda তাকে পেনাল্টি দিয়ে দূরে সরিয়ে দেবে। আমাদের আল্টিমেট কাজ হবে এই lambda কে এমন ভাবে টিউন করা যাতে Testing Dataset এ অ্যাকুরেসি ভাল আসে। Training Dataset এ অ্যাকুরেসি গোল্লায় যাক 😛</p> <h1 id="logistic-regression-মডেলে-regularization-hyperparameter-টিউনিংয়ের-মাধ্যমে-অ্যাকুরেসি-বাড়ানো"><a href="#logistic-regression-মডেলে-regularization-hyperparameter-টিউনিংয়ের-মাধ্যমে-অ্যাকুরেসি-বাড়ানো" class="header-anchor">#</a> Logistic Regression মডেলে Regularization Hyperparameter টিউনিংয়ের মাধ্যমে অ্যাকুরেসি বাড়ানো</h1> <p>টপিকের টাইটেল একটু বড় হয়ে গেল। একটু আগে আমরা জানলাম, ম্যাথমেটিক্যাল মডেল হ্যাক করে আমরা Regularization এর মাধ্যমে মডেলের ওভারফিটিং কমাতে পারি। মডেল ভিত্তিক Regularization Hyperparameter বিভিন্ন হয়। সাইকিট লাইব্রেরিতে অলরেডি Logistic Regression এর মডেলের কোড করে দেওয়া আছে এবং তারা Regularization Hyperparameter চেঞ্জ করার জন্য সুবিধাজনক ইন্টারফেসও দিয়েছে।</p> <p>আমাদের কাজ হবে, Regularization Hyperparameter এর মান পরিবর্তন করে প্রেডিকশন স্কোর সংগ্রহ করা। তারপর যে Hyperparameter Value তে প্রেডিকশনের অ্যাকুরেসি সর্বোচ্চ হবে সেটা স্টোর করে রাখা।</p> <p>থিওরি দেখলাম, এবার প্র্যাক্টিক্যাল দেখার পালা। এখন আপনাকে অবশ্যই নোটবুক বের করে কোড লিখতে হবে।</p> <p><img src="https://i.imgur.com/7vs17wU.gif" alt="code"></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>linear_model <span class="token keyword">import</span> LogisticRegression

lr_model <span class="token operator">=</span> LogisticRegression<span class="token punctuation">(</span>C<span class="token operator">=</span><span class="token number">0.7</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span>
lr_model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">.</span>ravel<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
lr_predict_test <span class="token operator">=</span> lr_model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span>

<span class="token comment"># training metrics</span>
<span class="token keyword">print</span> <span class="token string">&quot;Accuracy : {0:.4f}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>metrics<span class="token punctuation">.</span>accuracy_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> lr_predict_test<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">print</span> <span class="token string">&quot;Confusion Matrix&quot;</span>

<span class="token keyword">print</span> metrics<span class="token punctuation">.</span>confusion_matrix<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> lr_predict_test<span class="token punctuation">,</span> labels<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span> <span class="token string">&quot;&quot;</span>

<span class="token keyword">print</span> <span class="token string">&quot;Classification Report&quot;</span>

<span class="token keyword">print</span> metrics<span class="token punctuation">.</span>classification_report<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> lr_predict_test<span class="token punctuation">,</span> labels<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="আউটপুট"><a href="#আউটপুট" class="header-anchor">#</a> আউটপুট</h3> <div class="language- extra-class"><pre class="language-text"><code>Accuracy : 0.7446
Confusion Matrix
[[ 44  36]
 [ 23 128]]

Classification Report
             precision    recall  f1-score   support

          1       0.66      0.55      0.60        80
          0       0.78      0.85      0.81       151

avg / total       0.74      0.74      0.74       231
</code></pre></div><p>এই কাজগুলো আমরা নাইভ বেয়েস মডেলের জন্য করেছিলাম। এখানে <strong>C</strong> হচ্ছে আমাদের সেই Regularization Hyperparameter, শুরুতে ধরে নিলাম <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.7</mn></mrow><annotation encoding="application/x-tex">0.7</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">7</span></span></span></span></span>, আমরা পরে এর বিভিন্ন মানের জন্য অ্যাকুরেসি চেক করব।</p> <h2 id="c-regularization-hyperparameter-এর-মান-নির্ণয়"><a href="#c-regularization-hyperparameter-এর-মান-নির্ণয়" class="header-anchor">#</a> C (Regularization Hyperparameter) এর মান নির্ণয়</h2> <div class="language-python extra-class"><pre class="language-python"><code>
C_start <span class="token operator">=</span> <span class="token number">0.1</span>
C_end <span class="token operator">=</span> <span class="token number">5</span>
C_inc <span class="token operator">=</span> <span class="token number">0.1</span>

C_values<span class="token punctuation">,</span> recall_scores <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

C_val <span class="token operator">=</span> C_start

best_recall_score <span class="token operator">=</span> <span class="token number">0</span>

<span class="token keyword">while</span> <span class="token punctuation">(</span>C_val <span class="token operator">&lt;</span> C_end<span class="token punctuation">)</span><span class="token punctuation">:</span>
    C_values<span class="token punctuation">.</span>append<span class="token punctuation">(</span>C_val<span class="token punctuation">)</span>

    lr_model_loop <span class="token operator">=</span> LogisticRegression<span class="token punctuation">(</span>C<span class="token operator">=</span>C_val<span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span>

    lr_model_loop<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">.</span>ravel<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    lr_predict_loop_test <span class="token operator">=</span> lr_model_loop<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span>

    recall_score <span class="token operator">=</span> metrics<span class="token punctuation">.</span>recall_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> lr_predict_loop_test<span class="token punctuation">)</span>

    recall_scores<span class="token punctuation">.</span>append<span class="token punctuation">(</span>recall_score<span class="token punctuation">)</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>recall_score <span class="token operator">&gt;</span> best_recall_score<span class="token punctuation">)</span><span class="token punctuation">:</span>
        best_recall_score <span class="token operator">=</span> recall_score
        best_lr_predict_test <span class="token operator">=</span> lr_predict_loop_test

    C_val <span class="token operator">=</span> C_val <span class="token operator">+</span> C_inc

best_score_C_val <span class="token operator">=</span> C_values<span class="token punctuation">[</span>recall_scores<span class="token punctuation">.</span>index<span class="token punctuation">(</span>best_recall_score<span class="token punctuation">)</span><span class="token punctuation">]</span>

<span class="token keyword">print</span> <span class="token string">&quot;1st max value of {0:.3f} occured at C={1:.3f}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>best_recall_score<span class="token punctuation">,</span> best_score_C_val<span class="token punctuation">)</span>

<span class="token operator">%</span>matplotlib inline
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>C_values<span class="token punctuation">,</span> recall_scores<span class="token punctuation">,</span> <span class="token string">&quot;-&quot;</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">&quot;C value&quot;</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">&quot;recall score&quot;</span><span class="token punctuation">)</span>

</code></pre></div><p>যেহেতু Regularization Hyperparameter C, আর আমি বিভিন্ন C এর মানের জন্য recall_scores দেখতে চাচ্ছি (recall_score যত বেশি তত ভাল), তাই C_start = 0.1 নিলাম, C_end = 5 নিলাম, আর লুপে C এর মান 0.1 করে বৃদ্ধি করলাম।</p> <p>আর প্রতি C এর ভ্যালুর জন্য প্রেডিক্টেড ডেটাসেট দিয়ে অ্যাকুরেসি চেক করলাম, যখনই recall এর মান আগেরটার চেয়ে বেশি হবে তখনই <code>best_recall_score</code> এ <code>recall_score</code> অর্থাৎ বর্তমান স্কোর অ্যাসাইন হবে।</p> <p>আগের বিষয়গুলো বুঝতে পারলে কোডটা কঠিন কিছু নয়।</p> <p>C_values এবং recall_scores নামের দুইটা লিস্ট রাখলাম ভ্যালু স্টোরের জন্য</p> <h3 id="আউটপুট-2"><a href="#আউটপুট-2" class="header-anchor">#</a> আউটপুট</h3> <p>C এর মান বৃদ্ধির সাথে কীভাবে পারফর্মেন্স পরিবর্তন হচ্ছে তার গ্রাফ।</p> <p><img src="https://i.imgur.com/poHfxeM.png" alt="regularization1"></p> <p>C এর মান যখন 2-3 এর মধ্যে তখন Recall Score সবচেয়ে বেশি, C এর মান 4-5 এবং 0-1 এর মধ্যে কম।</p> <h2 id="class-weight-balanced-ও-c-পরিবর্তনের-সাথে-মডেল-পারফর্মেন্স"><a href="#class-weight-balanced-ও-c-পরিবর্তনের-সাথে-মডেল-পারফর্মেন্স" class="header-anchor">#</a> <code>class_weight = 'balanced'</code> ও C পরিবর্তনের সাথে মডেল পারফর্মেন্স</h2> <p>Regularization Hyperparameter একটাই হবে তার কোন কারণ নেই, একাধিক থাকতে পারে। একটু আগে আমরা C এর মান বের করেছিলাম। এখন আমরা আরেকটি প্যারামিটার (class_weight) কে <code>balanced</code> দিয়ে দেখব পারফর্মেন্স কিরকম দিচ্ছে।</p> <p><code>class_weight = 'balanced'</code> রেখে C এর মান পরিবর্তন করে পারফর্মেন্স বের করাই হবে মূল উদ্দেশ্য।</p> <div class="language-python extra-class"><pre class="language-python"><code>
C_start <span class="token operator">=</span> <span class="token number">0.1</span>
C_end <span class="token operator">=</span> <span class="token number">5</span>
C_inc <span class="token operator">=</span> <span class="token number">0.1</span>

C_values<span class="token punctuation">,</span> recall_scores <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

C_val <span class="token operator">=</span> C_start
best_recall_score <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">while</span> <span class="token punctuation">(</span>C_val <span class="token operator">&lt;</span> C_end<span class="token punctuation">)</span><span class="token punctuation">:</span>
    C_values<span class="token punctuation">.</span>append<span class="token punctuation">(</span>C_val<span class="token punctuation">)</span>

    lr_model_loop <span class="token operator">=</span> LogisticRegression<span class="token punctuation">(</span>C<span class="token operator">=</span>C_val<span class="token punctuation">,</span> class_weight<span class="token operator">=</span><span class="token string">&quot;balanced&quot;</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span>

    lr_model_loop<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">.</span>ravel<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    lr_predict_loop_test <span class="token operator">=</span> lr_model_loop<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span>

    recall_score <span class="token operator">=</span> metrics<span class="token punctuation">.</span>recall_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> lr_predict_loop_test<span class="token punctuation">)</span>

    recall_scores<span class="token punctuation">.</span>append<span class="token punctuation">(</span>recall_score<span class="token punctuation">)</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>recall_score <span class="token operator">&gt;</span> best_recall_score<span class="token punctuation">)</span><span class="token punctuation">:</span>
        best_recall_score <span class="token operator">=</span> recall_score
        best_lr_predict_test <span class="token operator">=</span> lr_predict_loop_test

    C_val <span class="token operator">=</span> C_val <span class="token operator">+</span> C_inc

best_score_C_val <span class="token operator">=</span> C_values<span class="token punctuation">[</span>recall_scores<span class="token punctuation">.</span>index<span class="token punctuation">(</span>best_recall_score<span class="token punctuation">)</span><span class="token punctuation">]</span>

<span class="token keyword">print</span> <span class="token string">&quot;1st max value of {0:.3f} occured at C={1:.3f}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>best_recall_score<span class="token punctuation">,</span> best_score_C_val<span class="token punctuation">)</span>

<span class="token operator">%</span>matplotlib inline
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>C_values<span class="token punctuation">,</span> recall_scores<span class="token punctuation">,</span> <span class="token string">&quot;-&quot;</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">&quot;C value&quot;</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">&quot;recall score&quot;</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="আউটপুট-3"><a href="#আউটপুট-3" class="header-anchor">#</a> আউটপুট:</h3> <p><img src="https://i.imgur.com/2v4Mb7y.png" alt="class_weight"></p> <p>ক্লাস ওয়েট <code>balanced</code> দেওয়াতে দেখা যাচ্ছে Recall Score বেড়ে 0.73+ হয়েছে, definitely what we were looking for!</p> <p><strong>কনফিউশন ম্যাট্রিক্স</strong></p> <p>কোড:</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>linear_model <span class="token keyword">import</span> LogisticRegression
lr_model <span class="token operator">=</span>LogisticRegression<span class="token punctuation">(</span> class_weight<span class="token operator">=</span><span class="token string">&quot;balanced&quot;</span><span class="token punctuation">,</span> C<span class="token operator">=</span>best_score_C_val<span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span>
lr_model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">.</span>ravel<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
lr_predict_test <span class="token operator">=</span> lr_model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span>

<span class="token comment"># training metrics</span>
<span class="token keyword">print</span> <span class="token string">&quot;Accuracy: {0:.4f}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>metrics<span class="token punctuation">.</span>accuracy_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> lr_predict_test<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span> metrics<span class="token punctuation">.</span>confusion_matrix<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> lr_predict_test<span class="token punctuation">,</span> labels<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span> <span class="token string">&quot;&quot;</span>
<span class="token keyword">print</span> <span class="token string">&quot;Classification Report&quot;</span>
<span class="token keyword">print</span> metrics<span class="token punctuation">.</span>classification_report<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> lr_predict_test<span class="token punctuation">,</span> labels<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span> metrics<span class="token punctuation">.</span>recall_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> lr_predict_test<span class="token punctuation">)</span>
</code></pre></div><h3 id="আউটপুট-4"><a href="#আউটপুট-4" class="header-anchor">#</a> আউটপুট:</h3> <div class="language- extra-class"><pre class="language-text"><code>Accuracy: 0.7143
[[ 59  21]
 [ 45 106]]

Classification Report
             precision    recall  f1-score   support

          1       0.57      0.74      0.64        80
          0       0.83      0.70      0.76       151

avg / total       0.74      0.71      0.72       231

0.7375
</code></pre></div><p>Regularization এর মাধ্যমে এভাবে আমরা অ্যাকুরেসি বাড়াতে পারি (ওভারফিটিং কমিয়ে)।</p> <h2 id="k-fold-n-fold-cross-validation"><a href="#k-fold-n-fold-cross-validation" class="header-anchor">#</a> K-Fold / N-Fold Cross-validation</h2> <p>ওভারফিটিং কমানোর আরেকটি ইফেক্টিভ অ্যালগরিদম হল K-Fold Cross-validation। নামটা অনেক কঠিন শোনালেও কাজ খুবই সহজ।</p> <p>আমাদের ডায়বেটিস ডেটাসেট এ কিন্তু নেগেটিভ উত্তর বেশি (মানে ডায়বেটিস হয় নাই)। যেখানে ডেটাসেট এর ব্যালেন্স কম থাকবে সেসব ক্ষেত্রে K-Fold Cross-validation খুবই ভাল অ্যাকুরেসি দিতে সাহায্য করে।</p> <p>K-Fold বা N-Fold Cross-validation একই জিনিস যখন k=N! বা K = Number of observation।</p> <p>k-Fold Cross-validation এ যেটা করা হয়, সম্পূর্ণ ডেটাসেটকে k equal sized এ সাবস্যাম্পল করা হয়।</p> <p>এবার এই k সংখ্যক সাবস্যাম্পল থেকে একটা একটা করে ডেটা নেয়া হয় টেস্টিং এর জন্য।</p> <p>যেমন, আমার কাছে 25 টা অবসার্ভেশনের ডেটাসেট আছে, আমি এদেরকে ৫ টা গ্রুপে ভাগ করলাম।</p> <p>তারমানে প্রতিগ্রুপে ডেটাসেট থাকল ৫ টা করে। এবার এই পাঁচটা গ্রুপের প্রথম গ্রুপ আমি Hold করলাম বাকিগুলো ট্রেইনিংয়ে দিলাম, Hold করা ডেটাসেট দিয়ে টেস্ট করলাম।</p> <p>দ্বিতীয় Pass এ দ্বিতীয় গ্রুপ Hold করব (ট্রেনিংয়ে পাঠাব না), আর বাকিগুলো Training এ পাঠাব।</p> <p>ঠিক একই ভাবে চতুর্থ এবং পঞ্চম Pass এ ওই পজিশনাল গ্রুপটি Hold করে বাকিটা পাঠাব ট্রেইনিংয়ে।</p> <p>এভাবে 5 বার 5-Fold এ ট্রেইন করব। যেহেতু প্রতি গ্রুপে Observation 5 টা এবং গ্রুপ সংখ্যা ৫ টা তাই এর নাম হবে N-Fold Cross-validation।</p> <h3 id="cross-validation-ব্যবহার-করে-মডেল-ট্রেইনিং-ও-টেস্টিং"><a href="#cross-validation-ব্যবহার-করে-মডেল-ট্রেইনিং-ও-টেস্টিং" class="header-anchor">#</a> Cross-validation ব্যবহার করে মডেল ট্রেইনিং ও টেস্টিং</h3> <p>ক্রস ভ্যালিডেশন এনাবলড মডেল সাইকিটে বানানোই আছে, যেকোন নরমাল মডেল এর সাথে CV লাগিয়ে দিলেই Cross-validation Enabled Model পেয়ে যাবেন।</p> <p>যেমন, LogisticRegression এর Cross-validation Enabled মডেল হবে LogisticRegressionCV, এভাবে বাকিগুলোর জন্যও সত্য।</p> <p>চলুন এটার পারফর্মেন্স দেখা যাক,</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>linear_model <span class="token keyword">import</span> LogisticRegressionCV

lr_cv_model <span class="token operator">=</span> LogisticRegressionCV<span class="token punctuation">(</span>n_jobs<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">,</span> Cs<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> cv<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> refit<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> class_weight<span class="token operator">=</span><span class="token string">&quot;balanced&quot;</span><span class="token punctuation">)</span>

<span class="token comment"># set number of jobs to -1 which uses all cores to parallelize</span>
lr_cv_model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">.</span>ravel<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

lr_cv_predict_test <span class="token operator">=</span> lr_cv_model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span>

<span class="token comment"># training metrics</span>
<span class="token keyword">print</span> <span class="token string">&quot;Accuracy: {0:.4f}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>metrics<span class="token punctuation">.</span>accuracy_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> lr_cv_predict_test<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span> metrics<span class="token punctuation">.</span>confusion_matrix<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> lr_cv_predict_test<span class="token punctuation">,</span> labels<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span> <span class="token string">&quot;&quot;</span>
<span class="token keyword">print</span> <span class="token string">&quot;Classification Report&quot;</span>
<span class="token keyword">print</span> metrics<span class="token punctuation">.</span>classification_report<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> lr_cv_predict_test<span class="token punctuation">,</span> labels<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="আউটপুট-5"><a href="#আউটপুট-5" class="header-anchor">#</a> আউটপুট:</h3> <div class="language- extra-class"><pre class="language-text"><code>Accuracy: 0.7100
[[ 55  25]
 [ 42 109]]

Classification Report
             precision    recall  f1-score   support

          1       0.57      0.69      0.62        80
          0       0.81      0.72      0.76       151

avg / total       0.73      0.71      0.72       231
</code></pre></div><p>10-Fold ক্রস ভ্যালিডেশনে পারফর্মেন্স খারাপ আসে নি!</p> <p>অনেক বড় হয়ে গেল চ্যাপ্টারটা, তবুও Bias-Variance টা বাদ থেকে গেল। পরবর্তী অন্য কোন পর্বে আমরা দেখব Bias-Variance Trade-off কী জিনিস এবং এর ইম্প্যাক্ট কতখানি।</p> <h2 id="scikit-learn-algorithm-cheat-sheet"><a href="#scikit-learn-algorithm-cheat-sheet" class="header-anchor">#</a> Scikit-learn Algorithm Cheat Sheet</h2> <p>ডেটাসেট থেকে অ্যালগো সিলেকশনের উপরে সাইকিটের নিজস্ব একটা চিটশিট আছে। খুবই ইফেক্টিভ,</p> <p><img src="https://i.imgur.com/acn08NR.png" alt="cheatsheet"></p> <h2 id="শেষ-পর্যন্ত-যেসব-টপিক-নিয়ে-আলোচনা-করা-হল"><a href="#শেষ-পর্যন্ত-যেসব-টপিক-নিয়ে-আলোচনা-করা-হল" class="header-anchor">#</a> শেষ পর্যন্ত যেসব টপিক নিয়ে আলোচনা করা হল</h2> <ul class="contains-task-list"><li class="task-list-item"><input checked="checked" disabled="disabled" type="checkbox" class="task-list-item-checkbox"> টেস্ট ডেটার মাধ্যমে মডেল এভালুয়েশন</li> <li class="task-list-item"><input checked="checked" disabled="disabled" type="checkbox" class="task-list-item-checkbox"> রেজাল্ট ইন্টারপ্রিটেশন</li> <li class="task-list-item"><input checked="checked" disabled="disabled" type="checkbox" class="task-list-item-checkbox"> অ্যাকুরেসি বাড়ানো</li> <li class="task-list-item"><input checked="checked" disabled="disabled" type="checkbox" class="task-list-item-checkbox"> কনফিউশন ম্যাট্রিক্স</li> <li class="task-list-item"><input checked="checked" disabled="disabled" type="checkbox" class="task-list-item-checkbox"> Recall</li> <li class="task-list-item"><input checked="checked" disabled="disabled" type="checkbox" class="task-list-item-checkbox"> Precision</li> <li class="task-list-item"><input checked="checked" disabled="disabled" type="checkbox" class="task-list-item-checkbox"> AUC (Area Under Curve)</li> <li class="task-list-item"><input checked="checked" disabled="disabled" type="checkbox" class="task-list-item-checkbox"> ROC (Receiver Operating Characteristics) - Curve</li> <li class="task-list-item"><input checked="checked" disabled="disabled" type="checkbox" class="task-list-item-checkbox"> ওভারফিটিং</li> <li class="task-list-item"><input checked="checked" disabled="disabled" type="checkbox" class="task-list-item-checkbox"> মডেল হাইপারপ্যারামিটার</li> <li class="task-list-item"><input checked="checked" disabled="disabled" type="checkbox" class="task-list-item-checkbox"> ওভারফিটিং মিনিমাইজেশন</li> <li class="task-list-item"><input checked="checked" disabled="disabled" type="checkbox" class="task-list-item-checkbox"> K-Fold / N-Fold Cross-validation</li> <li class="task-list-item"><input disabled="disabled" type="checkbox" class="task-list-item-checkbox"> Bias-Variance Trade Off</li> <li class="task-list-item"><input checked="checked" disabled="disabled" type="checkbox" class="task-list-item-checkbox"> ভাল পারফর্মেন্সের জন্য পার্ফেকশন ছাড় দেওয়া</li></ul> <!----></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">6/11/2020, 6:39:56 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/workflow/performance-testing/" class="prev">
        মডেল পারফর্মেন্স বা অ্যাকুরেসি টেস্টিং - পর্ব ১
      </a></span> <span class="next"><a href="/linear-regression/">
        লিনিয়ার রিগ্রেশন : প্রাথমিক আলোচনা
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><div></div><span></span><!----><div class="reading-progress top" data-v-21b39eda><div class="progress" data-v-21b39eda></div></div></div></div>
    <script src="/assets/js/app.ff943db8.js" defer></script><script src="/assets/js/2.838862f8.js" defer></script><script src="/assets/js/35.28a49c94.js" defer></script>
  </body>
</html>
