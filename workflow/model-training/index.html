<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>মডেল ট্রেইনিং | মেশিন লার্নিং ও বিভিন্ন প্রোগ্রামিং ল্যাঙ্গুয়েজে ইম্প্লিমেন্টেশন</title>
    <meta name="generator" content="VuePress 1.5.0">
    
    <meta name="description" content="বাংলায় মেশিন লার্নিং সহজ শিক্ষা">
    <link rel="preload" href="/assets/css/0.styles.6d501496.css" as="style"><link rel="preload" href="/assets/js/app.ff943db8.js" as="script"><link rel="preload" href="/assets/js/2.838862f8.js" as="script"><link rel="preload" href="/assets/js/34.b34ad0d4.js" as="script"><link rel="prefetch" href="/assets/js/10.e846aa23.js"><link rel="prefetch" href="/assets/js/11.354e8e9c.js"><link rel="prefetch" href="/assets/js/12.b68da5e2.js"><link rel="prefetch" href="/assets/js/13.c7c7508c.js"><link rel="prefetch" href="/assets/js/14.8ea08db1.js"><link rel="prefetch" href="/assets/js/15.7869c4dc.js"><link rel="prefetch" href="/assets/js/16.d51ceaba.js"><link rel="prefetch" href="/assets/js/17.d0d64215.js"><link rel="prefetch" href="/assets/js/18.6bfe8fdf.js"><link rel="prefetch" href="/assets/js/19.596ad80b.js"><link rel="prefetch" href="/assets/js/20.10f31d3f.js"><link rel="prefetch" href="/assets/js/21.719359da.js"><link rel="prefetch" href="/assets/js/22.06653c7e.js"><link rel="prefetch" href="/assets/js/23.bd8aff41.js"><link rel="prefetch" href="/assets/js/24.cfdbbb4c.js"><link rel="prefetch" href="/assets/js/25.e3eb0442.js"><link rel="prefetch" href="/assets/js/26.a21980e6.js"><link rel="prefetch" href="/assets/js/27.1f28ca07.js"><link rel="prefetch" href="/assets/js/28.ca9e6b26.js"><link rel="prefetch" href="/assets/js/29.19120067.js"><link rel="prefetch" href="/assets/js/3.c8a6fccb.js"><link rel="prefetch" href="/assets/js/30.324bd9be.js"><link rel="prefetch" href="/assets/js/31.1f6ac9f8.js"><link rel="prefetch" href="/assets/js/32.e099d021.js"><link rel="prefetch" href="/assets/js/33.dd075a30.js"><link rel="prefetch" href="/assets/js/35.28a49c94.js"><link rel="prefetch" href="/assets/js/36.9b79648c.js"><link rel="prefetch" href="/assets/js/37.1494e9da.js"><link rel="prefetch" href="/assets/js/4.8a05083b.js"><link rel="prefetch" href="/assets/js/5.32804bbb.js"><link rel="prefetch" href="/assets/js/6.7767a1f1.js"><link rel="prefetch" href="/assets/js/7.d628d3b1.js"><link rel="prefetch" href="/assets/js/8.4e7b6dcb.js"><link rel="prefetch" href="/assets/js/9.3404ad1a.js">
    <link rel="stylesheet" href="/assets/css/0.styles.6d501496.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">মেশিন লার্নিং ও বিভিন্ন প্রোগ্রামিং ল্যাঙ্গুয়েজে ইম্প্লিমেন্টেশন</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ভূমিকা</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>মেশিন লার্নিংয়ের জন্য প্রস্তুতি</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>মেশিন লার্নিং টুলবক্স</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>মেশিন লার্নিংয়ে কাজের ধারা</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/workflow/" aria-current="page" class="sidebar-link">মেশিন লার্নিংয়ে কাজের ধারা</a></li><li><a href="/workflow/howto-ask-question/" class="sidebar-link">সঠিক প্রশ্ন করবেন কীভাবে?</a></li><li><a href="/workflow/data-processing/" class="sidebar-link">ডেটা প্রস্তুত করা (ডেটা কালেকশন ও প্রিপ্রসেসিং) - ১</a></li><li><a href="/workflow/data-preprocessing-last/" class="sidebar-link">ডেটা প্রস্তুত করা (ডেটা প্রিপ্রসেসিং) - ২</a></li><li><a href="/workflow/algorithm-selection/" class="sidebar-link">অ্যালগরিদম সিলেকশন</a></li><li><a href="/workflow/model-training/" aria-current="page" class="active sidebar-link">মডেল ট্রেইনিং</a></li><li><a href="/workflow/performance-testing/" class="sidebar-link">মডেল পারফর্মেন্স বা অ্যাকুরেসি টেস্টিং - পর্ব ১</a></li><li><a href="/workflow/performance-testing-last/" class="sidebar-link">মডেল পারফর্মেন্স - দ্বিতীয় এবং শেষ পর্ব</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>লিনিয়ার রিগ্রেশন</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>লজিস্টিক রিগ্রেশন</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>মাল্টিক্লাস ক্লাসিফিকেশন</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ন্যাচারাল ল্যাঙ্গুয়েজ প্রসেসিং</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>পরিশিষ্ট</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="মডেল-ট্রেইনিং"><a href="#মডেল-ট্রেইনিং" class="header-anchor">#</a> মডেল ট্রেইনিং</h1> <p>আমরা এই পর্যন্ত সল্যুশন স্টেটমেন্ট, ডেটা কালেকশন ও প্রিপ্রসেসিং এবং অ্যালগরিদম সিলেকশন পর্যন্ত কাজ করেছি। এখন আমরা দেখব মডেল ট্রেইন করতে হয় কীভাবে। ফ্লোচার্ট অনুযায়ী আমরা নিচের ধাপে আছি,</p> <p><img src="https://i.imgur.com/A6m2fDS.png" alt="flowchart"></p> <h2 id="এই-চ্যাপ্টারের-ওভারভিউ"><a href="#এই-চ্যাপ্টারের-ওভারভিউ" class="header-anchor">#</a> এই চ্যাপ্টারের ওভারভিউ</h2> <ul><li>ট্রেইনিং প্রসেস সম্পর্কে আলোচনা করা</li> <li><code>Scikit-learn</code> প্যাকেজ সম্পর্কে আরো ধারণালাভ করা</li> <li>অ্যালগরিদম ডায়বেটিস ডেটা দিয়ে ট্রেইন করে ট্রেইনড মডেল তৈরি করা</li></ul> <h2 id="মেশিন-লার্নিং-ট্রেইনিং"><a href="#মেশিন-লার্নিং-ট্রেইনিং" class="header-anchor">#</a> মেশিন লার্নিং ট্রেইনিং</h2> <p>সংজ্ঞানুযায়ী,</p> <blockquote><p>Letting speicifc data teach a Machine Learning Algorithm to create speicific prediction model.</p></blockquote> <p>তার মানে, যে ট্রেইনিংয়ের মাধ্যমে একটা মেশিন লার্নিং মডেলকে <strong>স্পেসিফিক</strong> ডেটাসেট দিয়ে ট্রেইন করে একটা <strong>স্পেসিফিক</strong> প্রেডিকশন মডেলে পরিণত করা যায় সেটাই মেশিন লার্নিং ট্রেইনিং।</p> <p>স্বাভাবিক, আমি ডায়বেটিসের ডেটাসেট দিয়ে মডেল ট্রেইন করে রোদ-বৃষ্টি হওয়া প্রেডিক্ট করতে পারব না। তার জন্য আমাদের আলাদা স্পেসিফিক ডেটাসেট লাগবে।</p> <p>প্রায়ই মডেল রিট্রেইন (retrain) করার প্রয়োজন হয়।</p> <h2 id="কেন-আমরা-মডেল-retrain-করি"><a href="#কেন-আমরা-মডেল-retrain-করি" class="header-anchor">#</a> কেন আমরা মডেল retrain করি?</h2> <ul><li>ধরি <code>Pima indian dataset</code> কিছুদিন পর পর আপডেটেড হয় নতুন নতুন ডেটা দিয়ে (মানে অবজারভেশন অর্থাৎ নতুন নতুন Row অ্যাড হচ্ছে)। আমরা মেশিন লার্নিংয়ের বৈশিষ্ট্য অনুযায়ী জানি, যত ডেটাসেট থাকবে তত বেটার, তাই নতুন অ্যাড হওয়া ডেটাসেট দিয়ে আবার মডেল ট্রেইন করলে আমরা অবশ্যই আগের চেয়ে ভাল ফলাফল পাব।</li></ul> <div class="language- extra-class"><pre class="language-text"><code>`New Data =&gt; better predictions'
</code></pre></div><ul><li>নতুন ডেটাসেট থেকে আবারও আমরা কিছু ডেটা ট্রেইনিং আর কিছু ডেটা টেস্টিংয়ের জন্য রেখে পারফর্মেন্স ভেরিফাই করতে পারি।</li></ul> <h2 id="ট্রেইনিং-ওভারভিউ"><a href="#ট্রেইনিং-ওভারভিউ" class="header-anchor">#</a> ট্রেইনিং ওভারভিউ</h2> <h3 id="ডেটাসেট-স্প্লিটিং"><a href="#ডেটাসেট-স্প্লিটিং" class="header-anchor">#</a> ডেটাসেট স্প্লিটিং</h3> <p>ট্রেইনিংয়ের শুরুতেই যেটা করতে হবে সেটা হল ডেটাসেট ভাগ করে নিতে হবে। গড়পড়তায় আমরা সাধারণত 70% ডেটা রাখি ট্রেইনিংয়ের জন্য এবং বাকি 30% রাখি টেস্টিংয়ের জন্য।</p> <p><img src="https://i.imgur.com/YKd8Xh9.png" alt="splitdata"></p> <p>ট্রেইনিং ডেটা অ্যালগরিদমে ফিড করার মাধ্যমে আমরা অ্যালগরিদম ট্রেইন করি। কোন অ্যালগরিদম ট্রেইন করার আসল অর্থ হল ওই স্পেসিফিক ডেটাসেট এর জন্য অ্যালগরিদমের ইন্টারনাল প্যারামিটারগুলো সেট করা। আমরা যখন ম্যাথমেটিক্যাল অ্যানালাইসিস দেখব তখন বিষয়টা ক্লিয়ার হবে।</p> <p>আগে দেখি আমাদের ট্রেইনিং গোল (Training Goal) আসলে কী?</p> <h2 id="ট্রেইনিং-গোল-ও-ট্রেইনিং-ডেটা"><a href="#ট্রেইনিং-গোল-ও-ট্রেইনিং-ডেটা" class="header-anchor">#</a> ট্রেইনিং গোল ও ট্রেইনিং ডেটা</h2> <p>ট্রেইনিং গোল বোঝার জন্য আমরা <strong>হাইপোথেটিক্যাল</strong> ডেটাসেট নিচ্ছি। আবারও বলছি <strong>&quot;ট্রেইনিং গোল&quot;</strong> বোঝার জন্য <strong>আমরা আপাতত <code>Diabetes</code> ডেটাসেট ব্যবহার করছি না।</strong></p> <p>ধরি, সর্দি হবে কী না, সেটা বোঝার জন্য দুইটা ইনপুট ভ্যারিয়েবল / ফিচার যথেষ্ট। ফিচার দুটো হল <code>X &amp; Y</code>। প্রতি <code>X</code> এর সাপেক্ষে আমরা যদি <code>Y</code> এর <code>Scatter</code> প্লট করি,</p> <p><img src="https://i.imgur.com/i7wjY7b.png" alt="traininggoal2"></p> <h4 id="স্ক্যাটার-প্লটটির-ব্যাখ্যা"><a href="#স্ক্যাটার-প্লটটির-ব্যাখ্যা" class="header-anchor">#</a> স্ক্যাটার প্লটটির ব্যাখ্যা:</h4> <p>এখানে <strong>নীল</strong> রংয়ের ডট গুলো দ্বারা বোঝানো হচ্ছে <strong>X</strong> ও <strong>Y</strong> এর ওই কম্বিনেশনের জন্য সর্দি হবে না
এবং <strong>লাল</strong> রংয়ের ডট দিয়ে বোঝানো হয়েছে <strong>X</strong> ও <strong>Y</strong> এর ওই সকল কম্বিনেশনের জন্য সর্দি হবে।</p> <p>আমরা একটা সাধারণ <strong>ডিসিশন বাউন্ডারি ড্র</strong> করতে পারি ডটগুলো আলাদা করার জন্য। এটা মূলত করে দেবে আপনার ট্রেইনড অ্যালগরিদম। উপরের ডেটাসেটের জন্য এইরকম একটি ডিসিশন বাউন্ডারি এঁকে দিতে পারে আপনার অ্যালগরিদম।</p> <p><img src="https://i.imgur.com/IPx6mKD.png" alt="decisionboundary"></p> <p>কিন্তু বাউন্ডারি ড্র করার পর দেখা যাচ্ছে নীল অংশে বেশ কিছু লাল ক্রস চলে এসেছে এবং লাল অংশে বেশ কিছু নীল বৃত্ত চলে এসেছে।</p> <p><img src="https://i.imgur.com/GrJ70C2.png" alt="decisionboundary2"></p> <p>তারমানে ট্রেইনিং ১০০% নয়। কিন্তু ১০০% অ্যাকুরেসি আমাদের লক্ষ্যও নয়। এত বেশি অ্যাকুরেট মডেল তৈরি করতে গেলে Overfitting হওয়ার চান্স খুবই বেশি থাকে। Overfitting এবং Underfitting মেশিন লার্নিংয়ের গুরুত্বপূর্ণ বিষয়, তাই বরাবরের মত এগুলো নিয়েও আমরা বিস্তারিত আলোচনা পরে একসময় করে নেব।</p> <p>এই ট্রেইনিং ডেটা ব্যবহার করে মডেলকে ট্রেইন করে আমরা ডিসিশন বাউন্ডারি তৈরি করিয়ে নিতে পারি। আপাতত এটাই হচ্ছে আমার ট্রেইনিং ডেটা ব্যবহারের উদ্দেশ্য।</p> <h2 id="টেস্টিং-ডেটার-কাজ-কী"><a href="#টেস্টিং-ডেটার-কাজ-কী" class="header-anchor">#</a> টেস্টিং ডেটার কাজ কী?</h2> <p>মনে হওয়া স্বাভাবিক, যে ১০০% ডেটা আমরা কেন ট্রেইনিংয়ে কাজে লাগাচ্ছি না? কেন আমরা 70-30% এ স্প্লিট করছি?! এতে করে ট্রেইনিং ডেটা কমে গেল না? তাতে পার্ফর্মেন্স খারাপ হবে না? সব ডেটা দিয়ে ট্রেইন করলে সমস্যা কোথায়?</p> <p>হ্যাঁ অনেকগুলো প্রশ্ন এবং আমার চেষ্টা থাকবে সবগুলোর জবাব দেওয়ার জন্য।</p> <h4 id="১০০-ডেটা-আমরা-কেন-ট্রেইনিংয়ে-কাজে-লাগাচ্ছি-না-কেন-আমরা-70-30-এ-স্প্লিট-করছি-এতে-করে-ট্রেইনিং-ডেটা-কমে-গেল-না"><a href="#১০০-ডেটা-আমরা-কেন-ট্রেইনিংয়ে-কাজে-লাগাচ্ছি-না-কেন-আমরা-70-30-এ-স্প্লিট-করছি-এতে-করে-ট্রেইনিং-ডেটা-কমে-গেল-না" class="header-anchor">#</a> ১০০% ডেটা আমরা কেন ট্রেইনিংয়ে কাজে লাগাচ্ছি না? কেন আমরা 70-30% এ স্প্লিট করছি?! এতে করে ট্রেইনিং ডেটা কমে গেল না?</h4> <p>প্রশ্নগুলো আসলে একই, আমরা পূর্বের আলোচনা করা একটি উদাহরণের মাধ্যমে বিষয়টা বোঝার চেষ্টা করি।</p> <p>ধরি, আমি কাউকে (মনে করুন সে গুণ করতে জানে না, শুধু যোগ করতে জানে) নামতা <strong>শেখাচ্ছি</strong>। লক্ষ্য করবেন আমি 'শেখাচ্ছি' কে বোল্ড হরফে লিখেছি। তারমানে আমি তাকে নামতার <strong>লজিক</strong> শেখাচ্ছি। এবার যদি তাকে আমি,</p> <div class="language- extra-class"><pre class="language-text"><code>2 X 1 = 2
2 X 2 = 4
2 X 3 = 6
2 X 4 = 8
2 X 5 = 10
2 X 6 = 12
2 X 7 = 14
2 X 8 = 16
2 X 9 = 18
2 X 10 = 20
</code></pre></div><p>এই ২ এর নামতা বারবার পড়িয়ে মুখস্ত করালাম। আমি যদি এখন তাকে বলি, বলত <code>2 X 3 = ?</code> সে ঝটপট উত্তর দিতে পারবে যে <code>2 X 3 = 6</code>। এখন আমি তাকে টেস্ট করার জন্য যদি বলি আচ্ছা এবার ৫ এর ঘরের নামতা বল। এবার সে আর ঝটপট উত্তর দিতে পারবে না, কোন কোন ক্ষেত্রে উত্তর দিতে নাও পারে।</p> <p>এই উদাহরণ দিয়ে যেটা বুঝালাম যে, আমি তাকে আদৌ কিছু শেখাতে পারি নাই। ১০০% ডেটা সাপ্লাই দিয়ে আল্টিমেটলি আমি তাকে লজিক বের করা থেকে বিরত রাখলাম। কিন্তু আমি যদি এটা করতাম,</p> <div class="language- extra-class"><pre class="language-text"><code>2 X 1 = 2
2 X 2 = 4
2 X 3 = 6

2 X 5 = 10
2 X 6 = 12
2 X 7 = 14
2 X 8 = 16

2 X 10 = 20
</code></pre></div><p>এখানে দুইটা ডেটা মিসিং, এবং তাকে দায়িত্ব দিলাম তুমি বের কর মিসিং ভ্যালুগুলো কী হবে? সে এবার লজিক বের করার চেষ্টা করবে। কোন মুখস্ত বুলি আওড়াবে না। শুধু তাই না, আমি আসলে তার উত্তর থেকে বের করতে পারব সে আদৌ লজিক শিখতে পেরেছে কিনা।</p> <p>অর্থাৎ আমরা সব টেস্টিং ডেটা দিয়ে ভেরিফাই করতে পারি আমার তৈরিকৃত মডেল আসলেই প্রেডিক্টিভ কিনা, আমি জানি এমন কোন ডেটা আমার কাছে আছে কিন্তু আমি ট্রেইনিংয়ে সেটা প্রোভাইড করি নাই। তাতে যদি মডেল কাছাকাছি প্রেডিক্ট করতে পারে তারমানে আমি মোটামুটি সফল। কারণ আমি একটা মডেলকে ট্রেইনড করতে পেরেছি। আমার কাছে উত্তর নাই এমন প্রশ্ন জিজ্ঞাসা করে আমি কীভাবে জানব আরেকজন সঠিক উত্তর দিচ্ছে কীনা?</p> <h2 id="ইনপুট-ভ্যারিয়েবল-বা-ফিচার-সিলেকশন"><a href="#ইনপুট-ভ্যারিয়েবল-বা-ফিচার-সিলেকশন" class="header-anchor">#</a> ইনপুট ভ্যারিয়েবল বা ফিচার সিলেকশন</h2> <p>ফিচার সিলেকশন বা ফিচার ইঞ্জিনিয়ারিং আসলে ডেটা সায়েন্সের আলোচ্য বিশাল একটা টপিক। কারণ আগেই বলেছি, অনেক সময় ডেটাসেট এ থাকা বেশ কিছু ফিচার থাকে যেগুলো অদরকারী, সেটা বাদ দিলে প্রেডিকশন আরও ভাল হবে। এই অদরকারী ভ্যারিয়েবল ছেঁটে দিয়ে দরকারী ফিচার সিলেকশনের ভারিক্কি নাম ফিচার ইঞ্জিনিয়ারিং।</p> <p>আমরা ডেটাসেট ক্লিনিংয়ের সময় ফিচার ইঞ্জিনিয়ারিং খাটিয়েছিলাম, সেটা হল কো-রিলেশন বের করে আমরা <code>skin</code> ছাঁটাই করি।</p> <h4 id="pima-indian-diabetes-ডেটাসেট-এ-সিলেক্টেড-ফিচারগুলো"><a href="#pima-indian-diabetes-ডেটাসেট-এ-সিলেক্টেড-ফিচারগুলো" class="header-anchor">#</a> Pima Indian Diabetes ডেটাসেট এ সিলেক্টেড ফিচারগুলো:</h4> <ul><li>No of Pregnencies</li> <li>Glucose Concentration</li> <li>Blood Pressure</li> <li>Thickness</li> <li>Insulin</li> <li>Body Mass Index</li> <li>Diabetes Predisposition</li> <li>Age</li></ul> <h2 id="scikit-learn-ব্যবহার-করে-মডেল-ট্রেইনিং"><a href="#scikit-learn-ব্যবহার-করে-মডেল-ট্রেইনিং" class="header-anchor">#</a> <code>Scikit-learn</code> ব্যবহার করে মডেল ট্রেইনিং</h2> <p>অবশেষে আমরা থিওরি পাঠ করে ব্যাপক জ্ঞানার্জনের পর বসলাম কোডিং করতে। প্রস্তুতি নিন, আমরা এখন মডেল ট্রেইন করা শুরু করব।</p> <p>ট্রেইনিংয়ের শুরুতে কী করতে হবে মনে আছে? না থাকলে সমস্যা নাই,</p> <h4 id="ডেটা-স্প্লিটিং"><a href="#ডেটা-স্প্লিটিং" class="header-anchor">#</a> ডেটা স্প্লিটিং</h4> <p>নিচের কোড এর মাধ্যমে আমরা 70-30% ডেটা স্প্লিট করব। ৭০% হল ট্রেইনিং ডেটা, বাকিটা টেস্টিং ডেটা।
জুপিটার নোটবুক বের করে আগের করা কোডটিতে লেখা শুরু করুন।</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>cross_validation <span class="token keyword">import</span> train_test_split

feature_column_names <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'num_preg'</span><span class="token punctuation">,</span> <span class="token string">'glucose_conc'</span><span class="token punctuation">,</span> <span class="token string">'diastolic_bp'</span><span class="token punctuation">,</span> <span class="token string">'thickness'</span><span class="token punctuation">,</span> <span class="token string">'insulin'</span><span class="token punctuation">,</span> <span class="token string">'bmi'</span><span class="token punctuation">,</span> <span class="token string">'diab_prod'</span><span class="token punctuation">,</span> <span class="token string">'age'</span><span class="token punctuation">]</span>

predicted_class_name <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'diabetes'</span><span class="token punctuation">]</span>

<span class="token comment"># Getting feature variable values</span>

X <span class="token operator">=</span> data_frame<span class="token punctuation">[</span>feature_column_names<span class="token punctuation">]</span><span class="token punctuation">.</span>values
y <span class="token operator">=</span> data_frame<span class="token punctuation">[</span>predicted_class_name<span class="token punctuation">]</span><span class="token punctuation">.</span>values

<span class="token comment"># Saving 30% for testing</span>
split_test_size <span class="token operator">=</span> <span class="token number">30</span>

<span class="token comment"># Splitting using scikit-learn train_test_split function</span>

X_train<span class="token punctuation">,</span> X_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> test_size <span class="token operator">=</span> split_test_size<span class="token punctuation">,</span> random_state <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">)</span>

</code></pre></div><p><code>random_state = 42</code> দেওয়ার মানে, প্রতিবার প্রোগ্রাম রান করলে স্প্লিটিং যেন একই জায়গা থেকে হয় সেটার গ্যারান্টি দেওয়ার জন্য।</p> <h3 id="ডেটাসেটের-স্প্লিটিং-কি-আসলেই-৭০-৩০-হয়েছে-চেক-করা-যাক"><a href="#ডেটাসেটের-স্প্লিটিং-কি-আসলেই-৭০-৩০-হয়েছে-চেক-করা-যাক" class="header-anchor">#</a> ডেটাসেটের স্প্লিটিং কি আসলেই ৭০-৩০ হয়েছে? চেক করা যাক</h3> <p><code>Python 3</code></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;{0:0.2f}% in training set&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>X_train<span class="token punctuation">)</span><span class="token operator">/</span><span class="token builtin">len</span><span class="token punctuation">(</span>data_frame<span class="token punctuation">.</span>index<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;{0:0.2f}% in test set&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>X_test<span class="token punctuation">)</span><span class="token operator">/</span><span class="token builtin">len</span><span class="token punctuation">(</span>data_frame<span class="token punctuation">.</span>index<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p><code>Python 2</code></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">print</span> <span class="token string">&quot;{0:0.2f}% in training set&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>X_train<span class="token punctuation">)</span><span class="token operator">/</span><span class="token builtin">len</span><span class="token punctuation">(</span>data_frame<span class="token punctuation">.</span>index<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span>
<span class="token keyword">print</span> <span class="token string">&quot;{0:0.2f}% in test set&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>X_test<span class="token punctuation">)</span><span class="token operator">/</span><span class="token builtin">len</span><span class="token punctuation">(</span>data_frame<span class="token punctuation">.</span>index<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span>
</code></pre></div><p>আউটপুট:</p> <div class="language- extra-class"><pre class="language-text"><code>69.92% in training set
30.08% in test set
</code></pre></div><p>কাছাকাছি!</p> <h3 id="কোন-মিসিং-ডেটা-আছে-কীনা-0-ভ্যালু-null-ভ্যালু-নয়"><a href="#কোন-মিসিং-ডেটা-আছে-কীনা-0-ভ্যালু-null-ভ্যালু-নয়" class="header-anchor">#</a> কোন মিসিং ডেটা আছে কীনা? (0 ভ্যালু, null ভ্যালু নয়)</h3> <p>অনেক সময় একটা কলামে হয়ত বিভিন্ন ধরণের মান আছে কিন্তু আপনি চেক করতে গিয়ে দেখলেন অনেকগুলা ভ্যালু 0 যেটা সম্ভব নয়। সেটা নিয়ে কীভাবে ডিল করবেন? একটা অ্যালগরিদম আছে যেটা দিয়ে ০ ভ্যালুগুলো রিপ্লেস করে একটা গড় ভ্যালু বসিয়ে কাজ করার মত স্টেটে নেওয়া যায়, সেটা দেখার আগে চলেন দেখি আমাদের কতগুলা ভ্যালু আসলে ০!</p> <p><code>Python 3</code></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;# rows in dataframe {0}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>data_frame<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;# rows missing glucose_conc: {0}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>data_frame<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>data_frame<span class="token punctuation">[</span><span class="token string">'glucose_conc'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;# rows missing diastolic_bp: {0}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>data_frame<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>data_frame<span class="token punctuation">[</span><span class="token string">'diastolic_bp'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;# rows missing thickness: {0}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>data_frame<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>data_frame<span class="token punctuation">[</span><span class="token string">'thickness'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;# rows missing insulin: {0}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>data_frame<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>data_frame<span class="token punctuation">[</span><span class="token string">'insulin'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;# rows missing bmi: {0}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>data_frame<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>data_frame<span class="token punctuation">[</span><span class="token string">'bmi'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;# rows missing diab_pred: {0}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>data_frame<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>data_frame<span class="token punctuation">[</span><span class="token string">'diab_pred'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;# rows missing age: {0}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>data_frame<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>data_frame<span class="token punctuation">[</span><span class="token string">'age'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p><code>Python 2</code></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">print</span> <span class="token string">&quot;# rows in dataframe {0}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>data_frame<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span> <span class="token string">&quot;# rows missing glucose_conc: {0}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>data_frame<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>data_frame<span class="token punctuation">[</span><span class="token string">'glucose_conc'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span> <span class="token string">&quot;# rows missing diastolic_bp: {0}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>data_frame<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>data_frame<span class="token punctuation">[</span><span class="token string">'diastolic_bp'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span> <span class="token string">&quot;# rows missing thickness: {0}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>data_frame<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>data_frame<span class="token punctuation">[</span><span class="token string">'thickness'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span> <span class="token string">&quot;# rows missing insulin: {0}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>data_frame<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>data_frame<span class="token punctuation">[</span><span class="token string">'insulin'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span> <span class="token string">&quot;# rows missing bmi: {0}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>data_frame<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>data_frame<span class="token punctuation">[</span><span class="token string">'bmi'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span> <span class="token string">&quot;# rows missing diab_pred: {0}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>data_frame<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>data_frame<span class="token punctuation">[</span><span class="token string">'diab_pred'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span> <span class="token string">&quot;# rows missing age: {0}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>data_frame<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>data_frame<span class="token punctuation">[</span><span class="token string">'age'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>আউটপুট:</strong></p> <div class="language- extra-class"><pre class="language-text"><code># rows in dataframe 768
# rows missing glucose_conc: 5
# rows missing diastolic_bp: 35
# rows missing thickness: 227
# rows missing insulin: 374
# rows missing bmi: 11
# rows missing diab_pred: 0
# rows missing age: 0
</code></pre></div><p>০ ভ্যালু কে কোন ভ্যালু দিয়ে রিপ্লেস করার একটা টেকনিক হল <code>Imputation</code>। ইম্পুট করার জন্য সাইকিটে অলরেডি রেডিমেড কোড দেয়া আছে, আমরা আপতত সেটা ব্যবহার করে কাজ চালিয়ে নেব।</p> <p><code>Python 2 &amp; 3</code></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> Imputer

<span class="token comment">#Impute with mean all 0 readings</span>
fill_0 <span class="token operator">=</span> Imputer<span class="token punctuation">(</span>missing_values<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> strategy<span class="token operator">=</span><span class="token string">&quot;mean&quot;</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>

X_train <span class="token operator">=</span> fill_0<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>X_train<span class="token punctuation">)</span>
X_test <span class="token operator">=</span> fill_0<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span>
</code></pre></div><p>এখানে fill_0 ও কিন্তু একধরণের মডেল, যার কাজ হল 0 ভ্যালুগুলোকে <code>mean</code> স্ট্র্যাটেজির মাধ্যমে একটা লজিক্যাল ভ্যালু দিয়ে রিপ্লেস করা।</p> <p>আমরা এই পরিবর্তিত ট্রেইন ভ্যালু দিয়ে ট্রেইন করব এবং টেস্ট ভ্যালু দিয়ে টেস্ট করব।</p> <h3 id="y-train-বা-y-test-এ-কেন-imputer-ব্যবহার-করলাম-না"><a href="#y-train-বা-y-test-এ-কেন-imputer-ব্যবহার-করলাম-না" class="header-anchor">#</a> <code>y_train</code> বা <code>y_test</code> এ কেন Imputer ব্যবহার করলাম না?</h3> <p>কারণ সিম্পল, ওখানে কোন মিসিং ডেটা নাই।</p> <h3 id="মডেল-ট্রেইনিং-2"><a href="#মডেল-ট্রেইনিং-2" class="header-anchor">#</a> মডেল ট্রেইনিং</h3> <p>অবশেষে আমরা সেই ম্যাজিক্যাল ফাংশন কল করার মাধ্যমে মডেল ট্রেইন করব।</p> <p><code>Python 2 &amp; 3</code></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>naive_bayes <span class="token keyword">import</span> GaussianNB

<span class="token comment"># create Gaussian Naive Bayes model object and train it with the data</span>
nb_model <span class="token operator">=</span> GaussianNB<span class="token punctuation">(</span><span class="token punctuation">)</span>

nb_model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">.</span>ravel<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>আমরা আগেই আলোচনা করে ঠিক করেছিলাম যে আমাদের সিলেক্টেড অ্যালগরিদম হবে Naive Bayes এবং সেই অ্যালগরিদমের একটি মডেল হল Gaussian Naive Bayes। আমরা একটা ফাঁকা মডেল এর অবজেক্ট তৈরি করে নিলাম, তারপর ট্রেইনিং ভ্যালু দিয়ে <code>fit()</code> ফাংশন কল করার মাধ্যমে ট্রেইন করলাম।</p> <p>পরবর্তী চ্যাপ্টারে আমরা দেখব আমাদের তৈরি করা মডেল কেমন পারফর্মেন্স শো করছে!</p> <!----></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">6/11/2020, 6:39:56 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/workflow/algorithm-selection/" class="prev">
        অ্যালগরিদম সিলেকশন
      </a></span> <span class="next"><a href="/workflow/performance-testing/">
        মডেল পারফর্মেন্স বা অ্যাকুরেসি টেস্টিং - পর্ব ১
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><div></div><span></span><!----><div class="reading-progress top" data-v-21b39eda><div class="progress" data-v-21b39eda></div></div></div></div>
    <script src="/assets/js/app.ff943db8.js" defer></script><script src="/assets/js/2.838862f8.js" defer></script><script src="/assets/js/34.b34ad0d4.js" defer></script>
  </body>
</html>
